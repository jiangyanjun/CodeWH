<!DOCTYPE HTML>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="Language" content="zh-CN">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="shortcut icon" href="../../images/kebue.ico">
    <link rel="icon" href="../../images/kebue.ico">
    <meta name="description" content=.NET>
    <meta name="keywords" content=.NET>
    <title>.NET</title>

    <link href="../../template/scripts/bootstrap/css/bootstrap.min.css" rel="stylesheet" />
    <link href="../../template/styles/custom.css" rel="stylesheet" />

</head>
<body id="pageBody">
    <div id="divBoxed" class="container">
        <div class="transparent-bg" style="position: absolute;top: 0;left: 0;width: 100%;height: 100%;z-index: -1;zoom: 1;"></div>
        <div class="divPanel notop nobottom">
            <div class="row-fluid">
                <div class="span12">
                    <div id="divLogo">
                        <a href="../../../Home/Index" id="divSiteTitle">科布尔 kebue</a><br />
                        <a href="../../../Home/Index" id="divTagLine">开发者用代码改变世界从科布尔开始</a>
                    </div>
                </div>
            </div>
            <div class="row-fluid">
                <div class="span12">
                    <div id="divMenuRight" class="pull-right">
                        <div class="navbar">
                            <button type="button" class="btn btn-navbar-highlight btn-large btn-primary" data-toggle="collapse" data-target=".nav-collapse">
                                NAVIGATION <span class="icon-chevron-down icon-white"></span>
                            </button>
                            <div class="nav-collapse collapse">
                                <ul class="nav nav-pills ddmenu">
                                    <li class="dropdown glyphicon glyphicon-arrow-left"><a href='javascript:window.history.back()'>后退</a></li>
                                    <li class="dropdown active"><a href="http://www.kebue.com/">Home</a></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row-fluid">
                <div class="span12">
                    <div id="contentInnerSeparator"></div>
                </div>
            </div>
        </div>
        <div class="contentArea">
            <div class="divPanel notop page-content">
                <div class="breadcrumbs">
                    <a href="../../../Home/Index">Home</a> &nbsp;/&nbsp; <span>.NET</span>
                </div><br /><hr />
                <div class="row-fluid">
                    <div class="span12" id="Article-type">
                        <ul>
                            <li><span>1</span>&nbsp;&nbsp;<a class='btn btn-link' style='color: blue' href='../../../../../Artlcle/vip/2C3A17F3-13F1-411A-A023-5FF67D649624.html' title='ASP.NET Core 是如何读取配置文件，今天我们来学习。ASP.NET Core的配置系统已经和之前版本的ASP.NET有所不同了，之前是依赖于System.Configuration和XML配置文件web.config。新的配置系统支持多种格式的配置文件。下面我们来以json 格式的配置文件正式开始学习。我们新建一个ASP.NET Core Web 应用程序，选择无身份验证。读取配置文件在项目目录下有个appsettings.json ，我们先来操作这个文件。在appsettings.json 添加如下两个节点。{
Data:LineZero,
ConnectionStrings:{
DefaultConnection:数据库1,
DevConnection:数据库2
},
Logging:
{
IncludeScopes:false,
LogLevel:
{
Default:Debug,
System:Information,
Microsoft:Information
}
}
}下面我们来读取。由于项目默认已经将该文件加入ConfigurationBuilder 之中，所以我们可以直接来读取。在Configure 方法中读取：publicvoidConfigure(IApplicationBuilderapp,IHostingEnvironmentenv,ILoggerFactoryloggerFactory)
{
vardata=Configuration[Data];//两种方式读取
vardefaultcon=Configuration.GetConnectionString(DefaultConnection);
vardevcon=Configuration[ConnectionStrings:DevConnection];
}调试程序，可以看到数据成功取出。多环境区分我们复制一个appsettings.json 然后重命名为appsettings.Development.json更改appsettings.Development.json 如下：{
Data:LineZeroDevelopment,
ConnectionStrings:
{
DefaultConnection:开发数据库1,
DevConnection:开发数据库2
},
Logging:
{
IncludeScopes:false,
LogLevel:
{
Default:Debug,
System:Information,
Microsoft:Information
}
}
}然后我们调试程序，你会发现获取到的值变成了Development.json 里的值。这里就是多环境配置。publicStartup(IHostingEnvironmentenv)
{varbuilder=newConfigurationBuilder()
.SetBasePath(env.ContentRootPath)
.AddJsonFile(appsettings.json,optional:true,reloadOnChange:true)
.AddJsonFile($appsettings.{env.EnvironmentName}.json,optional:true)//增加环境配置文件，新建项目默认有.AddEnvironmentVariables();
Configuration=builder.Build();
}如果我们直接执行读取到的就是appsettings.json 的值，因为直接执行时是 Production 环境。下面是输出图：调试时：dotnet run 时：对象读取我们在appsettings.json 及Development.json 都添加一个SiteConfig 节点。SiteConfig:{Name:LineZerosBlog,Info:ASP.NETCore开发及跨平台，配置文件读取
},然后新建一个SiteConfig类。publicclassSiteConfig
{
publicstringName{get;set;}
publicstringInfo{get;set;}
}首先在ConfigureServices 中添加Options 及对应配置。publicvoidConfigureServices(IServiceCollectionservices)
{
//Addframeworkservices.
services.AddMvc();
//添加options
services.AddOptions();
services.ConfigureSiteConfig(Configuration.GetSection(SiteConfig));
}然后我们在 Controller 中读取。publicclassHomeController:Controller
{
publicSiteConfigConfig;
publicHomeController(IOptionsSiteConfigoption)
{
Config=option.Value;
}
publicIActionResultIndex()
{

returnView(Config);
}
}对应View Index.cshtml@modelSiteConfig
@{
ViewData[Title]=Model.Name;
}
h1@Model.Name/h1
h2@Model.Info/h2执行程序http://localhost:5000/'>ASP.NET Core开发-读取配置文件Configuration</a>&nbsp;&nbsp;&nbsp;&nbsp;<span>16-8-28 上午 12:00:00</span></li><li><span>2</span>&nbsp;&nbsp;<a class='btn btn-link' style='color: blue' href='../../../../../Artlcle/vip/74795917-53D0-467B-BEDD-0C8A4662F367.html' title='NET Core 跨平台发布(dotnet publish) ,无需安装.NET Core SDK,就可以运行。前面讲解了.NET Core 的VSCode 开发。现在来讲讲发布（dotnet publish）。.NET Core and ASP.NET Core 1.0 RC2 runtime and libraries在五月中旬发布。.NET Core and ASP.NET Core 1.0 RTM (release) runtime and libraries 六月底发布。https://blogs.msdn.microsoft.com/dotnet/2016/05/06/net-core-rc2-improvements-schedule-and-roadmap/跨平台发布简单新建一个项目。mkdirdotnethello

cddotnethello

dotnetnewdotnet new之后 修改project.json 如下：{version:1.0.0-*,buildOptions:{emitEntryPoint:true
},dependencies:{Microsoft.NETCore.App:{type:platform,//去掉
version:1.0.0-rc2-*
}
},frameworks:{netcoreapp1.0:{imports:dnxcore50
}
},runtimes:{//加入runtime
win7-x64:{},win7-x86:{},osx.10.10-x64:{},osx.10.11-x64:{},ubuntu.14.04-x64:{}
}
}添加NuGet.Config?xmlversion=1.0encoding=utf-8?configuration
packageSources
clear/
addkey=AspNetCIvalue=https://www.myget.org/F/aspnetcirelease/api/v3/index.json/
addkey=NuGet.orgvalue=https://api.nuget.org/v3/index.json/
/packageSources/configurationdotnet restore还原以后就可以编译发布了。Windows:这里默认输入dotnet publish会发布 win7-x64 。我们定位到win7-x64\publish 文件夹，可以直接执行 dotnethello.exe ，无需安装.netcore sdk 。Ubuntu:我们要发布到linux ubuntu 直接指定 runtime 。dotnet publish -rubuntu.14.04-x64把发布文件夹(ubuntu.14.04-x64/publish)拷贝到ubuntu上。直接就可以执行，不需要安装.netcore sdk，只需.netcore依赖的几个包：https://github.com/dotnet/cli/blob/rel/1.0.0/Documentation/cli-prerequisites.mdUbuntu distributions require the following libraries installed:libunwind8libunwind8-devgettextlibicu-devliblttng-ust-devlibcurl4-openssl-devlibssl-devuuid-devunzip设置文件夹下的执行文件dotnethello 设置好权限以后直接 ./dotnethelloMac OS:同理mac os 一样,指定osx runtime。dotnet publish -rosx.10.10-x64将osx.10.10-x64/publish 拷贝到mac os 。OS X 需要安装libsslOS X requires the following libraries and versions installed:libssl 1.1执行dotnethello这样我们无需安装.NET Core SDK 就可以运行.NET Core 应用程序。实现了.NET Core 跨平台。'>NET Core 跨平台发布(dotnet publish) ,无需安装.NET Core SDK,就可以运行。</a>&nbsp;&nbsp;&nbsp;&nbsp;<span>16-8-28 上午 12:00:00</span></li><li><span>3</span>&nbsp;&nbsp;<a class='btn btn-link' style='color: blue' href='../../../../../Artlcle/vip/55DBB39C-6288-4F8C-BA67-2E35240A2308.html' title='目前.NET Core截止到 1.0 RC2版本不支持我们在C#中常用的API列表·System.Data.尽管基本层是.NET Core的一部分，例如提供者模型和SQL客户端，一些功能当前是不可用的，比如schema的支持和DataTable/DataSet。·System.DirectoryServices.现在在.NET Core上并不支持与LDAP或者Active Directory的通信。·System.Drawing. 尽管严格意义上讲，它是一个客户端API,但是许多开发人员使用服务端上的绘画API去提供缩略图或者水印。我们现在在.NET Core上不支持这些API.·System.Transactions.在ADO.NET不支持事物处理的同时，也不支持分布式的事物处理，包括环境交易和登记的概念。·System.Xml.Xsl and System.Xml.Schema. .NET Core支持XmlDocument以及Linq’s XDocument, 包括XPath。然而，当前并不支持XSD (XmlSchema) 或者 XSLT (XslTransform)。·System.Net.Mail. 现在并不支持使用这些API从.NET Core发送邮件。·System.IO.Ports. .NET Core现在并没有能力和串行端口进行通信。·System.Workflow.Windows工作流基础（WF）现在在.NET Core上是不可用的。·System.Xaml. 当创建UWP应用程序的时候，开发人员会使用WinRT XAML APIS, 因此，.NET Core现在不包括托管的XAML框架，其中包括解析XAML 文件的能力还有实例化被描述的对象图。详情访问.Net Core GitHub'>目前.NET Core截止到 1.0 RC2版本不支持我们在C#中常用的API列表</a>&nbsp;&nbsp;&nbsp;&nbsp;<span>16-8-28 上午 12:00:00</span></li><li><span>4</span>&nbsp;&nbsp;<a class='btn btn-link' style='color: blue' href='../../../../../Artlcle/vip/2AF449A2-3A47-4965-8FBF-C4F56A2561F7.html' title='ASP.NET Core 开发 - Entity Framework (EF) Core,ASP.NET Core 操作数据库。Entity Framework (EF) Core RC2 也发布了，可以适用于.NET Core 及ASP.NET Core 。EntityFrameworkCore SQLite 本篇文章以SQLite数据库作为介绍。目前 EF Core 支持的数据库：Microsoft SQL ServerSQLitePostgres (Npgsql)SQL Server Compact EditionInMemory (for testing purposes)后面将会增加：MySQLIBM DB2介绍完了，现在正式开始。新建项目这里我们选择ASP.NET Core Web Application (.NET Core)这里选择web 应用程序，然后更改身份验证 改为不进行身份验证引用Entity Framework (EF) CoreNuGet官方源已经支持 .NET Core RC2 的相关引用。然后在 NuGet命令行下安装 ,我们也可以使用NuGet包管理器安装。Install-PackageMicrosoft.EntityFrameworkCore.Sqlite–Pre创建实体我们在项目添加一个 Models 文件夹。新建一个User.cspublicclassUser
{publicintId{get;set;}publicstringUserName{get;set;}publicstringPassword{get;set;}
}这里我为了方便，继续新建 DataContext.cspublicclassDataContext:DbContext
{publicDataContext(DbContextOptionsDataContextoptions)
:base(options)
{
}publicDbSetUserUsers{get;set;}
}创建数据库打开Startup.cs 在ConfigureServices 下添加如下代码：publicvoidConfigureServices(IServiceCollectionservices)
{varconnection=Filename=./efcoredemo.db;
services.AddDbContextDataContext(options=options.UseSqlite(connection));//Addframeworkservices.services.AddMvc();
}添加好以后，我们来安装Microsoft.EntityFrameworkCore.ToolsInstall-PackageMicrosoft.EntityFrameworkCore.Tools–Pre安装好以后，我们在project.json tools 节点下tools:{Microsoft.EntityFrameworkCore.Tools:{version:1.0.0-preview1-final,imports:[portable-net45+win8+dnxcore50,portable-net45+win8
]
},开始创建数据库 使用dotnet ef打开文件夹的命令行，输入　　dotnet ef migrations add MyFirstMigration　　dotnet ef database update这样我们就创建好了数据库。更多命令请dotnet ef -h项目使用新建一个UserController然后 在Views 添加一个 User 文件，然后添加对应的视图。添加一个Register Action，再添加一个Register 视图按 Ctrl+C 复制代码按 Ctrl+C 复制代码UserController.cspublicclassUserController:Controller
{privateDataContext_context;publicUserController(DataContextcontext)
{
_context=context;
}//GET:/controller/
publicIActionResultIndex()
{returnView(_context.Users.ToList());
}publicIActionResultRegister()
{returnView();
}

[HttpPost]
[ValidateAntiForgeryToken]publicIActionResultRegister(Userregisteruser)
{if(ModelState.IsValid)
{
_context.Users.Add(registeruser);
_context.SaveChanges();returnRedirectToAction(Index);
}returnView(registeruser);
}
}程序运行起来：http://localhost:5000/User/Register列表展示http://localhost:5000/User参考文档：https://docs.efproject.net/en/latest/platforms/aspnetcore/new-db.html完整Demo下载https://pan.baidu.com/s/1bo0eTKr https://pan.baidu.com/s/1bo0eTKr'>ASP.NET Core 开发 - Entity Framework (EF) Core</a>&nbsp;&nbsp;&nbsp;&nbsp;<span>16-8-19 上午 12:00:00</span></li><li><span>5</span>&nbsp;&nbsp;<a class='btn btn-link' style='color: blue' href='../../../../../Artlcle/vip/1517C8B6-27DA-47E3-A596-0B384E544260.html' title='前言前几天.NET Core发布了.NET Core 1.0.1 R2 预览版，之前想着有时间尝试下.NET Core。由于各种原因，就没有初试。刚好，前几天看到.NET Core发布新版本了，决定要去一探究竟。于是乎，就立马去官网查找相关的信息，为初探做准备。下面就开始今天的内容，有两个部分：安装和创建示例程序。安装本人使用的是Windows 1064位系统，安装过Visual Studio 2015，如果没有安装，请先安装。下载安装文件进入.NET Core官网，进入下载页面1，进入下载页面2，下载所需的安装文件。需要下载的文件：.NET Core Installer(RC2).NET Core SDK Installer(Preview 1)Windows (Server Hosting)DotNetCore.1.0.0.RC2-VS2015ToolsNuGet Manager extension for Visual StudioWindows系统直接下载安装文件即可。Windows (Server Hosting)的作用相当于iis，是.NET Core Web项目的服务宿主程序，即可以直接使用Server Hosting运行Web项目。You probably only need to download one of these:.NET Core = Run apps with .NET Core runtime.NET Core SDK = Develop apps with .NET Core and the SDK+CLI (Software Development Kit/Command Line Interface) tools只需要安装下面其中一个就可以:.NET Core = .NET Core运行时.NET Core SDK = .NET Core运行时 + .NET Core开发套件(oftware Development Kit) + .NET Core 命令行工具(Command Line Interface)安装.NET Core提示：请先卸载.NET Core之前的版本，否则会报错。报错信息：The project is configured to use .NET Core SDK version 1.0.0-preview1-002702 which is not installed or cannot be found under the path C:\Program Files\dotnet\bin. These components are required to build and run this project. NetCoreR2.Sample.ConsoleApp双击下载的DotNetCore.1.0.0.RC2-Runtime-x64.exe，选择同意协议，然后点击Install安装，等待安装结束。安装.NET Core SDK双击下载的DotNetCore.1.0.0.RC2-SDK.Preview1-x64.exe，选择同意协议，然后点击Install安装，等待安装结束。安装Server Hosting双击下载的DotNetCore.1.0.0.RC2-WindowsHosting.exe，选择同意协议，然后点击Install安装，等待安装结束。安装.NET Core VS2015Tools双击下载的DotNetCore.1.0.0.RC2-VS2015Tools.Preview1.exe，选择同意协议，然后点击Install安装，等待安装结束。安装NuGet Manager extension for Visual Studio双击下载的NuGet.Tools.vsix，选择同意协议，然后点击Install安装，等待安装结束。NuGet Manager extension for Visual Studio Download示例示例有控制台程序和ASP.NET Core Web程序。.NET Core控制台程序打开Visual Studio 2015，新建一个项目:文件-新建-项目在左侧模板选择.NET Core，右侧选择控制台应用程序(.NET Core)。输入名称NetCoreR2.Sample.ConsoleApp，点击确定按钮。OK，.NET Core控制台应用程序创建完成。打开Program.cs文件，写入代码，运行。usingSystem;usingSystem.Collections.Generic;usingSystem.Linq;usingSystem.Threading.Tasks;namespaceNetCoreR2.Sample.ConsoleApp{publicclassProgram
{publicstaticvoidMain(string[]args){
Console.WriteLine(Hello.NETCore1.0.0R2ConsoleApp!);
Console.ReadLine();
}
}
}如果在这里提示ASP.NET Core Web项目在上面的解决方案上新建一个ASP.NET Core Web项目：添加-新建项目选择ASP.NET Core Web Application(.NET Core)，点击确定，创建项目。选择Web 应用程序更改身份验证为：不进行身份验证，然后确定。创建好项目后，等待Neget包还原，然后按F5，调试运行。可以选择IIS或WindowsHosting，在这选用后者。接下来，自己写一个控制器，并显示信息。创建一个HelloController控制器，添加一个Index的Action：usingSystem;usingSystem.Collections.Generic;usingSystem.Linq;usingSystem.Threading.Tasks;usingMicrosoft.AspNetCore.Mvc;//FormoreinformationonenablingMVCforemptyprojects,visithttp://go.microsoft.com/fwlink/?LinkID=397860namespaceNetCoreR2.Sample.WebApp.Controllers{publicclassHelloController:Controller
{//GET:/controller/
publicIActionResultIndex(){
ViewData[Msg]=Hello.NETCore1.0.0R2Asp.NetCoreMVCApp!;returnView();
}
}
}创建对应的视图文件，写入代码：@{
ViewData[Title]=HelloIndexPage;
}

h3@ViewData[Msg].ToString()/h3本文就介绍到这里。如有疑问请联系我。原文：.NET Core R2安装及示例教程'>NET Core R2安装教程及Hello示例</a>&nbsp;&nbsp;&nbsp;&nbsp;<span>16-8-16 上午 12:00:00</span></li><li><span>6</span>&nbsp;&nbsp;<a class='btn btn-link' style='color: blue' href='../../../../../Artlcle/vip/B1251104-F0B1-4D60-A774-B76967FE1E81.html' title='CentOS Mono Nginx 部署 MVC4+WebApi
经过几天的折磨，终于在CentOS上成功部署了MVC4+WebApi。Mono上的服务器推荐两种：Jexus（国产高人写的一款很牛的服务器）和Nginx(Fastcgi方式)。本文介绍Nginx如何部署MVC4+WebApi。
环境：
CentOS 6.4（32、64位）
Mono-3.2.1
Nginx 1.5.4
ASP.NET MVC 4
WebApi 1.0

一、首先安装一些需要的软件包
1、 首先更新CentOS上的软件包：yum y update。
2、 安装一些需要的库：

yum -y install gcc gcc-c++ bison pkgconfig glib2-devel gettext make libpng-devel libjpeg-devel libtiff-devel libexif-devel giflib-devel libX11-devel freetype-devel fontconfig-devel  cairo-devel
yum y install build-essential automake autoconf libtool bison libglib2.0-dev libfreetype6-dev libfontconfig-dev gettext libgif-dev libtiff4-dev libpng12-dev libexif-dev libx11-dev libxft-dev libjpeg-dev

以上的包挺多的，但是为了保险起见，还是全部安装吧，有可能还会有缺少包的情况，就使用yum自己安装吧。
二、下载所需要的软件包
我把所有的软件包都下载在/usr/local/src中了，你也可以选择其他的位置。
 首先在命令行执行：cd /usr/local/src，然后开始下载以下软件包。
1、 Mono：由于从Mono3.0之后编译源代码需要原来有一个老的Mono环境，所以必须要下载两个版本的Mono：Mono-2.11.4和Mono-3.2.1。

Mono-2.11.4：
wget http://origin-download.mono-project.com/sources/mono/mono-2.11.4.tar.bz2

Mono-3.2.1：
wget http://origin-download.mono-project.com/sources/mono/mono-3.2.1.tar.bz2

2、 Libgdiplus：

wget http://download.mono-project.com/sources/libgdiplus/libgdiplus-2.10.9.tar.bz2

3、 xsp：xsp是Mono提供的一个测试版本的服务器，但是也提供Nginx运行asp.net的fastcgi。
官网上的xsp是2.x的，这个版本的fastcgi-mono-server4不能用；所以需要从github上下载最新的3.0版本。（git之前，要使用yum y intall git安装git包。）

Yum y install git。
Git clone https://github.com/mono/xsp.git

4、 pcre：

wget ftp://ftp.csx.cam.ac.uk/pub/software/programming/pcre/pcre-8.33.tar.bz2

5、 Nginx：

wget http://nginx.org/download/nginx-1.5.4.tar.gz

关于Nginx这个下载的是最新版本，需要自己安装，也可以使用配置yum源头的方式安装，这个安装的好处是：执行yum命令后就自动安装完了，最后还会帮你生成一个nginx的帮助命令文件，帮助你执行nginx的启动、重启和关闭等等。本文先介绍自己编译安装的情况（个人喜好这种方式，因为新版的Nginx已经添加了一些辅助命令了，以后介绍。）
三、安装软件包
1、 安装Mono：
(1) 首先安装Mono 2.11.4：执行以下命令，

转到存放目录：Cd /usr/local/src
解压：tar jxvf mono.2.11.4.tar.bz2
转到解压后的目录：Cd mono-2.11.4
Configure：我把mono安装在usr目录下，所以执行以下命令：
./configure --prefix=/usr
编译安装：make  make install（这个过程比较漫长，去干点别的吧。）

(2) Mono2.11.4安装完成之后，开始安装Mono3.2.1：执行以下命令：

cd /usr/local/src
tar jvxf mono-3.2.1.tar.bz2
cd mono-3.2.1
./autogen.sh prefix=/usr
make (这个过程也很漫长)

(3) mono-3.2.1编译完成之后，需要先卸载掉Mono-2.11.4:

cd /usr/local/src/mono-2.11.4
make uninstall

(4) 卸载完mono-2.11.4之后开始安装mono-3.2.1：

cd /usr/local/src/mono-3.2.1
make install

(5)安装完成之后，执行一下ldconfig命令，确保新安装的动态库可以被找到。

 ldconfig 

2、 安装libgdiplus：

cd /usr/local/src
tar jxvf libgdiplus-2.10.9.tar.bz2
cd libgdiplus-2.10.9
./configure prefix=/usr
Make  make install
ldconfig

3、 安装xsp：

cd /usr/local/src/xsp
./autogen.sh prefix=/usr
make  make install

4、 安装pcre：

cd /usr/local/src
tar jxvf pcre-8.33.tar.bz2
cd pcre-8.33
./configure prefix=/usr
make  make install

5、 安装nginx：
开始说了nginx的安装可以使用yum源的方式，也可以使用自己编译的方式，下面是自己编译的方式：

cd /usr/local/src
tar zxvf nginx-1.5.4.tar.gz
cd nginx-1.5.4
./configure prefix=/usr/nginx（nginx安装在nginx目录里面）
make  make install

（注：第二种安装nginx的方法：http://www.cnblogs.com/highend/archive/2013/03/06/centos6_3_install_nginx_1_2_7.html）
四、配置nginx：
1、 开放80端口：

iptables -I INPUT -p tcp --dport 80 -j ACCEPT
service iptables save （这句把上述规则写进防火墙中，要不以后每次都要开启80端口）
启动nginx
/usr/nginx/sbin/nginx

启动之后，就可以通过地址访问nginx了，自己访问看看吧。
2、 配置nginx：

vi /usr/nginx/conf/nginx.conf

修改server如下：

server {
         listen   80;
         server_name  localhost;
         location / {
                 root /usr/nginx/html;
                 index index.html index.htm;
                 fastcgi_index Default.aspx;
                 fastcgi_pass 127.0.0.1:9000;
                 include /usr/nginx/conf/fastcgi_params;
         }
 }

打开fastcgi_params，在最后面添加以下两句：

vi /usr/nginx/conf/fastcgi_params
fastcgi_param  PATH_INFO          "";
fastcgi_param  SCRIPT_FILENAME    $document_root$fastcgi_script_name;


五、编写MVC+WebApi程序：
1、 使用vs建立mvc4项目，选择基本或者空。
2、 项目建立好后，删除对System.Web.Providers.dll的引用，这个貌似不支持，添加上去就无法执行程序。
3、 以下dll从本地复制出来放到你的项目下面，建立个libs，放到这里吧。
这些dll我已经复制出来了，放到后附件下载中，如果你不想自己一个一个的复制的话，就使用附件里面的吧。

Mvc4对应的dll：
Microsoft.Web.Infrastructure.dll
System.Web.Helpers.dll
System.Web.Mvc.dll
System.Web.Razor.dll
System.Web.WebPages.Deployment.dll
System.Web.WebPages.dll
System.Web.WebPages.Razor.dll
WebApi对应dll：
System.Net.Http.dll（注意：这个dll要复制4.0的哦，不要2.0的。）
System.Net.Http.Formatting.dll
System.Net.Http.WebRequest.dll
Webgrease对应的dll：
System.Web.Optimization.dll


4、 删除掉原来项目中对以上dll的引用，重新添加引用，地址为你的项目中的libs（存放你复制的dll的文件夹），注意：
Mvc4对应的dll复制本地都选择True；
WebApi对应的dll中System.Net.Http.Formatting.dll选择复制本地就可以了。
Webgrease对应的dll：System.Web.Optimization.dll选择复制本地。
5、 配置Web.config
由于我们使用了System.Net.Http.dll的4.0版本，Webgrease也有可能会因为版本问题保存，所以需要在配置文件中配置升级配置，具体如下：

runtime
    assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1"
      dependentAssembly
        assemblyIdentity name="System.Web.Helpers" publicKeyToken="31bf3856ad364e35"/
        bindingRedirect oldVersion="1.0.0.0-2.0.0.0" newVersion="2.0.0.0" /
      /dependentAssembly
      dependentAssembly
        assemblyIdentity name="System.Web.Mvc" publicKeyToken="31bf3856ad364e35" /
        bindingRedirect oldVersion="1.0.0.0-4.0.0.0" newVersion="4.0.0.0" /
      /dependentAssembly
      dependentAssembly
        assemblyIdentity name="System.Web.WebPages"publicKeyToken="31bf3856ad364e35" /
        bindingRedirect oldVersion="1.0.0.0-2.0.0.0" newVersion="2.0.0.0" /
      /dependentAssembly
 
      dependentAssembly
        assemblyIdentity name="WebGrease" publicKeyToken="31bf3856ad364e35" /
        bindingRedirect oldVersion="1.0.0.0-1.3.0.0" newVersion="1.3.0.0" /
      /dependentAssembly
 
      dependentAssembly
        assemblyIdentity name="System.Net.Http" publicKeyToken="b03f5f7f11d50a3a" /
        bindingRedirect oldVersion="0.0.0.0-4.0.0.0" newVersion="4.0.0.0" /
      /dependentAssembly
    /assemblyBinding
  /runtime

如果有runtime这个配置节，就按照这个配置，如果没有，就自己添加。其中只有WebGrease和System.Net.Http是必须的，其他可有可无。
6、 添加Controller、View和WebApi
在Controllers文件夹下添加一个HomeController控制器，然后添加一个Index视图。
然后再添加一个FirstApiController的WebApi。
7、按照文件的方式发布程序。

六、部署
使用ftp或者winscp等等工具，把发布好的程序上传到centos的 /usr/nginx/html中，
还有重要的一步：发布完成后，一定要修改删除Web.config中
httpRuntime targetFramework="4.5" /
compilation targetFramework="4.5" /
这两行，因为mono不支持httpRuntime targetFramework="4.5" /这个中的targetFramework，为了保险起见把compilation targetFramework="4.5" /也删除了。
七、启动
1、重启nginx

/usr/nginx/sbin/nginx s reload

2、启动 fastcgi_mono服务器

fastcgi-mono-server4 /applications=/:/usr/nginx/html /socket=tcp:127.0.0.1:9000


八、开始访问吧
你以为你到这里就可以正确访问你的程序了，你要是这样认为你就错了。记得在windows下，我们输入xxx、xxx/home或者xxx/home/index就可以正确访问了，如果在mono下你也这样干，你就错了，你必须要注意url地址的大小写，如果你的Controller是HomeController，首页是Index，那你就老老实实的xxx/Home或者xxx/Home/Index这样访问，否则就提示你老死也找不到视图啊（这个简答的问题差点把我搞疯掉啊）。这些应该在nginx或者mono下面可以配置，暂时没找到配置的地方，有知道的兄弟姐妹可以告知一下啊。
总之一条：在mono下一定要注意大小写。



附录：使用jexus替代nginx
Jexus是个好东东啊，比nginx配置起来简单，也非常好的支持最新的mono。
1、 下载Jexus

cd /usr/local/src
wget http://www.linuxdot.net/down/jexus-5.4.3.tar.gz

2、 安装Jexus

tar -zvxf jexus-5.4.tar.gz
cd jexus-5.4
sudo ./install
3、  启动Jexus
cd /usr/jexus
sudo ./jws start

4、 部署
把你的发布文件上传到jexus对应的web目录就可以了，部署的方式和上面nginx是一样的，注意点也一样哦。
部署完成之后，直接重启jexus就可以了（sudo ./jws restart）。
然后，你就可以尽情的访问了。

写的有点仓促，不合理的地方，请大家指正，谢谢！

参考：
1、CentOS 6.3下 安装 Mono 3.2 和Jexus 5.4
http://www.cnblogs.com/shanyou/p/3218611.html
2、在Ubuntu13.04中配置Jexus+Mono3.2运行Asp.Net Mvc 4站点 (一)
http://www.cnblogs.com/windvoice/p/3221974.html
3、Linux上搭建Asp.net MVC3环境(CentOS + Nginx + Mono)
http://www.cnblogs.com/bboy/archive/2012/10/08/2714626.html
4、CentOS上搭建Nginx + Mono 运行 asp.net
http://www.cnblogs.com/wander1129/archive/2011/12/16/mono.html
5、CentOS 6.3 - 安装 Nginx 1.2.7（yum源）
http://www.cnblogs.com/highend/archive/2013/03/06/centos6_3_install_nginx_1_2_7.html
6、FastCGI Nginx
http://www.mono-project.com/FastCGI_Nginx

附件：
所需要的dll附件
可以部署的项目源码
所需要的dll附件 百度网盘下载
可以部署的项目源码 百度网盘下载



'>Linux上搭建Asp.net MVC3环境(CentOS + Nginx + Mono)</a>&nbsp;&nbsp;&nbsp;&nbsp;<span>16-8-14 上午 12:00:00</span></li><li><span>7</span>&nbsp;&nbsp;<a class='btn btn-link' style='color: blue' href='../../../../../Artlcle/vip/3E2D9B5E-D12C-4693-8C7E-A2BC5C049311.html' title='#user nobody;worker_processes 4;#error_log logs/error.log;#error_log logs/error.log notice;error_log logs/error.log info;pid    logs/nginx.pid;events {	use epoll;  worker_connections 1000;}http {  ###################### websocket ######################  map $http_upgrade $connection_upgrade {    default upgrade;     close;  }  ###################### websocket ######################  include    mime.types;  default_type application/octet-stream;  #log_format main $remote_addr - $remote_user [$time_local] $request   #         $status $body_bytes_sent $http_referer   #         $http_user_agent $http_x_forwarded_for;  #access_log logs/access.log main;  access_log off;  sendfile    on;  #tcp_nopush   on;  keepalive_timeout 65;  gzip on;  gzip_min_length 1k;  gzip_buffers 4 16k;  gzip_comp_level 2;  gzip_vary off;	#gzip_proxied   expired no-cache no-store private auth;	#gzip_types    text/plain application/xml:;	#gzip_disable   MSIE [1-6]\.;			############################### lms.ypzhixiao.edu.sh.cn#######################################  upstream  eduserver{	ip_hash;    server 10.30.176.244:8080;    server 10.30.176.246:8080;  }     upstream  edustreaming{	ip_hash;    server 10.30.176.244:8080;    #server 192.168.8.178:8080;  }   server {    listen 80;    server_name lms.ypzhixiao.edu.sh.cn;    #charset koi8-r;    #access_log logs/host.access.log main;    limit_rate_after 5m;    limit_rate 512k;    index index.html;    charset utf-8;    root /;    location / {      #root  html;      #index index.html index.htm;			#proxy_http_version 1.1;	       proxy_set_header Host $host;      proxy_set_header x-forwarded-for $remote_addr;	  proxy_pass http://eduserver;	  proxy_connect_timeout 50000s;      proxy_read_timeout 50000s;      proxy_send_timeout 50000s;      client_max_body_size 600m;    }			  location /streaming/ {      #root  html;      #index index.html index.htm;	    #proxy_http_version 1.1;	 	    proxy_set_header Host $host;      proxy_set_header x-forwarded-for $remote_addr;	    proxy_pass http://edustreaming;	    proxy_connect_timeout 50000s;      proxy_read_timeout 50000s;      proxy_send_timeout 50000s;      client_max_body_size 600m;      }		      location ~ \.mp4$ {       mp4;      }      location ~ \.pdf$ {          root /;      }      location ~ /res/.*\.(png|jpg|jpeg|pdg|gif|bmp|ico|tif|mp3|swf|html|js|css|xml)$ {        root /;      }      ###################### head|course|kv|watermark ##################################      location ~ /share/.*\.(png|jpg|jpeg|pdg|gif|bmp|ico|tif)$ {		root /res/;      }      ###################### head|course|kv|watermark ##################################    ###################### websocket ######################    location ~ Servlet {        proxy_pass http://10.30.176.244:8080;        proxy_http_version 1.1;        proxy_set_header Upgrade $http_upgrade;        proxy_set_header Connection $connection_upgrade;    }    location ~ /(classTeach|courseOutline|courseOutlineLock|classHour|courseSelect)/ {        proxy_pass http://10.30.176.244:8080;        proxy_set_header Host $host;        proxy_set_header x-forwarded-for $remote_addr;    }    ###################### websocket ######################	location ~ /jyedu/.*\.(js|css|woff|jpg|jpeg|png)$ {	  root /var/www;	}    location ~ /(assets|css|images|js)/.*\.(js|css|woff|jpg|jpeg|png|map)$ {      root /var/www/jyedu-portal;    }    error_page  500 502 503 504 /50x.html;    location = /50x.html {      root  html;    }  }	############################### lms.ypzhixiao.edu.sh.cn #######################################		############################### ucp.ypzhixiao.edu.sh.cn#######################################	server{		listen 80;    server_name ucp.ypzhixiao.edu.sh.cn;		charset utf-8;		location /		{		  index index.jsp index.html index.htm			proxy_set_header Host $host;      proxy_set_header x-forwarded-for $remote_addr;     			proxy_pass http://10.30.176.248:8080;			rewrite ^/$ /ucp last;      proxy_read_timeout 50000s;      proxy_send_timeout 50000s;      client_max_body_size 600m;    }	}	############################### ucp.ypzhixiao.edu.sh.cn #######################################	############################### rwgl.ypzhixiao.edu.sh.cn#######################################	server{		listen 80;    server_name rwgl.ypzhixiao.edu.sh.cn;		charset utf-8;		location /		{		  index index.jsp index.html index.htm			proxy_set_header Host $host;      proxy_set_header x-forwarded-for $remote_addr;     			proxy_pass http://10.30.176.248:8080;			rewrite ^/$ /rwgl last;      proxy_read_timeout 50000s;      proxy_send_timeout 50000s;      client_max_body_size 600m;    }	}	############################### rwgl.ypzhixiao.edu.sh.cn #######################################	############################### dop.ypzhixiao.edu.sh.cn#######################################	server{		listen 80;    server_name dop.ypzhixiao.edu.sh.cn;		charset utf-8;		location /		{		  index index.jsp index.html index.htm			proxy_set_header Host $host;      proxy_set_header x-forwarded-for $remote_addr;     			proxy_pass http://10.30.176.248:8080;      proxy_read_timeout 50000s;      proxy_send_timeout 50000s;      client_max_body_size 600m;    }	}	############################### dop.ypzhixiao.edu.sh.cn #######################################	#================== start	############################### portal.ypzhixiao.edu.sh.cn:8080#######################################	server{		listen 80;    server_name portal.ypzhixiao.edu.sh.cn;		charset utf-8;		location /		{		  index index.jsp index.html index.htm			proxy_set_header Host $host;      proxy_set_header x-forwarded-for $remote_addr;     			proxy_pass http://10.30.176.247:8080;			rewrite ^/$ /portal last;      proxy_read_timeout 50000s;      proxy_send_timeout 50000s;      client_max_body_size 600m;    }	}	############################### portal.ypzhixiao.edu.sh.cn:8080 #######################################	#================== end	############################### jysx.ypzhixiao.edu.sh.cn#######################################	server{		listen 80;    server_name jysx.ypzhixiao.edu.sh.cn;		charset utf-8;		location /		{		  index index.jsp index.html index.htm login.html			proxy_set_header Host $host;      proxy_set_header x-forwarded-for $remote_addr;     			proxy_pass http://10.30.176.6:8080;			rewrite ^/$ /PracticeClient last;      proxy_read_timeout 50000s;      proxy_send_timeout 50000s;      client_max_body_size 600m;    }	}	############################### jysx.ypzhixiao.edu.sh.cn #######################################	############################### szt.ypzhixiao.edu.sh.cn#######################################	server{		listen 80;    server_name szt.ypzhixiao.edu.sh.cn;		charset utf-8;		location /		{		  index index.jsp index.html index.htm			proxy_set_header Host $host;      proxy_set_header x-forwarded-for $remote_addr;     			proxy_pass http://10.30.176.248:8080;			rewrite ^/$ /szt last;      proxy_read_timeout 50000s;      proxy_send_timeout 50000s;      client_max_body_size 600m;    }	}	############################### szt.ypzhixiao.edu.sh.cn #######################################    ############################### oa.ypzhixiao.edu.sh.cn#######################################	server{		listen 80;    server_name oa.ypzhixiao.edu.sh.cn;		charset utf-8;		location /		{		  index index.jsp index.html index.htm			proxy_set_header Host $host;      proxy_set_header x-forwarded-for $remote_addr;     			proxy_pass http://10.30.176.243;      proxy_read_timeout 50000s;      proxy_send_timeout 50000s;      client_max_body_size 600m;    }	}	############################### oa.ypzhixiao.edu.sh.cn #######################################  ############################### moa.ypzhixiao.edu.sh.cn#######################################	server{		listen 80;    server_name moa.ypzhixiao.edu.sh.cn;		charset utf-8;		location /		{		  index index.jsp index.html index.htm			proxy_set_header Host $host;      proxy_set_header x-forwarded-for $remote_addr;     			proxy_pass http://moa.ypzx.net;      proxy_read_timeout 50000s;      proxy_send_timeout 50000s;      client_max_body_size 600m;    }	}	############################### moa.ypzhixiao.edu.sh.cn #######################################		############################### mis.ypzhixiao.edu.sh.cn#######################################	server{		listen 80;    server_name mis.ypzhixiao.edu.sh.cn;		charset utf-8;		location /		{		  index index.jsp index.html index.htm			proxy_set_header Host $host;      proxy_set_header x-forwarded-for $remote_addr;     			proxy_pass http://10.30.176.246:8080;      proxy_read_timeout 50000s;      proxy_send_timeout 50000s;      client_max_body_size 600m;    }	}	############################### mis.ypzhixiao.edu.sh.cn #######################################	############################### yzsj.ypzhixiao.edu.sh.cn#######################################	server{		listen 80;    server_name yzsj.ypzhixiao.edu.sh.cn;		charset utf-8;		location /		{		  index index.jsp index.html index.htm			proxy_set_header Host $host;      proxy_set_header x-forwarded-for $remote_addr;     			proxy_pass http://10.30.176.6:8080;			rewrite ^/$ /yzsj last;      proxy_read_timeout 50000s;      proxy_send_timeout 50000s;      client_max_body_size 600m;    }	}	############################### yzsj.ypzhixiao.edu.sh.cn #######################################	}'>Asp.net MVC5 Nginx+Mono反向代理 配置</a>&nbsp;&nbsp;&nbsp;&nbsp;<span>16-8-13 上午 12:00:00</span></li><li><span>8</span>&nbsp;&nbsp;<a class='btn btn-link' style='color: blue' href='../../../../../Artlcle/vip/16C7E4AE-EC9B-47A3-873E-B0749AC248C1.html' title='前端HTML5几种存储方式的总结接下来要好好总结一些知识，秋招来啦。。。虽然有好多知识都不大会，但是还是要努力一下，运气这种东西，谁知道呢~总体情况h5之前，存储主要是用cookies。cookies缺点有在请求头上带着数据，大小是4k之内。主Domain污染。主要应用：购物车、客户登录对于IE浏览器有UserData，大小是64k,只有IE浏览器支持。目标解决4k的大小问题解决请求头常带存储信息的问题解决关系型存储的问题跨浏览器1.本地存储localstorage存储方式：以键值对(Key-Value)的方式存储，永久存储，永不失效，除非手动删除。大小：每个域名5M支持情况：注意：IE9localStorage不支持本地文件，需要将项目署到服务器，才可以支持！检测方法：12345if(window.localStorage){alert(This browser supports localStorage);}else{alert(This browser does NOT support localStorage);}常用的API：getItem //取记录setIten//设置记录removeItem//移除记录key//取key所对应的值clear//清除记录存储的内容：数组，图片，json，样式，脚本。。。（只要是能序列化成字符串的内容都可以存储）2.本地存储sessionstorageHTML5 的本地存储 API 中的 localStorage 与 sessionStorage 在使用方法上是相同的，区别在于 sessionStorage 在关闭页面后即被清空，而 localStorage 则会一直保存。3.离线缓存（application cache）本地缓存应用所需的文件使用方法：①配置manifest文件页面上：1234!DOCTYPEHTMLhtmlmanifest=demo.appcache.../htmlManifest 文件：manifest 文件是简单的文本文件，它告知浏览器被缓存的内容（以及不缓存的内容）。manifest 文件可分为三个部分：①CACHE MANIFEST- 在此标题下列出的文件将在首次下载后进行缓存②NETWORK- 在此标题下列出的文件需要与服务器的连接，且不会被缓存③FALLBACK- 在此标题下列出的文件规定当页面无法访问时的回退页面（比如 404 页面）完整demo：12345678910CACHE MANIFEST# 2016-07-24 v1.0.0/theme.css/main.jsNETWORK:login.jspFALLBACK:/html/ /offline.html服务器上：manifest文件需要配置正确的MIME-type，即 text/cache-manifest。如Tomcat:1234mime-mappingextensionmanifest/extensionmime-typetext/cache-manifest/mime-type/mime-mapping常用API：核心是applicationCache对象，有个status属性，表示应用缓存的当前状态：0（UNCACHED）: 无缓存， 即没有与页面相关的应用缓存1（IDLE）:闲置，即应用缓存未得到更新2 （CHECKING）:检查中，即正在下载描述文件并检查更新3 （DOWNLOADING）:下载中，即应用缓存正在下载描述文件中指定的资源4 （UPDATEREADY）:更新完成，所有资源都已下载完毕5 （IDLE）: 废弃，即应用缓存的描述文件已经不存在了，因此页面无法再访问应用缓存相关的事件：表示应用缓存状态的改变：checking : 在浏览器为应用缓存查找更新时触发error:在检查更新或下载资源期间发送错误时触发noupdate : 在检查描述文件发现文件无变化时触发downloading : 在开始下载应用缓存资源时触发progress：在文件下载应用缓存的过程中持续不断地下载地触发updateready : 在页面新的应用缓存下载完毕触发cached : 在应用缓存完整可用时触发Application Cache的三个优势：① 离线浏览② 提升页面载入速度③ 降低服务器压力注意事项：1.浏览器对缓存数据的容量限制可能不太一样（某些浏览器设置的限制是每个站点 5MB）2. 如果manifest文件，或者内部列举的某一个文件不能正常下载，整个更新过程将视为失败，浏览器继续全部使用老的缓存3. 引用manifest的html必须与manifest文件同源，在同一个域下4.浏览器会自动缓存引用manifest文件的HTML文件，这就导致如果改了HTML内容，也需要更新版本才能做到更新。5. manifest文件中CACHE则与NETWORK，FALLBACK的位置顺序没有关系，如果是隐式声明需要在最前面6. FALLBACK中的资源必须和manifest文件同源7. 更新完版本后，必须刷新一次才会启动新版本（会出现重刷一次页面的情况），需要添加监听版本事件。8. 站点中的其他页面即使没有设置manifest属性，请求的资源如果在缓存中也从缓存中访问9. 当manifest文件发生改变时，资源请求本身也会触发更新点我参考更多资料！离线缓存与传统浏览器缓存区别：1. 离线缓存是针对整个应用，浏览器缓存是单个文件2. 离线缓存断网了还是可以打开页面，浏览器缓存不行3. 离线缓存可以主动通知浏览器更新资源4.Web SQL关系数据库，通过SQL语句访问Web SQL 数据库 API 并不是 HTML5 规范的一部分，但是它是一个独立的规范，引入了一组使用 SQL 操作客户端数据库的 APIs。支持情况：Web SQL 数据库可以在最新版的 Safari, Chrome 和 Opera 浏览器中工作。核心方法：①openDatabase：这个方法使用现有的数据库或者新建的数据库创建一个数据库对象。②transaction：这个方法让我们能够控制一个事务，以及基于这种情况执行提交或者回滚。③executeSql：这个方法用于执行实际的 SQL 查询。打开数据库：12var db = openDatabase(mydb, 1.0, Test DB, 2 * 1024 * 1024,fn);//openDatabase() 方法对应的五个参数分别为：数据库名称、版本号、描述文本、数据库大小、创建回调执行查询操作：1234var db = openDatabase(mydb, 1.0, Test DB, 2 * 1024 * 1024);db.transaction(function (tx) {tx.executeSql(CREATE TABLE IF NOT EXISTS WIN (id unique, name));});插入数据：　123456var db = openDatabase(mydb, 1.0, Test DB, 2 * 1024 * 1024);db.transaction(function (tx) {tx.executeSql(CREATE TABLE IF NOT EXISTS WIN (id unique, name));tx.executeSql(INSERT INTO WIN (id, name) VALUES (1, winty));tx.executeSql(INSERT INTO WIN (id, name) VALUES (2, LuckyWinty));});读取数据：123456789101112db.transaction(function (tx) {tx.executeSql(SELECT * FROM WIN, [], function (tx, results) {var len = results.rows.length, i;msg = p查询记录条数:  + len + /p;document.querySelector(#status).innerHTML += msg;for (i = 0; i  len; i++){alert(results.rows.item(i).name );}}, null);});由这些操作可以看出，基本上都是用SQL语句进行数据库的相关操作，如果你会MySQL的话，这个应该比较容易用。点我看更多教程！5.IndexedDB索引数据库 (IndexedDB) API（作为 HTML5 的一部分）对创建具有丰富本地存储数据的数据密集型的离线 HTML5 Web 应用程序很有用。同时它还有助于本地缓存数据，使传统在线 Web 应用程序（比如移动 Web 应用程序）能够更快地运行和响应。异步API：在IndexedDB大部分操作并不是我们常用的调用方法，返回结果的模式，而是请求——响应的模式，比如打开数据库的操作这样，我们打开数据库的时候，实质上返回了一个DB对象，而这个对象就在result中。由上图可以看出，除了result之外。还有几个重要的属性就是onerror、onsuccess、onupgradeneeded（我们请求打开的数据库的版本号和已经存在的数据库版本号不一致的时候调用）。这就类似于我们的ajax请求那样。我们发起了这个请求之后并不能确定它什么时候才请求成功，所以需要在回调中处理一些逻辑。关闭与删除：123456functioncloseDB(db){db.close();}functiondeleteDB(name){indexedDB.deleteDatabase(name);}数据存储：indexedDB中没有表的概念，而是objectStore，一个数据库中可以包含多个objectStore，objectStore是一个灵活的数据结构，可以存放多种类型数据。也就是说一个objectStore相当于一张表，里面存储的每条数据和一个键相关联。我们可以使用每条记录中的某个指定字段作为键值（keyPath），也可以使用自动生成的递增数字作为键值（keyGenerator），也可以不指定。选择键的类型不同，objectStore可以存储的数据结构也有差异。　这个就有点复杂了。看这里的教程：1.http://www.cnblogs.com/dolphinX/p/3415761.html　2.http://www.cnblogs.com/dolphinX/p/3416889.html详细API地址：http://www.ibm.com/developerworks/cn/web/wa-indexeddb/#ibm-pcon'>前端HTML5几种存储方式的总结</a>&nbsp;&nbsp;&nbsp;&nbsp;<span>16-7-26 上午 12:00:00</span></li><li><span>9</span>&nbsp;&nbsp;<a class='btn btn-link' style='color: blue' href='../../../../../Artlcle/vip/86ACB03F-846B-47EB-9922-0D878FF97BA8.html' title='ｃｏｎｔｒｏｌ页面    /// summary    /// 验证码生产    /// /summary    public byte[] CreateValidateGraphic    {      get      {        string chkCode = string.Empty;        //颜色列表，用于验证码、噪线、噪点        Color[] color = { Color.Black, Color.Red, Color.Blue, Color.Green, Color.Orange, Color.Brown, Color.Brown, Color.DarkBlue };        //字体列表，用于验证码        string[] font = { Times New Roman, MS Mincho, Book Antiqua, Gungsuh, PMingLiU, Impact };        char[] character = { 2, 3, 4, 5, 6, 8, 9, A, B, C, D, E, F, G, H, J, K, L, M, N, P, R, S, T, W, X, Y };        Random rnd = new Random();        //生成验证码字符串        for (int i = 0; i  4; i++)        {          chkCode += character[rnd.Next(character.Length)];        }        Bitmap bmp = new Bitmap(100, 40);        Graphics g = Graphics.FromImage(bmp);        g.Clear(Color.White);        //画噪线        for (int i = 0; i  10; i++)        {          int x1 = rnd.Next(100);          int y1 = rnd.Next(40);          int x2 = rnd.Next(100);          int y2 = rnd.Next(40);          Color clr = color[rnd.Next(color.Length)];          g.DrawLine(new Pen(clr), x1, y1, x2, y2);        }        //画验证码字符串        for (int i = 0; i  chkCode.Length; i++)        {          string fnt = font[rnd.Next(font.Length)];          Font ft = new Font(fnt, 18);          Color clr = color[rnd.Next(color.Length)];          g.DrawString(chkCode[i].ToString(), ft, new SolidBrush(clr), (float)i * 20 + 8, (float)8);        }        //画噪点        for (int i = 0; i  100; i++)        {          int x = rnd.Next(bmp.Width);          int y = rnd.Next(bmp.Height);          Color clr = color[rnd.Next(color.Length)];          bmp.SetPixel(x, y, clr);        }        g.DrawRectangle(new Pen(Color.Silver), 0, 0, bmp.Width - 1, bmp.Height - 1);        MemoryStream stream = new MemoryStream();        bmp.Save(stream, ImageFormat.Jpeg);        Session[code] = chkCode;        return stream.ToArray();      }    }   public ActionResult GetValidateCode()    {      return File(CreateValidateGraphic, @image/jpeg);    }ＶＩｅｗ前台调用img id=valiCode style=cursor: pointer; src=../ControlPlan/GetValidateCode alt=单击刷新验证码 /＜ｓｃｒｉｐｔ＞  $(#valiCode).bind(click, function () {        this.src = /ControlPlan/GetValidateCode?time= + (new Date()).getTime();      });＜／ｓｃｒｉｐｔ＞'>ＭＶＣ５　生成验证码</a>&nbsp;&nbsp;&nbsp;&nbsp;<span>16-7-21 上午 12:00:00</span></li><li><span>10</span>&nbsp;&nbsp;<a class='btn btn-link' style='color: blue' href='../../../../../Artlcle/vip/1457AF9C-FD3A-414F-BA4C-6F5E12FC1BD9.html' title='BundleConfig绑定需要注意只能引用非min.*未压缩文件，不然需要在发布到服务器时webconfig文件的增加如下节点，或者申明BundleTable.EnableOptimizations =true;关闭压缩功能，因为服务器默认是需要压缩的system.web  compilation targetFramework=4.6 debug=true//system.webusing System.Web;using System.Web.Optimization;namespace Wafxw{  public class BundleConfig  {    // 有关绑定的详细信息，请访问 http://go.microsoft.com/fwlink/?LinkId=301862    public static void RegisterBundles(BundleCollection bundles)    {      BundleTable.EnableOptimizations =StaticTool.GetWebConfig(EnableOptimizations).ToLower().Trim().ToString()== true ? true : false;      bundles.Add(new StyleBundle(~/Content/css).Include(              ~/Content/Plug/charismas/charisma-app.css,              ~/Content/Plug/Boostrap/css/bootstrap-slider.css,              ~/Content/Plug/Boostrap/css/bootstrap-select.css,              ~/Content/Plug/Boostrap/css/bootstrap-switch.css,              ~/Content/Plug/layer/skin/layer.css,              ~/Content/Plug/Boostrap/bootstrap-3.3.5-dist/css/bootstrap.css,              ~/Content/css/themesStyle.css));      bundles.Add(new ScriptBundle(~/Content/js).Include(          ~/Content/Plug/jquery/jquery-1.9.1.js,          ~/Content/Plug/Boostrap/bootstrap-3.3.5-dist/js/bootstrap.js,          ~/Content/Plug/charismas/jquery.cookie.js,          ~/Content/Plug/Boostrap/js/bootstrap-select.js,          ~/Content/Plug/Boostrap/js/bootstrap-switch.js,          ~/Content/Plug/Boostrap/js/bootstrap-slider.js,          ~/Content/Plug/layer/layer.js,          ~/Content/Plug/ueditor1_4_3_3-utf8-net/ueditor.config.js,          ~/Content/Plug/ueditor1_4_3_3-utf8-net/ueditor.all.js,          ~/Content/Plug/ueditor1_4_3_3-utf8-net/lang/zh-cn/zh-cn.js,          ~/Content/js/layout.js,          ~/Content/Plug/laydate/laydate.js));         }  }}在Layout页引用如下方法  @Styles.Render(~/Content/css)  @Scripts.Render(~/Content/js)'>MVC5 css&JS合并绑定 BundleConfig</a>&nbsp;&nbsp;&nbsp;&nbsp;<span>16-7-18 上午 12:00:00</span></li><li><span>11</span>&nbsp;&nbsp;<a class='btn btn-link' style='color: blue' href='../../../../../Artlcle/vip/FFD1C486-A585-461C-9DC1-0E15471E5487.html' title=' //编码转汉子 public static string Utos(string str)  {    if (string.IsNullOrEmpty(str)) return ;    return System.Web.HttpUtility.UrlDecode(str);  }  public static string GetWebConfig(string Key)  {    try    {      return System.Configuration.ConfigurationManager.ConnectionStrings[Key].ToString();    }    catch    {      try      {        return System.Configuration.ConfigurationManager.AppSettings[Key].ToString();      }      catch (Exception e)      {        return e.Message;      }    }  }'>编码转 字符和通用读取webConfig方法</a>&nbsp;&nbsp;&nbsp;&nbsp;<span>16-7-18 上午 12:00:00</span></li><li><span>12</span>&nbsp;&nbsp;<a class='btn btn-link' style='color: blue' href='../../../../../Artlcle/vip/931D9C04-24D1-4614-AC58-88F51709AC39.html' title='WebConfig增加如下节点 system.web  caching   !--启动缓存依赖，每5秒轮询一次--   sqlCacheDependency enabled=true pollTime=5000    databases     add name=KebueDB connectionStringName=ConnString pollTime=5000/    /databases   /sqlCacheDependency  /caching二Global文件Application_Start方法里面增加 string[] table = 要依赖的数据表名字;      var connectionString = StaticTool.GetWebConfig(ConnString); //启动数据库的数据缓存依赖功能        SqlCacheDependencyAdmin.EnableNotifications(connectionString);   //启动数据库的数据缓存依赖功能                SqlCacheDependencyAdmin.EnableTableForNotifications(connectionString, table);    //启用数据表缓存三 后台调用方法 public static void Insert(string KeyCache, object val, string table)  {    try    {      System.Web.HttpContext.Current.Cache.Insert(KeyCache, val, new SqlCacheDependency(KebueDB, table));    }    catch (Exception e)    {      string error = e.ToString();    }  }  public static object GetCache(string KeyCache)  {    try    {      if (System.Web.HttpContext.Current.Cache[KeyCache] != null)        return System.Web.HttpContext.Current.Cache[KeyCache];      else return null;    }    catch (Exception)    {      return null;    }  }  public static bool Exist(string KeyCache)  {    try    {      if (System.Web.HttpContext.Current.Cache[KeyCache] != null)        return true;      else        return false;    }    catch (Exception)    {      return false;    }  }四数据库开启缓存Select DATABASEpRoPERTYEX(KebueDB,IsBrokerEnabled) --等于0未开启执行下面两句开启让后重启电脑或服务才能生效ALTER DATABASE KebueDB SET NEW_BROKER WITH ROLLBACK IMMEDIATE;ALTER DATABASE KebueDB SET ENABLE_BROKER;网上也也有其他方法开启，可以参考以上方法经测试完美通关，还有不明白请给我留言，我进行补充'>MVC5 开启Sql Servier缓存依赖，只有数据库更改才需去抓取数据</a>&nbsp;&nbsp;&nbsp;&nbsp;<span>16-7-18 上午 12:00:00</span></li><li><span>13</span>&nbsp;&nbsp;<a class='btn btn-link' style='color: blue' href='../../../../../Artlcle/vip/B1ED155A-4814-436F-A34F-2993F02F1C62.html' title='　Cache类，是一个用于缓存常用信息的类。HttpRuntime.Cache以及HttpContext.Current.Cache都是该类的实例。一、属性属性说明Count获取存储在缓存中的项数。EffectivePercentagePhysicalMemoryLimit获取在 ASP.NET 开始从缓存中移除项之前应用程序可使用的物理内存百分比。EffectivePrivateBytesLimit获取可用于缓存的字节数。Item获取或设置指定键处的缓存项。二、方法方法名称说明Add将指定项添加到 Cache 对象，该对象具有依赖项、到期和优先级策略以及一个委托（可用于在从 Cache 移除插入项时通知应用程序）。Get从 Cache 对象检索指定项。GetEnumerator检索用于循环访问包含在缓存中的键设置及其值的字典枚举数。Insert(String, Object)向 Cache 对象插入项，该项带有一个缓存键引用其位置，并使用 CacheItemPriority 枚举提供的默认值。Insert(String, Object, CacheDependency)向 Cache 中插入具有文件依赖项或键依赖项的对象。Insert(String, Object, CacheDependency, DateTime, TimeSpan)向 Cache 中插入具有依赖项和到期策略的对象。Insert(String, Object, CacheDependency, DateTime, TimeSpan, CacheItemUpdateCallback)将对象与依赖项、到期策略以及可用于在从缓存中移除项之前通知应用程序的委托一起插入到 Cache 对象中。Insert(String, Object, CacheDependency, DateTime, TimeSpan, CacheItemPriority, CacheItemRemovedCallback)向 Cache 对象中插入对象，后者具有依赖项、到期和优先级策略以及一个委托（可用于在从 Cache 移除插入项时通知应用程序）。Remove从应用程序的 Cache 对象移除指定项。三、静态字段名称说明NoAbsoluteExpiration用于 Insert 方法调用中的 absoluteExpiration 参数中以指示项从不到期。 此字段为只读。NoSlidingExpiration用作 Insert 或 Add 方法调用中的 slidingExpiration 参数，以禁用可调到期。 此字段为只读。　　先来看基本的示例：　　index.aspx.cs页面代码:namespaceWebApplication1
{publicpartialclass_Default:System.Web.UI.Page
{protectedvoidPage_Load(objectsender,EventArgse)
{
Personp=newPerson();
p.Id=1;
p.Name=诸葛亮;

Cachecache=HttpRuntime.Cache;
cache.Insert(AA,p);
cache.Insert(BB,字符串);

Response.Write(cache.Get(BB).ToString());//输出字符串
Personp2=cache[AA]asPerson;
Response.Write(p2.Id+:+p2.Name);//输出1:诸葛亮
Response.Write(cache.EffectivePrivateBytesLimit);//-1这是一个只读属性，那就没什么好说了，只能输出来看看了，但是-1是什么意思呢？无限吗
Response.Write(cache.EffectivePercentagePhysicalMemoryLimit);//98开始移除项之前可以使用到98%

Response.Write(cache.Count);//输出3
Response.Write(cache[BB]);//输出字符串支持索引器式的读取
cache.Remove(BB);//从cache中移除一项
Response.Write(~~~+cache[BB]+~~~);//移除了输出null，但程序不报错

foreach(varobjincache)
{
Response.Write(obj.GetType()+br/);//输出不知道什么鸟东西}}
}publicclassPerson
{publicintId
{get;set;
}publicstringName
{get;set;
}
}
}四、文件缓存依赖　　当被依赖的文件更改时，缓存会立即被清空：　　index.aspx.cs代码：publicpartialclass_Default:System.Web.UI.Page
{protectedvoidPage_Load(objectsender,EventArgse)
{
Cachecache=HttpContext.Current.Cache;//文件缓存依赖
cache.Insert(CC,依赖项测试,newCacheDependency(@D:\123.txt));//这时候在about.aspx页面添加一行代码，当更改一下D:123.txt时，cache[cc]会立即被清空}
}　　about.aspx.cs代码：publicpartialclassAbout:System.Web.UI.Page
{protectedvoidPage_Load(objectsender,EventArgse)
{//直接打开本页面，输出缓存依赖项测试//当更改D:\123.txt之后，在刷新，输出空，表明该Cache是依赖于D:\123.txt的
Response.Write(HttpContext.Current.Cache[CC]);
}
}五、NoSlidingExpiration 绝对过期时间　　NoSlidingExpiration　　绝对过期时间，当超过设定时间，立即移除。　　下面来看下绝对过期时间的示例，index.aspx.cs:publicpartialclass_Default:System.Web.UI.Page
{protectedvoidPage_Load(objectsender,EventArgse)
{
Cachecache=HttpContext.Current.Cache;//30秒后就到期，立即移除，没商量
cache.Insert(DD,绝对过期测试,null,DateTime.Now.AddSeconds(5),System.Web.Caching.Cache.NoSlidingExpiration);
}
}　　about.aspx.cs:publicpartialclassAbout:System.Web.UI.Page
{protectedvoidPage_Load(objectsender,EventArgse)
{//先打开index.aspx添加到缓存然后立即打开本页面，输出绝对过期测试//持续刷新5秒后，不会再输出　　绝对过期测试
Response.Write(HttpContext.Current.Cache[DD]);
}
}六、NoAbsoluteExpiration滑动过期时间　　NoAbsoluteExpiration　　当超过设定时间没再使用时，才移除缓存　　滑动过期测试,index.aspx.cs:publicpartialclass_Default:System.Web.UI.Page
{protectedvoidPage_Load(objectsender,EventArgse)
{
Cachecache=HttpContext.Current.Cache;//弹性过期时间，当缓存没使用10秒就过期
cache.Insert(DD,滑动过期测试,null,System.Web.Caching.Cache.NoAbsoluteExpiration,TimeSpan.FromSeconds(10));
}
}　　about.aspx.cs:publicpartialclassAbout:System.Web.UI.Page
{protectedvoidPage_Load(objectsender,EventArgse)
{//直接打开本页面，输出弹性过期测试//如果一直不停地刷新，都会继续输出，但是当超过10秒后再刷新，不会再输出滑动缓存测试
Response.Write(HttpContext.Current.Cache[DD]);
}
}　　注意当设置绝对到期时间时，请使用 DateTime 结构。当设置弹性过期时间时，请使用 TimeSpan 结构。另外，如果您创建的弹性过期时间小于零或大于一年，则将引发 ArgumentOutOfRangeException 类。七、缓存的优先级设置　　CacheItemPriority枚举　　设置缓存的优先级publicpartialclass_Default:System.Web.UI.Page
{protectedvoidPage_Load(objectsender,EventArgse)
{
Cachecache=HttpContext.Current.Cache;//文件权重级别
cache.Add(MyData,缓存重要级别,null,Cache.NoAbsoluteExpiration,TimeSpan.FromSeconds(30),CacheItemPriority.High,null);
}
}　　该枚举一共有六级：　　　　//在服务器释放系统内存时，具有该优先级级别的缓存项最有可能被从缓存删除。
Low=1,//在服务器释放系统内存时，具有该优先级级别的缓存项比分配了System.Web.Caching.CacheItemPriority.Normal//优先级的项更有可能被从缓存删除。
BelowNormal=2,//在服务器释放系统内存时，具有该优先级级别的缓存项很有可能被从缓存删除，其被删除的可能性仅次于具有System.Web.Caching.CacheItemPriority.Low
Normal=3,//缓存项优先级的默认值为System.Web.Caching.CacheItemPriority.Normal。
Default=3,//在服务器释放系统内存时，具有该优先级级别的缓存项被删除的可能性比分配了System.Web.Caching.CacheItemPriority.Normal//优先级的项要小。
AboveNormal=4,//在服务器释放系统内存时，具有该优先级级别的缓存项最不可能被从缓存删除。
High=5,//在服务器释放系统内存时，具有该优先级级别的缓存项将不会被自动从缓存删除。但是，具有该优先级级别的项会根据项的绝对到期时间或可调整到期时间与其他项一起被移除
NotRemovable=6,优先级Low=1BelowNormal=2Normal=3Default=3AboveNormal=4High=5NotRemoveable=6八、当缓存被移除时，通知程序　　这时就要用到Add的最后一个参数，委托了：　　index.aspx.cs代码如下：publicpartialclass_Default:System.Web.UI.Page
{protectedvoidPage_Load(objectsender,EventArgse)
{
Cachecache=HttpRuntime.Cache;//文件权重级别
cache.Add(MyData,缓冲移除通知,null,DateTime.Now.AddSeconds(10),Cache.NoSlidingExpiration,CacheItemPriority.Low,Show);
}publicvoidShow(stringkey,objectvalue,CacheItemRemovedReasonreason)
{
Cachecache=HttpRuntime.Cache;
Cache.Insert(MyData,缓存被清空啦!缓存被清空啦!缓存被清空啦!缓存被清空啦!缓存被清空啦!缓存被清空啦!缓存被清空啦!);
}
}　　about.aspx.cs代码如下：publicpartialclassAbout:System.Web.UI.Page
{protectedvoidPage_Load(objectsender,EventArgse)
{
Response.Write(HttpRuntime.Cache[MyData]);
}
}　　此处实现的效果时：第一次打开index.aspx(让程序加入数据到缓存)，然后打开about.aspx显示出“缓存移除通知”，10秒后再刷新，显示“缓存被清空啦!缓存被清空啦!缓存被清空啦!缓存被清空啦!缓存被清空啦!缓存被清空啦!缓存被清空啦!”　　经测试，以上程序的Cache最好还是用HttpRuntime的，否则没有请求时HttpContext会报，“未将对象引用设置到对象的实例”。　　这就是被清空时会自动调用委托程序进行处理，你可以再次将数据添加进入缓存，或者记录到日志等等一系列操作。九、数据库依赖缓存　　1、配置的方式(sqlserver2000)SqlDependency第一个构造函数。　　首先一个WebForm的Web.Config中的配置文件修改如下：connectionStrings
addname=ApplicationServices
connectionString=Server=KISSDODOG-PC;Database=Nx;uid=sa;pwd=123;
providerName=System.Data.SqlClient/
/connectionStrings

system.webcompilationdebug=truetargetFramework=4.0/
caching
sqlCacheDependencyenabled=truepollTime=1000　　//此行配置的意思是，开启数据库缓存，轮询时间为1秒，这是为了能够快速看到更改效果
databases
addconnectionStringName=ApplicationServicesname=con/
/databases
/sqlCacheDependency
/caching
/system.web　　修改Global.asax.cs文件代码如下：Application_Start(connString=System.Web.Configuration.WebConfigurationManager.ConnectionStrings[　　Index.aspx.cs文件代码如下：protectedvoidPage_Load(objectsender,EventArgse)
{
SqlCacheDependencydependency=newSqlCacheDependency(con,Record);//新增或修改一条缓存记录
HttpRuntime.Cache.Insert(MyData,数据库缓存测试,dependency);
}　　About.aspx.cs文件代码如下：protectedvoidPage_Load(objectsender,EventArgse)
{
Response.Write(HttpRuntime.Cache[MyData]);
}　　次数实现的效果时，打开Index.aspx.cs文件将数据添加到缓存后，然后打开about.asox，页面输出数据库缓存测试，这时候更改一下数据库的Record表，再刷新about.aspx页面，上一次输出的内容没有了。System.Data.SqlClient.SqlDependency.Start(connString);
System.Data.SqlClient.SqlDependency.Stop(connString);　　这两行代码不一定要放在Global.asax.cs里面，在代码执行之前和执行之后就OK了。　　注意，在这个例子当中，数据库要开启Service Broker　　检测是否已经启用ServiceBrokerSelectDATABASEpRoPERTYEX(数据库名称,IsBrokerEnabled)--1表示已经启用0表示没有启用　　启用ServicceBrokerALTERDATABASENXSETENABLE_BROKER;如果启动时，一直显示正在执行查询，那么用一下这条语句ALTERDATABASENXSETNEW_BROKERWITHROLLBACKIMMEDIATE;ALTERDATABASENXSETENABLE_BROKER;　　2、编程的方式(sqlserver2008)，第二个构造函数SqlDependency(sqlcommand sqlcom)　　index.aspx.cs文件代码如下：protectedvoidPage_Load(objectsender,EventArgse)
{
SqlCacheDependencydependency;
SqlConnectionconn=newSqlConnection(@Server=KISSDODOG-PC;Database=Nx;uid=sa;pwd=123;);using(conn)
{stringsql=selectnamefromdbo.record;
SqlCommandcmd=newSqlCommand(sql,conn);
dependency=newSqlCacheDependency(cmd);
SqlDataAdapteradapter=newSqlDataAdapter(cmd);//这里要特别注意，你的cmd一定要执行过，或者说Execute过，真正从数据库里面取出过数据
DataSetds=newDataSet();
adapter.Fill(ds);　　//这里才是cmd真正执行的地方，注意真正执行要在绑定dependency之后
}
Response.Write(开始!);
Cache.Insert(MyData,数据库依赖测试,dependency);
Response.Write(完成!);
}　　about.aspx.cs代码文件如下：publicpartialclassAbout:System.Web.UI.Page
{protectedvoidPage_Load(objectsender,EventArgse)
{if(HttpRuntime.Cache[MyData]!=null)
{
Response.Write(HttpRuntime.Cache[MyData]);
}else
{
Response.Write(缓存已不存在!);
}
}
}　　实现的效果一样是，打开index.aspx文件，再打开about.aspx文件，页面输出缓存测试结果，当更改表record之后，再刷新about.aspx页面，缓存被清空。　　再来一个例子，上次又是页面啥的，这次用十几行代码说明，这个东东实现的要点：staticvoidMain(string[]args)
{
Cachecache=HttpRuntime.Cache;
System.Data.SqlClient.SqlDependency.Start(@Server=KISSDODOG-PC;Database=Nx;uid=sa;pwd=123;);//创建缓存依赖
SqlConnectionconn=newSqlConnection(@Server=KISSDODOG-PC;Database=Nx;uid=sa;pwd=123;);
SqlCommandcommand=newSqlCommand(selectId,namefromdbo.Record,conn);

SqlCacheDependencydependency=newSqlCacheDependency(command);//注意，创建的command与SqlCacheDependency绑定要在command执行之前
SqlDataAdapteradapter=newSqlDataAdapter(command);
DataSetds=newDataSet();
adapter.Fill(ds);//这里要特别注意，Fill才是真正执行
cache.Insert(DD,数据库依赖测试,dependency);
Console.WriteLine(cache[DD]);
Thread.Sleep(20000);//暂停20秒给你更改一下数据库
if(cache[DD]==null)
{
Console.WriteLine(数据库已经修改过了!);
}
Console.ReadKey();
System.Data.SqlClient.SqlDependency.Stop(@Server=KISSDODOG-PC;Database=Nx;uid=sa;pwd=123;);
}　　在途中，我会随便修改一下Record表，输出结果如下：　　　　再来一次数据库缓存依赖，回调函数的例子：publicclassProgram
{staticvoidMain(string[]args)
{
Cachecache=HttpRuntime.Cache;
System.Data.SqlClient.SqlDependency.Start(@Server=KISSDODOG-PC;Database=Nx;uid=sa;pwd=123;);//创建缓存依赖
SqlConnectionconn=newSqlConnection(@Server=KISSDODOG-PC;Database=Nx;uid=sa;pwd=123;);
SqlCommandcommand=newSqlCommand(selectId,namefromdbo.Record,conn);

SqlCacheDependencydependency=newSqlCacheDependency(command);//注意，创建的command与SqlCacheDependency绑定要在command执行之前
SqlDataAdapteradapter=newSqlDataAdapter(command);
DataSetds=newDataSet();
adapter.Fill(ds);//这里要特别注意，Fill才是真正执行

CacheItemRemovedCallbackcallback=newCacheItemRemovedCallback(RemovedCallback);
cache.Insert(DD,数据库依赖测试,dependency,DateTime.Now.AddDays(1),TimeSpan.Zero,CacheItemPriority.Default,callback);
Console.WriteLine(cache[DD]);
Thread.Sleep(15000);//暂停15秒给你更改一下数据库
if(cache[DD]==null)
{
Console.WriteLine(数据库已经修改过了!);
}
Console.ReadKey();
System.Data.SqlClient.SqlDependency.Stop(@Server=KISSDODOG-PC;Database=Nx;uid=sa;pwd=123;);
}publicstaticvoidRemovedCallback(stringkey,objectvalue,CacheItemRemovedReasonreason)
{
Console.WriteLine(缓存被移除!);
Console.WriteLine(reason.ToString());
}
}　　输出结果如下：　　　　这里要补充几点：当设置为绝对过期时，后面那个TimeSpan参数要设为TimeSpan.Zero。另外，重载中还有一个方法之前在缓存移除前执行回调函数的，而刚刚那个是缓存数据被移除之后执行的。　　CacheItemUpdateCallback　　缓存数据移除之前调用；　 CacheItemRemoceCallback　　缓存数据移除之后调用；　　再来写一个：publicclassProgram
{staticvoidMain(string[]args)
{
Cachecache=HttpRuntime.Cache;
System.Data.SqlClient.SqlDependency.Start(@Server=KISSDODOG-PC;Database=Nx;uid=sa;pwd=123;);//创建缓存依赖
SqlConnectionconn=newSqlConnection(@Server=KISSDODOG-PC;Database=Nx;uid=sa;pwd=123;);
SqlCommandcommand=newSqlCommand(selectId,namefromdbo.Record,conn);

SqlCacheDependencydependency=newSqlCacheDependency(command);//注意，创建的command与SqlCacheDependency绑定要在command执行之前
SqlDataAdapteradapter=newSqlDataAdapter(command);
DataSetds=newDataSet();
adapter.Fill(ds);//这里要特别注意，Fill才是真正执行

CacheItemUpdateCallbackcallback=newCacheItemUpdateCallback(RemovedCallback);
cache.Insert(DD,数据库依赖测试,dependency,DateTime.Now.AddDays(1),TimeSpan.Zero,callback);
Console.WriteLine(cache[DD]);
Thread.Sleep(15000);//暂停15秒给你更改一下数据库
if(cache[DD]==null)
{
Console.WriteLine(数据库已经修改过了!);
}
Console.ReadKey();
System.Data.SqlClient.SqlDependency.Stop(@Server=KISSDODOG-PC;Database=Nx;uid=sa;pwd=123;);
}publicstaticvoidRemovedCallback(stringkey,CacheItemUpdateReasonreason,outobjectexpensiveObject,outCacheDependencydependency,outDateTimeabsoluteExpiration,outTimeSpanslidingExpiration)
{//key:要从缓存中移除的项的标识符。//reason:要从缓存中移除项的原因。//expensiveObject:此方法返回时，包含含有更新的缓存项对象。//dependency:此方法返回时，包含定义项对象和文件、缓存键、文件或缓存键的数组或另一个System.Web.Caching.CacheDependency对象之间的依赖项的对象。//absoluteExpiration:此方法返回时，包含对象的到期时间。//slidingExpiration:此方法返回时，包含对象的上次访问时间和对象的到期时间之间的时间间隔。
expensiveObject=null;
dependency=null;
absoluteExpiration=DateTime.Now;
slidingExpiration=TimeSpan.Zero;
Console.WriteLine(缓存马上被移除!);//但是现在还有没有呢？输出试试
Console.WriteLine(HttpRuntime.Cache[DD]);
Console.WriteLine(reason.ToString());
}
}　　输出结果为：　　　　看到，在Update这个委托执行时，缓存还是存在的。　　注意:那个SQL语句还是比较严格的，主要要符合以下要求   a).必须设置完全限定名称的数据表。即表名前面需要加所有者，如dbo.test。   b).必须明确设置所访问数据库列名称，不能使用“*”。   c).必须保证不是聚合函数。如COUNT、MAX等。SQL SERVER 7.0/2000SQL SERVER 2005实现机制轮询通知传递服务(Service Broker)是否需要配置启用需要不需要，内置支持数据更改检测限于表级更改监测表级、行级更改监测　　　很明显，SQL SERVER 2005的缓存机制更加高效。另外，SqlCacheDependency类还特别结合SQL SERVER 2005 进行了优化:    a).使用SQL SERVER 2005 时，SqlCacheDependency类支持与System.Data.SqlClient.SqlDependency类进行集成。应用程序可创建SqlDependency对象，并通过OnChanged事件处理程序接受通知进行注册。这样，应用程序不仅可以使用Sql server 2005的查询通知机制来监测使用SQL查询结果无效的数据更改，并将缓存对象从缓存中移除，而且还可以轻松获取数据更改通知，以便刷新缓存。(从这里可以看出，当触发onRemoveCallback委托的时候，数据已经从缓存里面删除了，这样一来可以手动在委托里面添加缓存，或者干脆设置成null，让他下次调用的时候再缓存。)    b).不仅向应用程序添加缓存依赖项，还可以与@OutputCache指令一起使用，以生成依赖于SqlServer数据库表的输出缓存的页面或用户控件。对于用户控件，@OutputCache指令不支持使用SQL SERVER 2005的查询通知(即onRemoveCallback委托)。十、组合依赖缓存　　当依赖的内容为多个Dependency时，可以通过AggregateCacheDependency创建依赖的组合，以便在任何一个依赖项发生变化时，使缓存项失效。　　组合的缓存依赖内部为一个集合，可以保存多个缓存依赖对象，将这些缓存依赖对象作为一个整体应用在缓存项目上，当其中某一个缓存依赖失效的时候，就可以使缓存的数据被丢弃。　　组合依赖缓存示例：//创建缓存依赖System.Web.Caching.SqlCacheDependencyproduct=newSystem.Web.Caching.SqlCacheDependency(northwindcache,products);
System.Web.Caching.SqlCacheDependencycategory=newSystem.Web.Caching.SqlCacheDependency(northwindcache,products)//多个缓存依赖组合成一个依赖对象使用System.Web.Caching.AggregateCacheDependencyacd=newSystem.Web.Caching.AggregateCacheDependency();
acd.Add(product,category);十一、System.Web.Caching.Cache Insert和Add方法的区别　　Add方法objectAdd(stringkey,objectvalue,CacheDependencydependencies,DateTimeabsoluteExpiration,TimeSpanslidingExpiration,CacheItemPrioritypriority,CacheItemRemovedCallbackonRemoveCallback);　　Insert方法voidInsert(stringkey,objectvalue);//永不过期voidInsert(stringkey,objectvalue,CacheDependencydependencies);　　//依赖voidInsert(stringkey,objectvalue,CacheDependencydependencies,DateTimeabsoluteExpiration,TimeSpanslidingExpiration);//绝对时间过期：voidInsert(stringkey,objectvalue,CacheDependencydependencies,DateTimeabsoluteExpiration,TimeSpanslidingExpiration,CacheItemUpdateCallbackonUpdateCallback);　　//依赖+回调voidInsert(stringkey,objectvalue,CacheDependencydependencies,DateTimeabsoluteExpiration,TimeSpanslidingExpiration,CacheItemPrioritypriority,CacheItemRemovedCallbackonRemoveCallback);　　//依赖+优先级+回调　　比较、区别　　　　a). Insert方法支持5种重载，使用灵活，而Add方法必须提供7个参数；　　　　b). Add方法可以返回缓存项的数据对象，Insert 返回Void；　　　　c).添加重复缓存情况下(Key已存在)，Insert会替换该项，而Add方法则不执行任何操作，并返回原来保存的object对象(Update 2014-03-18)。　　过期策略　　　　a). 永不过期　　　　　　Insert(string key, object value);　　　　b). 绝对时间过期　　　　　　DateTime.Now.AddSeconds(10)表示缓存在10秒后过期，TimeSpan.Zero表示不使用平滑过期策略。　　　　　　例：Cache.Insert(Data, ds,null, DateTime.Now.AddSeconds(10), TimeSpan.Zero);　　　　c). 变化时间过期（平滑过期）　　　　　　DateTime.MaxValue表示不使用绝对时间过期策略，TimeSpan.FromSeconds(10)表示缓存连续10秒没有访问就过期。　　　　　　例：Cache.Insert(Data, ds, null, DateTime.MaxValue, TimeSpan.FromSeconds(10));十二、清空缓存　　清空缓存主要通过Remove()方法，但是只能通过传入一个Key，清空一个。　　GetEnumerator()方法用于获取所有缓存项。MoveNext()用于将位置移动到下一个缓存项。　　如果想清空所有缓存，由于Cache类没有提供RemoveAll()方法，所以可以通过以下方式实现：IDictionaryEnumeratorDicCache=HttpRuntime.Cache.GetEnumerator();intcount=HttpRuntime.Cache.Count;for(inti=0;icount;i++)
{
DicCache.MoveNext();HttpRuntime.Cache.Remove(DicCache.Entry.Key.ToString());
}十三、缓存依赖总结　　缓存依赖主要有如下技术点　　Dependency依赖：.Net中支持两种依赖：CacheDependency和SqlDependency(两者都是Dependency的子类)。从.Net2.0开始，CacheDependency不再是密封的，而是可以继承的。　　   ┠CacheDependency：表示对文件或者目录的依赖　　   ┠SqlDependency：表示基于SQL数据库的依赖　　过期时间：过期时间分绝对过期时间和滑动过期时间两种。　　  ┠绝对过期时间：为特定时间点，类型为DateTime，如果不使用绝对过期时间，那么，使用System.Web.Caching.Cache.NoAbsoluteExpiration表示。　　  ┠滑动过期时间：为一个事件间隔，类型为TimeSpan，如果不使用滑动过期时间，使用System.Web.Cacheing.NoSlidingExpiration表示。　　删除通知：.Net提供了一个机制，当被缓存的数据从内存中移除的时候，可以提供一个通知机制，来回调用户定义的方法，方法必须符合CacheItemRemoveCallback委托的定义。该委托定义如下：publicdelegatevoidCacheItemRemoveCallback(stringkey,Objectvalue,CacheItemRemovedReasonreason)　　其中，CacheItemRemoveReason为缓存项被移除的原因。CacheItemRemovedReason是一个枚举类型，定义了如下原因：DependencyChange：由于依赖发生变化被移除；Expired：由于过期被移除；Removed：由于调用Insert插入一个同名的缓存项或者调用Remove失效被移除；Underused：系统移除；注意：回调的时机是不可预知的，不能假定回调发生时，回调方法的执行线程存在HttpContext的上下文，为了在没有请求上下文的时候取得对Cache对象的引用，可以通过HttpRuntime的Cache属性来使用应用程序的Cache。不能在页面上使用实例方法来作为回调方法，当在页面上使用回调方法时，由于指向回调方法的引用会阻止垃圾回收机制，因此会造成内存很快耗光。一般通过在自定义类的静态方法实现回调方法，或者使用页面对象的静态方法的实现。PS:　　　　1、 CacheDependency是AggregateCacheDependency和SqlCacheDependency的父类。主要用于在应用程序数据缓存对象与文件、缓存键、文件或缓存键的数组或另外一个CacheDependency对象之间建立依赖关系。CacheDependency监视依赖关系比便在任何对象更改时自动移除缓存对象。CacheDependency可以监测一组(到文件或目录的)文件路径的更改情况。　　2、 AggregateCacheDependency主要用于实现聚合缓存依赖。如一笔数据同时对两个表进行缓存依赖，一旦其中任何一个表数据更改缓存将失效。　　3、 SqlCacheDependency将应用程序数据缓存对象、页面输出缓存、数据源控件等与指定SQL Server数据库表或Sql Server 2005 查询结果之间建立缓存依赖关系，在表发生更改(Sql Server 2005 行级别更改)时，自动从缓存中删除和重新添加与该表关联的缓存对象。一般而言：SqlCacheDependency (SqlCommand) 用于SQL SERVER 2005SqlCacheDependency (数据库名, 表名) 用于SQL SERVER 7.0/2000　　有以下几条缓存数据的规则。:　　第一，数据可能会被频繁的被使用，这种数据可以缓存。　　第二，数据的访问频率非常高，或者一个数据的访问频率不高，但是它的生存周期很长(很少变动)，这样的数据最好也缓存起来。　　第三，是一个常常被忽略的问题，有时候我们缓存了太多数据，通常在一台X86的机子上，如果你要缓存的数据超过800M的话，就会出现内存溢出的错误。所以说缓存是有限的。换名话说，你应该估计缓存集的大小，把缓存集的大小限制在10以内，否则它可能会出问题。在Asp.net中，如果缓存过大的话也会报内存溢出错误，特别是如果缓存大的DataSet对象的时候。　　你应该认真分析你的程序。根据实际情况来看哪里该用，哪里不该用。如：Cache用得过多也会增大服务器的压力。整页输出缓存，又会影响数据的更新。 如果真的需要缓存很大量的数据，可以考虑静态技术。　　CacheDependency还支持【嵌套】，即：CacheDependency的构造函数中支持传入其它的CacheDependency实例，这样可以构成一种非常复杂的树状依赖关系。'>System.Web.Caching.Cache类 缓存 各种缓存依赖</a>&nbsp;&nbsp;&nbsp;&nbsp;<span>16-7-16 上午 12:00:00</span></li><li><span>14</span>&nbsp;&nbsp;<a class='btn btn-link' style='color: blue' href='../../../../../Artlcle/vip/F356A2DA-EDE7-456A-B3D0-CA2F5164A930.html' title='#region 防止sql注入式攻击(可用于UI层控制）/// /// 判断字符串中是否有SQL攻击代码/// /// 传入用户提交数据/// true-安全；false-有注入攻击现有；public bool ProcessSqlStr(string inputString){string SqlStr = @and|or|exec|execute|insert|select|delete|update|alter|create|drop|count|\*|chr|char|asc|mid|substring|master|truncate|declare|xp_cmdshell|restore|backup|net +user|net +localgroup +administrators;try{if ((inputString != null)  (inputString != String.Empty)){string str_Regex = @\b( + SqlStr + @)\b;Regex Regex = new Regex(str_Regex, RegexOptions.IgnoreCase);//string s = Regex.Match(inputString).Value; if (true == Regex.IsMatch(inputString))return false;}}catch{return false;}return true;}/// /// 处理用户提交的请求，校验sql注入式攻击,在页面装置时候运行/// System.Configuration.ConfigurationSettings.AppSettings[ErrorPage].ToString(); 为用户自定义错误页面提示地址,/// 在Web.Config文件时里面添加一个 ErrorPage 即可/// /// /// public void ProcessRequest(){try{string getkeys = ;string sqlErrorPage = System.Configuration.ConfigurationSettings.AppSettings[ErrorPage].ToString();if (System.Web.HttpContext.Current.Request.QueryString != null){for (int i = 0; i  System.Web.HttpContext.Current.Request.QueryString.Count; i++){getkeys = System.Web.HttpContext.Current.Request.QueryString.Keys[i];if (!ProcessSqlStr(System.Web.HttpContext.Current.Request.QueryString[getkeys])){System.Web.HttpContext.Current.Response.Redirect(sqlErrorPage + ?errmsg= + getkeys + 有SQL攻击嫌疑！);System.Web.HttpContext.Current.Response.End();}}}if (System.Web.HttpContext.Current.Request.Form != null){for (int i = 0; i  System.Web.HttpContext.Current.Request.Form.Count; i++){getkeys = System.Web.HttpContext.Current.Request.Form.Keys[i];if (!ProcessSqlStr(System.Web.HttpContext.Current.Request.Form[getkeys])){System.Web.HttpContext.Current.Response.Redirect(sqlErrorPage + ?errmsg= + getkeys + 有SQL攻击嫌疑！);System.Web.HttpContext.Current.Response.End();}}}}catch{// 错误处理: 处理用户提交信息!}}#endregion#region 转换sql代码（也防止sql注入式攻击，可以用于业务逻辑层，但要求UI层输入数据时候进行解码）/// /// 提取字符固定长度/// /// /// /// public string CheckStringLength(string inputString, Int32 maxLength){if ((inputString != null)  (inputString != String.Empty)){inputString = inputString.Trim();if (inputString.Length  maxLength)inputString = inputString.Substring(0, maxLength);}return inputString;}/// /// 将输入字符串中的sql敏感字，替换成[敏感字]，要求输出时，替换回来/// /// /// public string MyEncodeInputString(string inputString){//要替换的敏感字string SqlStr = @and|or|exec|execute|insert|select|delete|update|alter|create|drop|count|\*|chr|char|asc|mid|substring|master|truncate|declare|xp_cmdshell|restore|backup|net +user|net +localgroup +administrators;try{if ((inputString != null)  (inputString != String.Empty)){string str_Regex = @\b( + SqlStr + @)\b;Regex Regex = new Regex(str_Regex, RegexOptions.IgnoreCase);//string s = Regex.Match(inputString).Value; MatchCollection matches = Regex.Matches(inputString);for (int i = 0; i  matches.Count; i++)inputString = inputString.Replace(matches[i].Value, [ + matches[i].Value + ]);}}catch{return ;}return inputString;}/// /// 将已经替换成的[敏感字]，转换回来为敏感字/// /// /// public string MyDecodeOutputString(string outputstring){//要替换的敏感字string SqlStr = @and|or|exec|execute|insert|select|delete|update|alter|create|drop|count|\*|chr|char|asc|mid|substring|master|truncate|declare|xp_cmdshell|restore|backup|net +user|net +localgroup +administrators;try{if ((outputstring != null)  (outputstring != String.Empty)){string str_Regex = @\[\b( + SqlStr + @)\b\];Regex Regex = new Regex(str_Regex, RegexOptions.IgnoreCase);MatchCollection matches = Regex.Matches(outputstring);for (int i = 0; i  matches.Count; i++)outputstring = outputstring.Replace(matches[i].Value, matches[i].Value.Substring(1, matches[i].Value.Length - 2));}}catch{return ;}return outputstring;}#endregion'>sql注入之关键字过滤</a>&nbsp;&nbsp;&nbsp;&nbsp;<span>16-7-9 上午 12:00:00</span></li><li><span>15</span>&nbsp;&nbsp;<a class='btn btn-link' style='color: blue' href='../../../../../Artlcle/vip/9DF1CB6C-A4EF-4282-B5E1-4BD8BA7B3D6B.html' title='using System;using System.Web;using System.Web.Mvc;namespace MVCFilter{  [AttributeUsage(AttributeTargets.All, AllowMultiple = true)]//多次调用  public class CustomerFilterAttribute : ActionFilterAttribute  {    public string Message { get; set; }    /// summary    /// 执行顺序  1    /// /summary    /// param name=filterContext/param    private void CheckMessage(ActionExecutingContext filterContext)    {      if (string.IsNullOrEmpty(Message) || string.IsNullOrWhiteSpace(Message))        Message = Controller： + filterContext.Controller.GetType().Name + \rAction： + filterContext.ActionDescriptor.ActionName;    }    /// summary    /// 执行顺序  2    /// 该方法在Action之前执行    /// /summary    /// param name=filterContext/param    public override void OnActionExecuting(ActionExecutingContext filterContext)    {      HttpSessionStateBase session = filterContext.HttpContext.Session;  //取到Session      //get the controller and result name and field value      string controllName = filterContext.ActionDescriptor.ControllerDescriptor.ControllerName;  //取到当前访问的Controller和Result的名称      string actionName = filterContext.ActionDescriptor.ActionName;      session[controllName] = controllName;      session[actionName] = actionName;      string fileName = filterContext.RouteData.Values[id] == null ?  : filterContext.RouteData.Values[id].ToString();      //可以取到URL中的传递参数的值      HttpRequestBase request = filterContext.HttpContext.Request;      string fileNameString = request.QueryString[id];      //判断是否登录，以及判断后的跳转      string user = (string)session[user];      if (null == user)      {        filterContext.Result = new RedirectResult(/File/ListFiles); //没有登录的话跳转到指定页面      }      else if (!admin.Equals(user))      {        filterContext.Result = new RedirectResult(/File/FieldTest2);      }    }    /// summary    /// 执行顺序  3    /// 该方法在Action?笾葱?/p>    /// /summary    /// param name=filterContext/param    public override void OnActionExecuted(ActionExecutedContext filterContext)    {      base.OnActionExecuted(filterContext);      filterContext.HttpContext.Response.Write(string.Format(br/ {0} Action finish Execute....., Message));    }    /// summary    /// 执行顺序  4    /// /summary    /// param name=filterContext/param    public override void OnResultExecuting(ResultExecutingContext filterContext)    {      filterContext.HttpContext.Response.Write(string.Format(br/ {0} Action start Execute....., Message));      base.OnResultExecuting(filterContext);    }    /// summary    /// 执行顺序  5    /// /summary    /// param name=filterContext/param    public override void OnResultExecuted(ResultExecutedContext filterContext)    {      filterContext.HttpContext.Response.Write(string.Format(br/ {0} Action finish Result....., Message));      base.OnResultExecuted(filterContext);    }  }}'>MVC自定义ActionFilterAttribute  Filter</a>&nbsp;&nbsp;&nbsp;&nbsp;<span>16-6-15 上午 12:00:00</span></li><li><span>16</span>&nbsp;&nbsp;<a class='btn btn-link' style='color: blue' href='../../../../../Artlcle/vip/B55A39A4-2C52-4CDA-8F03-0029BF9F0642.html' title='下面是源码，复制就可运行：!DOCTYPE htmlhtml ng-app=todoListhead  meta name=viewport content=width=device-width /  link href=//cdn.bootcss.com/bootstrap/4.0.0-alpha.2/css/bootstrap.css rel=stylesheet  script src=https://code.angularjs.org/1.5.6/angular.js/script  titleAngularjs/title/headbody ng-controller=TaskCtrldiv class=container  div class=row    div class=col-lg-3    fieldset      legendDemo One/legend      div class=input-group        input ng-model=task type=text class=form-control /        span class=input-group-btn          button class=btn btn-info ng-click=add()ADD/button        /span      /div      h4 ng-if=tasks.length0任务列表/h4      ul class=list-group        li ng-repeat=item in tasks track by $index class=list-group-item          {{item}}nbsp;nbsp;nbsp;nbsp;nbsp;nbsp;nbsp;nbsp;nbsp;nbsp;          button class=btn btn-primary ng-click=tasks.splice($index,1)Delete/button        /li      /ul    /fieldset    /div    div class=col-lg-9      hello hello class=hello/hello    /div  /div/div /body/htmlscript type=text/javascript    angular.module(todoList, [])   .controller(TaskCtrl, function ($scope) {     $scope.task = ;     $scope.tasks = [];     $scope.add = function () {       if ($scope.task.length0)       $scope.tasks.push($scope.task);     }   }).directive(hello, function () {     return {       restrict: E,//E是标签 A       replace:false,//true是替换掉定义标签       template:  fieldsetlegendDemo Two/legenddiv class=input-grouplabelUnit/labelnbsp;input type=number ng-model=cost /nbsp;labelUS Dollar/labelnbsp;input type=number ng-model=qty /nbsp;bToltal:nbsp;nbsp;/b{{cost*qty|currency}}/div/fieldset      }   }).directive(hello, function () {     return {       restrict: A,       link: function () {         alert(我是属性);       }     }   }).directive(hello, function () {     return {       restrict: C,       link: function () {         alert(我是类(Class));       }     }   })/script'>AngularJS</a>&nbsp;&nbsp;&nbsp;&nbsp;<span>16-6-9 上午 12:00:00</span></li><li><span>17</span>&nbsp;&nbsp;<a class='btn btn-link' style='color: blue' href='../../../../../Artlcle/vip/5A4CCA85-F495-4033-8DF8-FCE95A29427A.html' title='使用硬盘序列号作为唯一识别码,能识别多块硬盘,如U盘等.需要添加引用:System.Management;usingSystem.Management; public static string GetHardDiskID()    {      ManagementObjectSearcher mos = new ManagementObjectSearcher(SELECT * FROM Win32_PhysicalMedia);      string strHardDiskID = null;      //string strHardDisk = null;      foreach (ManagementObject mo in mos.Get())      {        if (mo[Tag].ToString() == @\\.\PHYSICALDRIVE0)        { //只获取 第一块硬盘序列号          strHardDiskID = mo[SerialNumber].ToString().Trim();          break;        }        //strHardDisk = mo[Tag].ToString();      }      return strHardDiskID;    }'>获取硬盘的序列号</a>&nbsp;&nbsp;&nbsp;&nbsp;<span>16-5-24 上午 12:00:00</span></li><li><span>18</span>&nbsp;&nbsp;<a class='btn btn-link' style='color: blue' href='../../../../../Artlcle/vip/DC7FB6BE-8092-40EB-9E94-9108A65F3379.html' title='今天遇到一个很奇葩的需求,是这样的:当我点击文字的时候弹出一个删除按钮,可以删除刚才点击的文字.诶?当时想了想,没什么难度吧.可是,既然是奇葩的需求怎么可能这么简单.对,还有一个功能.我并不知道我点了哪个标签,可以承载文字的标签太多太多....当时我tm就懵逼了.你都不知道要点哪个标签,我怎么去绑定事件?给谁绑定事件? 扯了半天,还是要写.于是就动工了.我思路是这样的:START1,首先得获取鼠标点击的对象.(问题是...我怎么知道点了哪个)那么先写个函数去获取鼠标点击的对象吧get_tag这个函数被绑定在body的onclick事件上,然后接受了一个event参数;然后event对象有个target属性,是可以直接获取鼠标点击的对象.我们log看看恩,可以的.和预先的思路一致.得到了想要的结果.2,得到对象.可是要怎么删除呢?1vardel_tag=function(){2vartag=null;3return{4get:function(e){5tag=e;6},7del:function(){8$(tag).remove();9}10}11}由于删除按钮和我们鼠标所点击的对象并没有什么联系.所以我们得写个闭包,声明一个tag去保存我们所点击的对象.然后返回两个函数,一个get.用来获取鼠标上次点击的对象.一个是del.顾名思义,删除点击的对象.由于是闭包,所以tag会被保存到内存中.正好实现所要的功能.3.二者结合1vardel_tag=function(){2vartag=null;3return{4get:function(e){5tag=e;6},7del:function(){8$(tag).remove();9}10}11}1213vardt=del_tag();//把del_tag赋值给dt141516functionget_tag(e){17varele=e.target;18//调用dt.get()参数就是get_tag函数event参数的值的target19dt.get($(ele));20}2122$(#del).click(function(){  23//这里,由于创建了闭包.我们上次点击的对象被保存了起来.24//所以这里可以直接调用dt.del()删除对象25dt.del();26})4.看看效果5.效果还不错.可是..随便点击某个对象都可以删除.这是不是就乱套了?接着改1vardel_tag=function(){2vartag=null;3return{4get:function(e){5tag=e;6},7del:function(){8$(tag).remove();9}10}11}1213vardt=del_tag();//把del_tag赋值给dt141516functionget_tag(e){1718varele=e.target;19$(ele).css(border,1pxsolidred)20vartagname=ele.tagName;21//定义一个tag数组.用来存储我们想删除的对象22vartagarr=[SPAN,H1,H2,H3,H4,H5,H6,P];23//判断如果我们点击的对象是不是我们数组里所声明的,可以删除的.24if(tagarr.indexOf(tagname)-1){  25//调用dt.get()参数就是get_tag函数event参数的值的target26dt.get($(ele));27}  2829}3031$(#del).click(function(){  3233//这里,由于创建了闭包.我们上次点击的对象被保存了起来.34//所以这里可以直接调用dt.del()删除对象35dt.del();36})看看效果:恩恩.看来对了.不是我们所定义的对象就不可以删除.虽然和需求上说的删除文字有点区别.但是只要你告诉我你会用那些标签去承载文字.我就可以删除...强调一下.我们的get_tag()函数可别放在body或者html的onclick事件上.不然整个页面的文字一点就删除了....get_tag()函数就绑定在你想删除文字那块div上.END'>js获取鼠标点击的对象,点击另一个按钮删除该对象</a>&nbsp;&nbsp;&nbsp;&nbsp;<span>16-5-13 上午 12:00:00</span></li><li><span>19</span>&nbsp;&nbsp;<a class='btn btn-link' style='color: blue' href='../../../../../Artlcle/vip/D97762A2-1E54-434F-82C4-2DEAC1A55F32.html' title='.glyphicon - zoom - in.glyphicon - zoom - out.glyphicon - off.glyphicon - signal.glyphicon - cog: before {  content: \e019;}.glyphicon - trash: before {  content: \e020;}.glyphicon - home: before {  content: \e021;}.glyphicon - file: before {  content: \e022;}.glyphicon - time: before {  content: \e023;}.glyphicon - road: before {  content: \e024;}.glyphicon - download - alt: before {  content: \e025;}.glyphicon - download: before {  content: \e026;}.glyphicon - upload: before {  content: \e027;}.glyphicon - inbox: before {  content: \e028;}.glyphicon - play - circle: before {  content: \e029;}.glyphicon - repeat: before {  content: \e030;}.glyphicon - refresh: before {  content: \e031;}.glyphicon - list - alt: before {  content: \e032;}.glyphicon - flag: before {  content: \e034;}.glyphicon - headphones: before {  content: \e035;}.glyphicon - volume - off: before {  content: \e036;}.glyphicon - volume - down: before {  content: \e037;}.glyphicon - volume - up: before {  content: \e038;}.glyphicon - qrcode: before {  content: \e039;}.glyphicon - barcode: before {  content: \e040;}.glyphicon - tag: before {  content: \e041;}.glyphicon - tags: before {  content: \e042;}.glyphicon - book: before {  content: \e043;}.glyphicon - print: before {  content: \e045;}.glyphicon - font: before {  content: \e047;}.glyphicon - bold: before {  content: \e048;}.glyphicon - italic: before {  content: \e049;}.glyphicon - text - height: before {  content: \e050;}.glyphicon - text - width: before {  content: \e051;}.glyphicon - align - left: before {  content: \e052;}.glyphicon - align - center: before {  content: \e053;}.glyphicon - align - right: before {  content: \e054;}.glyphicon - align - justify: before {  content: \e055;}.glyphicon - list: before {  content: \e056;}.glyphicon - indent - left: before {  content: \e057;}.glyphicon - indent - right: before {  content: \e058;}.glyphicon - facetime - video: before {  content: \e059;}.glyphicon - picture: before {  content: \e060;}.glyphicon - map - marker: before {  content: \e062;}.glyphicon - adjust: before {  content: \e063;}.glyphicon - tint: before {  content: \e064;}.glyphicon - edit: before {  content: \e065;}.glyphicon - share: before {  content: \e066;}.glyphicon - check: before {  content: \e067;}.glyphicon - move: before {  content: \e068;}.glyphicon - step - backward: before {  content: \e069;}.glyphicon - fast - backward: before {  content: \e070;}.glyphicon - backward: before {  content: \e071;}.glyphicon - play: before {  content: \e072;}.glyphicon - pause: before {  content: \e073;}.glyphicon - stop: before {  content: \e074;}.glyphicon - forward: before {  content: \e075;}.glyphicon - fast - forward: before {  content: \e076;}.glyphicon - step - forward: before {  content: \e077;}.glyphicon - eject: before {  content: \e078;}.glyphicon - chevron - left: before {  content: \e079;}.glyphicon - chevron - right: before {  content: \e080;}.glyphicon - plus - sign: before {  content: \e081;}.glyphicon - minus - sign: before {  content: \e082;}.glyphicon - remove - sign: before {  content: \e083;}.glyphicon - ok - sign: before {  content: \e084;}.glyphicon - question - sign: before {  content: \e085;}.glyphicon - info - sign: before {  content: \e086;}.glyphicon - screenshot: before {  content: \e087;}.glyphicon - remove - circle: before {  content: \e088;}.glyphicon - ok - circle: before {  content: \e089;}.glyphicon - ban - circle: before {  content: \e090;}.glyphicon - arrow - left: before {  content: \e091;}.glyphicon - arrow - right: before {  content: \e092;}.glyphicon - arrow - up: before {  content: \e093;}.glyphicon - arrow - down: before {  content: \e094;}.glyphicon - share - alt: before {  content: \e095;}.glyphicon - resize - full: before {  content: \e096;}.glyphicon - resize - small: before {  content: \e097;}.glyphicon - exclamation - sign: before {  content: \e101;}.glyphicon - gift: before {  content: \e102;}.glyphicon - leaf: before {  content: \e103;}.glyphicon - eye - open: before {  content: \e105;}.glyphicon - eye - close: before {  content: \e106;}.glyphicon - warning - sign: before {  content: \e107;}.glyphicon - plane: before {  content: \e108;}.glyphicon - random: before {  content: \e110;}.glyphicon - comment: before {  content: \e111;}.glyphicon - magnet: before {  content: \e112;}.glyphicon - chevron - up: before {  content: \e113;}.glyphicon - chevron - down: before {  content: \e114;}.glyphicon - retweet: before {  content: \e115;}.glyphicon - shopping - cart: before {  content: \e116;}.glyphicon - folder - close: before {  content: \e117;}.glyphicon - folder - open: before {  content: \e118;}.glyphicon - resize - vertical: before {  content: \e119;}.glyphicon - resize - horizontal: before {  content: \e120;}.glyphicon - hdd: before {  content: \e121;}.glyphicon - bullhorn: before {  content: \e122;}.glyphicon - certificate: before {  content: \e124;}.glyphicon - thumbs - up: before {  content: \e125;}.glyphicon - thumbs - down: before {  content: \e126;}.glyphicon - hand - right: before {  content: \e127;}.glyphicon - hand - left: before {  content: \e128;}.glyphicon - hand - up: before {  content: \e129;}.glyphicon - hand - down: before {  content: \e130;}.glyphicon - circle - arrow - right: before {  content: \e131;}.glyphicon - circle - arrow - left: before {  content: \e132;}.glyphicon - circle - arrow - up: before {  content: \e133;}.glyphicon - circle - arrow - down: before {  content: \e134;}.glyphicon - globe: before {  content: \e135;}.glyphicon - tasks: before {  content: \e137;}.glyphicon - filter: before {  content: \e138;}.glyphicon - fullscreen: before {  content: \e140;}.glyphicon - dashboard: before {  content: \e141;}.glyphicon - heart - empty: before {  content: \e143;}.glyphicon - link: before {  content: \e144;}.glyphicon - phone: before {  content: \e145;}.glyphicon - usd: before {  content: \e148;}.glyphicon - gbp: before {  content: \e149;}.glyphicon - sort: before {  content: \e150;}.glyphicon - sort - by - alphabet: before {  content: \e151;}.glyphicon - sort - by - alphabet - alt: before {  content: \e152;}.glyphicon - sort - by - order: before {  content: \e153;}.glyphicon - sort - by - order - alt: before {  content: \e154;}.glyphicon - sort - by - attributes: before {  content: \e155;}.glyphicon - sort - by - attributes - alt: before {  content: \e156;}.glyphicon - unchecked: before {  content: \e157;}.glyphicon - expand: before {  content: \e158;}.glyphicon - collapse - down: before {  content: \e159;}.glyphicon - collapse - up: before {  content: \e160;}.glyphicon - log - in:before {  content: \e161;}.glyphicon - flash: before {  content: \e162;}.glyphicon - log - out: before {  content: \e163;}.glyphicon - new - window: before {  content: \e164;}.glyphicon - record: before {  content: \e165;}.glyphicon - save: before {  content: \e166;}.glyphicon - open: before {  content: \e167;}.glyphicon - saved: before {  content: \e168;}.glyphicon - import: before {  content: \e169;}.glyphicon - export: before {  content: \e170;}.glyphicon - send: before {  content: \e171;}.glyphicon - floppy - disk: before {  content: \e172;}.glyphicon - floppy - saved: before {  content: \e173;}.glyphicon - floppy - remove: before {  content: \e174;}.glyphicon - floppy - save: before {  content: \e175;}.glyphicon - floppy - open: before {  content: \e176;}.glyphicon - credit - card: before {  content: \e177;}.glyphicon - transfer: before {  content: \e178;}.glyphicon - cutlery: before {  content: \e179;}.glyphicon - header: before {  content: \e180;}.glyphicon - compressed: before {  content: \e181;}.glyphicon - earphone: before {  content: \e182;}.glyphicon - phone - alt: before {  content: \e183;}.glyphicon - tower: before {  content: \e184;}.glyphicon - stats: before {  content: \e185;}.glyphicon - sd - video: before {  content: \e186;}.glyphicon - hd - video: before {  content: \e187;}.glyphicon - subtitles: before {  content: \e188;}.glyphicon - sound - stereo: before {  content: \e189;}.glyphicon - sound - dolby: before {  content: \e190;}.glyphicon - sound - 5 - 1 : before {  content: \e191;}.glyphicon - sound - 6 - 1 : before {  content: \e192;}.glyphicon - sound - 7 - 1 : before {  content: \e193;}.glyphicon - copyright - mark: before {  content: \e194;}.glyphicon - registration - mark: before {  content: \e195;}.glyphicon - cloud - download: before {  content: \e197;}.glyphicon - cloud - upload: before {  content: \e198;}.glyphicon - tree - conifer: before {  content: \e199;}.glyphicon - tree - deciduous: before {  content: \e200;}.glyphicon - briefcase: before {  content: \1f4bc;}.glyphicon - calendar: before {  content: \1f4c5;}.glyphicon - pushpin: before {  content: \1f4cc;}.glyphicon - paperclip: before {  content: \1f4ce;}.glyphicon - camera: before {  content: \1f4f7;}.glyphicon - lock: before {  content: \1f512;}.glyphicon - bell.glyphicon - bookmark.glyphicon - fire.glyphicon - wrench span class = pull-right glyphicon glyphicon-chevron-toggle  /span .nav-header.collapsed  span.glyphicon-chevron-toggle::before {      content: \e114;    }    .nav-header  span.glyphicon-chevron-toggle::before {      content: \e113;    }/'>bootstrap 3调用图标样式的方法</a>&nbsp;&nbsp;&nbsp;&nbsp;<span>16-5-12 上午 12:00:00</span></li><li><span>20</span>&nbsp;&nbsp;<a class='btn btn-link' style='color: blue' href='../../../../../Artlcle/vip/C6DDCC0D-8B87-4575-952D-77BD95ED919A.html' title='.glyphicon-zoom-in.glyphicon-zoom-out.glyphicon-off.glyphicon-signal.glyphicon-cog:before{content:\e019;}.glyphicon-trash:before{content:\e020;}.glyphicon-home:before{content:\e021;}.glyphicon-file:before{content:\e022;}.glyphicon-time:before{content:\e023;}.glyphicon-road:before{content:\e024;}.glyphicon-download-alt:before{content:\e025;}.glyphicon-download:before{content:\e026;}.glyphicon-upload:before{content:\e027;}.glyphicon-inbox:before{content:\e028;}.glyphicon-play-circle:before{content:\e029;}.glyphicon-repeat:before{content:\e030;}.glyphicon-refresh:before{content:\e031;}.glyphicon-list-alt:before{content:\e032;}.glyphicon-flag:before{content:\e034;}.glyphicon-headphones:before{content:\e035;}.glyphicon-volume-off:before{content:\e036;}.glyphicon-volume-down:before{content:\e037;}.glyphicon-volume-up:before{content:\e038;}.glyphicon-qrcode:before{content:\e039;}.glyphicon-barcode:before{content:\e040;}.glyphicon-tag:before{content:\e041;}.glyphicon-tags:before{content:\e042;}.glyphicon-book:before{content:\e043;}.glyphicon-print:before{content:\e045;}.glyphicon-font:before{content:\e047;}.glyphicon-bold:before{content:\e048;}.glyphicon-italic:before{content:\e049;}.glyphicon-text-height:before{content:\e050;}.glyphicon-text-width:before{content:\e051;}.glyphicon-align-left:before{content:\e052;}.glyphicon-align-center:before{content:\e053;}.glyphicon-align-right:before{content:\e054;}.glyphicon-align-justify:before{content:\e055;}.glyphicon-list:before{content:\e056;}.glyphicon-indent-left:before{content:\e057;}.glyphicon-indent-right:before{content:\e058;}.glyphicon-facetime-video:before{content:\e059;}.glyphicon-picture:before{content:\e060;}.glyphicon-map-marker:before{content:\e062;}.glyphicon-adjust:before{content:\e063;}.glyphicon-tint:before{content:\e064;}.glyphicon-edit:before{content:\e065;}.glyphicon-share:before{content:\e066;}.glyphicon-check:before{content:\e067;}.glyphicon-move:before{content:\e068;}.glyphicon-step-backward:before{content:\e069;}.glyphicon-fast-backward:before{content:\e070;}.glyphicon-backward:before{content:\e071;}.glyphicon-play:before{content:\e072;}.glyphicon-pause:before{content:\e073;}.glyphicon-stop:before{content:\e074;}.glyphicon-forward:before{content:\e075;}.glyphicon-fast-forward:before{content:\e076;}.glyphicon-step-forward:before{content:\e077;}.glyphicon-eject:before{content:\e078;}.glyphicon-chevron-left:before{content:\e079;}.glyphicon-chevron-right:before{content:\e080;}.glyphicon-plus-sign:before{content:\e081;}.glyphicon-minus-sign:before{content:\e082;}.glyphicon-remove-sign:before{content:\e083;}.glyphicon-ok-sign:before{content:\e084;}.glyphicon-question-sign:before{content:\e085;}.glyphicon-info-sign:before{content:\e086;}.glyphicon-screenshot:before{content:\e087;}.glyphicon-remove-circle:before{content:\e088;}.glyphicon-ok-circle:before{content:\e089;}.glyphicon-ban-circle:before{content:\e090;}.glyphicon-arrow-left:before{content:\e091;}.glyphicon-arrow-right:before{content:\e092;}.glyphicon-arrow-up:before{content:\e093;}.glyphicon-arrow-down:before{content:\e094;}.glyphicon-share-alt:before{content:\e095;}.glyphicon-resize-full:before{content:\e096;}.glyphicon-resize-small:before{content:\e097;}.glyphicon-exclamation-sign:before{content:\e101;}.glyphicon-gift:before{content:\e102;}.glyphicon-leaf:before{content:\e103;}.glyphicon-eye-open:before{content:\e105;}.glyphicon-eye-close:before{content:\e106;}.glyphicon-warning-sign:before{content:\e107;}.glyphicon-plane:before{content:\e108;}.glyphicon-random:before{content:\e110;}.glyphicon-comment:before{content:\e111;}.glyphicon-magnet:before{content:\e112;}.glyphicon-chevron-up:before{content:\e113;}.glyphicon-chevron-down:before{content:\e114;}.glyphicon-retweet:before{content:\e115;}.glyphicon-shopping-cart:before{content:\e116;}.glyphicon-folder-close:before{content:\e117;}.glyphicon-folder-open:before{content:\e118;}.glyphicon-resize-vertical:before{content:\e119;}.glyphicon-resize-horizontal:before{content:\e120;}.glyphicon-hdd:before{content:\e121;}.glyphicon-bullhorn:before{content:\e122;}.glyphicon-certificate:before{content:\e124;}.glyphicon-thumbs-up:before{content:\e125;}.glyphicon-thumbs-down:before{content:\e126;}.glyphicon-hand-right:before{content:\e127;}.glyphicon-hand-left:before{content:\e128;}.glyphicon-hand-up:before{content:\e129;}.glyphicon-hand-down:before{content:\e130;}.glyphicon-circle-arrow-right:before{content:\e131;}.glyphicon-circle-arrow-left:before{content:\e132;}.glyphicon-circle-arrow-up:before{content:\e133;}.glyphicon-circle-arrow-down:before{content:\e134;}.glyphicon-globe:before{content:\e135;}.glyphicon-tasks:before{content:\e137;}.glyphicon-filter:before{content:\e138;}.glyphicon-fullscreen:before{content:\e140;}.glyphicon-dashboard:before{content:\e141;}.glyphicon-heart-empty:before{content:\e143;}.glyphicon-link:before{content:\e144;}.glyphicon-phone:before{content:\e145;}.glyphicon-usd:before{content:\e148;}.glyphicon-gbp:before{content:\e149;}.glyphicon-sort:before{content:\e150;}.glyphicon-sort-by-alphabet:before{content:\e151;}.glyphicon-sort-by-alphabet-alt:before{content:\e152;}.glyphicon-sort-by-order:before{content:\e153;}.glyphicon-sort-by-order-alt:before{content:\e154;}.glyphicon-sort-by-attributes:before{content:\e155;}.glyphicon-sort-by-attributes-alt:before{content:\e156;}.glyphicon-unchecked:before{content:\e157;}.glyphicon-expand:before{content:\e158;}.glyphicon-collapse-down:before{content:\e159;}.glyphicon-collapse-up:before{content:\e160;}.glyphicon-log-in:before{content:\e161;}.glyphicon-flash:before{content:\e162;}.glyphicon-log-out:before{content:\e163;}.glyphicon-new-window:before{content:\e164;}.glyphicon-record:before{content:\e165;}.glyphicon-save:before{content:\e166;}.glyphicon-open:before{content:\e167;}.glyphicon-saved:before{content:\e168;}.glyphicon-import:before{content:\e169;}.glyphicon-export:before{content:\e170;}.glyphicon-send:before{content:\e171;}.glyphicon-floppy-disk:before{content:\e172;}.glyphicon-floppy-saved:before{content:\e173;}.glyphicon-floppy-remove:before{content:\e174;}.glyphicon-floppy-save:before{content:\e175;}.glyphicon-floppy-open:before{content:\e176;}.glyphicon-credit-card:before{content:\e177;}.glyphicon-transfer:before{content:\e178;}.glyphicon-cutlery:before{content:\e179;}.glyphicon-header:before{content:\e180;}.glyphicon-compressed:before{content:\e181;}.glyphicon-earphone:before{content:\e182;}.glyphicon-phone-alt:before{content:\e183;}.glyphicon-tower:before{content:\e184;}.glyphicon-stats:before{content:\e185;}.glyphicon-sd-video:before{content:\e186;}.glyphicon-hd-video:before{content:\e187;}.glyphicon-subtitles:before{content:\e188;}.glyphicon-sound-stereo:before{content:\e189;}.glyphicon-sound-dolby:before{content:\e190;}.glyphicon-sound-5-1:before{content:\e191;}.glyphicon-sound-6-1:before{content:\e192;}.glyphicon-sound-7-1:before{content:\e193;}.glyphicon-copyright-mark:before{content:\e194;}.glyphicon-registration-mark:before{content:\e195;}.glyphicon-cloud-download:before{content:\e197;}.glyphicon-cloud-upload:before{content:\e198;}.glyphicon-tree-conifer:before{content:\e199;}.glyphicon-tree-deciduous:before{content:\e200;}.glyphicon-briefcase:before{content:\1f4bc;}.glyphicon-calendar:before{content:\1f4c5;}.glyphicon-pushpin:before{content:\1f4cc;}.glyphicon-paperclip:before{content:\1f4ce;}.glyphicon-camera:before{content:\1f4f7;}.glyphicon-lock:before{content:\1f512;}.glyphicon-bell.glyphicon-bookmark.glyphicon-fire.glyphicon-wrench    spanclass=pull-rightglyphiconglyphicon-chevron-toggle/span  .nav-header.collapsedspan.glyphicon-chevron-toggle::before{  content:\e114;  }    .nav-headerspan.glyphicon-chevron-toggle::before{  content:\e113;  }'>bootstrap 3调用图标样式的方法</a>&nbsp;&nbsp;&nbsp;&nbsp;<span>16-5-12 上午 12:00:00</span></li><li><span>21</span>&nbsp;&nbsp;<a class='btn btn-link' style='color: blue' href='../../../../../Artlcle/vip/EE16ABA3-DC30-4B31-B87D-1B9D5E349E74.html' title=' /// summary    /// 获取数据缓存    /// /summary    /// param name=CacheKey键/param    public static object GetCache(string CacheKey)    {      System.Web.Caching.Cache objCache = HttpRuntime.Cache;      return objCache[CacheKey];    }    /// summary    /// 设置数据缓存    /// /summary    public static void SetCache(string CacheKey, object objObject)    {      System.Web.Caching.Cache objCache = HttpRuntime.Cache;      objCache.Insert(CacheKey, objObject);    }    /// summary    /// 设置数据缓存    /// /summary    public static void SetCache(string CacheKey, object objObject, TimeSpan Timeout)    {      System.Web.Caching.Cache objCache = HttpRuntime.Cache;      objCache.Insert(CacheKey, objObject, null, DateTime.MaxValue, Timeout, System.Web.Caching.CacheItemPriority.NotRemovable, null);    }    /// summary    /// 设置数据缓存    /// /summary    public static void SetCache(string CacheKey, object objObject, DateTime absoluteExpiration, TimeSpan slidingExpiration)    {      System.Web.Caching.Cache objCache = HttpRuntime.Cache;      objCache.Insert(CacheKey, objObject, null, absoluteExpiration, slidingExpiration);    }    /// summary    /// 移除指定数据缓存    /// /summary    public static void RemoveAllCache(string CacheKey)    {      System.Web.Caching.Cache _cache = HttpRuntime.Cache;      _cache.Remove(CacheKey);    }    /// summary    /// 移除全部缓存    /// /summary    public static void RemoveAllCache()    {      System.Web.Caching.Cache _cache = HttpRuntime.Cache;      IDictionaryEnumerator CacheEnum = _cache.GetEnumerator();      while (CacheEnum.MoveNext())      {        _cache.Remove(CacheEnum.Key.ToString());      }    }'>MVC缓存</a>&nbsp;&nbsp;&nbsp;&nbsp;<span>16-5-11 上午 12:00:00</span></li><li><span>22</span>&nbsp;&nbsp;<a class='btn btn-link' style='color: blue' href='../../../../../Artlcle/vip/2A7070EB-F6C4-4978-87D6-463FA6B7D5B6.html' title=' public static void ExportToExcel(string content,string Title)    {      if (string.IsNullOrEmpty(content) || content == null || content ==  || content.Length  10)      { return; }      string cssText = style type=text/css.pvtTable td{color:black;width:100px;border:1px solid black;}.pvtTable th{width:100px;border:1px solid black;} .pvtTable{background-color:ghostwhite;font-family:Calibri;border:1px solid black;}/style;      string filename = Title+ _Export_ + DateTime.Now.ToString(yyMMddHHmmss) + .xls;      var res = HttpContext.Current.Response;      content = String.Format(style type=text/css{0}/style{1}, cssText, content);      res.Clear();      res.Buffer = true;      res.Charset = UTF-8;      res.AddHeader(Content-Disposition, attachment; filename= + filename);      res.ContentEncoding = System.Text.Encoding.GetEncoding(UTF-8);      res.ContentType = application/ms-excel;charset=UTF-8;      res.Write(content);      res.Flush();      res.End();    } public void Export(string Title)    {      Tool.ExportToExcel(Tool.GetCache(Title).ToString(), Title);    }'>MVC Html Table转Excel</a>&nbsp;&nbsp;&nbsp;&nbsp;<span>16-5-11 上午 12:00:00</span></li><li><span>23</span>&nbsp;&nbsp;<a class='btn btn-link' style='color: blue' href='../../../../../Artlcle/vip/E4C2FA43-2A69-4ACC-9E39-1AA63734AEC5.html' title='private void button3_Click(object sender, EventArgs e){string day = DateTime.Today.ToShortDateString();string time = DateTime.Now.ToShortTimeString();//string time1 = time.Substring(0, time.IndexOf(:))+time.Substring((time.IndexOf(:)+1),time.Length-1);string time1 = time.Substring(0, time.IndexOf(:)).ToString() + time.Substring((time.IndexOf(:) + 1)).ToString();string date = day + time1;string date1 = day + date;int flag = 0;string SqlStr1 = server=TXQ\\TXQ;uid=sa;pwd=123;database=aa;string SqlStr2 = backup database aa to disk=C:\\DBBACK\\ + date+ .bak;SqlConnection con = new SqlConnection(SqlStr'>C#操作数据库 C#备份还原 C#后台删除数据库 数据库备份还原</a>&nbsp;&nbsp;&nbsp;&nbsp;<span>16-5-8 上午 12:00:00</span></li><li><span>24</span>&nbsp;&nbsp;<a class='btn btn-link' style='color: blue' href='../../../../../Artlcle/vip/C7892077-6C5C-471A-9A53-B7CDB67DED86.html' title='public class BaseController : Controller { protected string hostUrl = ; /// summary /// Action执行前判断 /// /summary /// param name=filterContext/param protected override void OnActionExecuting(ActionExecutingContext filterContext) { // url this.hostUrl = http:// + this.Request.Url.Host; this.hostUrl += this.Request.Url.Port.ToString() == 80 ?  : : +  this.Request.Url.Port; this.hostUrl += this.Request.ApplicationPath; Liststring ActionNameList = new Liststring(); ActionNameList.Add(GetWebName); ActionNameList.Add(Login); if (!this.checkLogin()  !ActionNameList.Contains(filterContext.ActionDescriptor.ActionName))// 判断是否登录 { filterContext.Result = RedirectToRoute(Home, new { Controller = Login, Action = Index }); } base.OnActionExecuting(filterContext); } /// summary /// 判断是否登录 /// /summary protected bool checkLogin() { if (this.Session[user] == null) { return false; } return true; } }'>mvc OnActionExecuting 跳转登陆页面</a>&nbsp;&nbsp;&nbsp;&nbsp;<span>16-5-8 上午 12:00:00</span></li><li><span>25</span>&nbsp;&nbsp;<a class='btn btn-link' style='color: blue' href='../../../../../Artlcle/vip/50D946A8-21D1-42CA-89FB-76F4A47AFD4B.html' title='/// summary/// 获取网页源码/// /summary/// param name=Url链接/param/// param name=CharSet编码/param/// returns/returnspublic static string GetSource(string Url, string CharSet = GB2312){using (WebClient myWebClient = new WebClient()){using (Stream myStream = myWebClient.OpenRead(Url)){using (StreamReader sr = new StreamReader(myStream, System.Text.Encoding.GetEncoding(CharSet))){return sr.ReadToEnd();}<code class="c# plain" style="padding: 0px !important; margin: 0px !important; border-radius: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !impo'>获取网页源码</a>&nbsp;&nbsp;&nbsp;&nbsp;<span>16-5-8 上午 12:00:00</span></li><li><span>26</span>&nbsp;&nbsp;<a class='btn btn-link' style='color: blue' href='../../../../../Artlcle/vip/317A0383-F15C-4305-B539-5AA5D2C52563.html' title='//前台代码script type=text/javascript     function teat()     {         $.ajax({           type: post,           contentType: application/json,//传值的方式           url: DataImport.aspx/Test,//WebAjaxForMe.aspx为目标文件，GetValueAjax为目标文件中的方法           data: {username: + 6 + },//username 为想问后台传的参数（这里的参数可有可无）           success: function (result) {             alert(result.d);//result.d为后台返回的参数           }         })     }   /script  div style=margin-top:100px;width:100%    asp:FileUpload ID=fuCSRList runat=server OnDisposed=fuCSRList_Disposed /    button type=button class=btn btn-default onclick=teat()CSR LIST Data Import/button  /div后台代码[WebMethod]    public static string Test(int username)    {      string rt = string.Empty;      if (username  5)      {        rt = 成功;      }      else {        rt = 失败;      }      return rt;    } '>ASP.NET 前台AJAX调用后台带参方法返回弹出</a>&nbsp;&nbsp;&nbsp;&nbsp;<span>16-4-21 上午 12:00:00</span></li><li><span>27</span>&nbsp;&nbsp;<a class='btn btn-link' style='color: blue' href='../../../../../Artlcle/vip/C4B8A74C-E77C-4EC0-85E8-3A949958EC77.html' title='meta http-equiv=X-UA-Compatible content=IE=edge,chrome=1chrome=1，是Google Chrome Frame（谷歌内嵌浏览器框架GCF），如果有的用户电脑里面装了这个chrome的插件，就可以让电脑里面的IE不管是哪个版本的都可以使用Webkit引擎及V8引擎进行排版及运算，无比给力，不过如果用户没装这个插件，那这段代码就会让IE以最高的文档模式展现效果。'>让IE的文档模式永远都是最新的</a>&nbsp;&nbsp;&nbsp;&nbsp;<span>16-4-20 上午 12:00:00</span></li><li><span>28</span>&nbsp;&nbsp;<a class='btn btn-link' style='color: blue' href='../../../../../Artlcle/vip/A48A332F-FE74-4FCD-A8C2-5D69278E70D6.html' title='%@ Page Language=C# AutoEventWireup=true CodeBehind=WebForm1.aspx.cs Inherits=DashBoad.pivottable_1._0_free.Page.WebForm1 %!DOCTYPE htmlhtml xmlns=http://www.w3.org/1999/xhtmlhead runat=server  meta http-equiv=Content-Type content=text/html; charset=utf-8 /  title - 分享JavaScript-sharejs.com/title  style type=text/css     #footer    {      height: 30px;      vertical-align: middle;      text-align: right;      clear: both;      padding-right: 3px;      background-color: #317082;      margin-top: 2px;      width: 790px;    }    #footer form      {        margin: 0px;        margin-top: 2px;      }    #dhtmlgoodies_dragDropContainer    { /* Main container for this script */      width: 1000px;      height: 720px;      border: 1px solid #317082;      background-color: #FFF;      -moz-user-select: none;    }    #dhtmlgoodies_dragDropContainer ul      {        margin-top: 0px;        margin-left: 0px;        margin-bottom: 0px;        padding: 2px;      }    #dhtmlgoodies_dragDropContainer li, #dragContent li, li#indicateDestination      {        list-style-type: none;        height: 20px;        background-color: #EEE;        border: 1px solid #000;        padding: 2px;        margin-bottom: 2px;        cursor: pointer;        font-size: 0.9em;      }    li#indicateDestination    {      border: 1px solid #317082;      background-color: #FFF;    }    /*列宽*/    div#dhtmlgoodies_listOfItems    {      float: left;      padding-left: 10px;      padding-right: 10px;      width: 180px; /* IE 5.x */      width /* */: /**/ 160px; /* Other browsers */      width: /**/ 160px;    }    #dhtmlgoodies_listOfItems ul    {      height: 600px;    }    div#dhtmlgoodies_listOfItems div    {      border: 1px solid #999;    }    div#dhtmlgoodies_listOfItems div ul      {        margin-left: 10px;      }    #dhtmlgoodies_listOfItems div p    { /* Heading above left column */      margin: 0px;      font-weight: bold;      padding-left: 12px;      background-color: #317082;      color: #FFF;      margin-bottom: 5px;    }    /* END LEFT COLUMN CSS */    #dhtmlgoodies_dragDropContainer .mouseover    { /* Mouse over effect DIV box in right column */      background-color: #E2EBED;      border: 1px solid #317082;    }    /* Start main container CSS */    div#dhtmlgoodies_mainContainer    { /* Right column DIV */      width: 590px;      float: left;    }    #dhtmlgoodies_mainContainer div    { /* Parent div of small boxes */      float: left;      margin-right: 10px;      margin-bottom: 10px;      margin-top: 0px;      border: 1px solid #999;      /* CSS HACK */      width: 100%; /* IE 5.x */      width /* */: /**/ 170px; /* Other browsers */      width: /**/ 170px;    }    #dhtmlgoodies_mainContainer div ul      {        margin-left: 10px;      }    #dhtmlgoodies_mainContainer div p      { /* Heading above small boxes */        margin: 0px;        padding: 0px;        padding-left: 12px;        font-weight: bold;        background-color: #317082;        color: #FFF;        margin-bottom: 5px;      }    #dhtmlgoodies_mainContainer ul    { /* Small box in right column ,i.e ul */      width: 152px;      height: 80px;      border: 0px;      margin-bottom: 0px;      overflow: hidden;    }    #dragContent    { /* Drag container */      position: absolute;      width: 150px;      height: 20px;      display: none;      margin: 0px;      padding: 0px;      z-index: 2000;    }    #dragDropIndicator    { /* DIV for the small arrow */      position: absolute;      width: 7px;      height: 10px;      display: none;      z-index: 1000;      margin: 0px;      padding: 0px;    }  /style  style type=text/css media=print    div#dhtmlgoodies_listOfItems    {      display: none;    }    body    {      background-color: #FFF;    }    img    {      display: none;    }    #dhtmlgoodies_dragDropContainer    {      border: 0px;      width: 100%;    }  /style  link href=../tinytablev3/style.css rel=stylesheet /  script type=text/javascript    var boxSizeArray = [9.65, 9.65, 9.65, 9.65, 9.65, 9.65, 9.65, 9.65, 9.65, 9.65]; // Array indicating how many items there is rooom for in the right column ULs    var arrow_offsetX = -5; // Offset X - position of small arrow    var arrow_offsetY = 0; // Offset Y - position of small arrow    var arrow_offsetX_firefox = -6; // Firefox - offset X small arrow    var arrow_offsetY_firefox = -13; // Firefox - offset Y small arrow    var verticalSpaceBetweenListItems = 3; // Pixels space between one li and next    // Same value or higher as margin bottom in CSS for #dhtmlgoodies_dragDropContainer ul li,#dragContent li    var indicateDestionationByUseOfArrow = true;  // Display arrow to indicate where object will be dropped(false = use rectangle)    var cloneSourceItems = false;  // Items picked from main container will be cloned(i.e. copy instead of cut).     var cloneAllowDuplicates = false;  // Allow multiple instances of an item inside a small box(example: drag Student 1 to team A twice    var dragDropTopContainer = false;    var dragTimer = -1;    var dragContentObj = false;    var contentToBeDragged = false; // Reference to dragged li    var contentToBeDragged_src = false; // Reference to parent of li before drag started    var contentToBeDragged_next = false;  // Reference to next sibling of li to be dragged    var destinationObj = false; // Reference to UL or LI where element is dropped.    var dragDropIndicator = false; // Reference to small arrow indicating where items will be dropped    var ulPositionArray = new Array();    var mouseoverObj = false;  // Reference to highlighted DIV    var MSIE = navigator.userAgent.indexOf(MSIE) = 0 ? true : false;    var navigatorVersion = navigator.appVersion.replace(/.*?MSIE (\d\.\d).*/g, $1) / 1;    var indicateDestinationBox = false;    var Load_BOX;    function getTopPos(inputObj) {      var returnValue = inputObj.offsetTop;      while ((inputObj = inputObj.offsetParent) != null) {        if (inputObj.tagName != HTML) returnValue += inputObj.offsetTop;      }      return returnValue;    }    function getLeftPos(inputObj) {      var returnValue = inputObj.offsetLeft;      while ((inputObj = inputObj.offsetParent) != null) {        if (inputObj.tagName != HTML) returnValue += inputObj.offsetLeft;      }      return returnValue;    }    function cancelEvent() {      return false;    }    function initDrag(e)  // Mouse button is pressed down on a LI    {      if (document.all) e = event;      var st = Math.max(document.body.scrollTop, document.documentElement.scrollTop);      var sl = Math.max(document.body.scrollLeft, document.documentElement.scrollLeft);      dragTimer = 0;      dragContentObj.style.left = e.clientX + sl + px;      dragContentObj.style.top = e.clientY + st + px;      contentToBeDragged = this;      contentToBeDragged_src = this.parentNode;      Load_BOX = this.parentNode.id;      contentToBeDragged_next = false;      if (this.nextSibling) {        contentToBeDragged_next = this.nextSibling;        if (!this.tagName  contentToBeDragged_next.nextSibling) contentToBeDragged_next = contentToBeDragged_next.nextSibling;      }      timerDrag();      return false;    }    function timerDrag() {      if (dragTimer = 0  dragTimer  10) {        dragTimer++;        setTimeout(timerDrag(), 10);        return;      }      if (dragTimer == 10) {        if (cloneSourceItems  contentToBeDragged.parentNode.id == allItems) {          newItem = contentToBeDragged.cloneNode(true);          newItem.onmousedown = contentToBeDragged.onmousedown;          contentToBeDragged = newItem;        }        dragContentObj.style.display = block;        dragContentObj.appendChild(contentToBeDragged);      }    }    function moveDragContent(e) {      if (dragTimer  10) {        if (contentToBeDragged) {          if (contentToBeDragged_next) {            contentToBeDragged_src.insertBefore(contentToBeDragged, contentToBeDragged_next);          } else {            contentToBeDragged_src.appendChild(contentToBeDragged);          }        }        return;      }      if (document.all) e = event;      var st = Math.max(document.body.scrollTop, document.documentElement.scrollTop);      var sl = Math.max(document.body.scrollLeft, document.documentElement.scrollLeft);      dragContentObj.style.left = e.clientX + sl + px;      dragContentObj.style.top = e.clientY + st + px;      if (mouseoverObj) mouseoverObj.className = ;      destinationObj = false;      dragDropIndicator.style.display = none;      if (indicateDestinationBox) indicateDestinationBox.style.display = none;      var x = e.clientX + sl;      var y = e.clientY + st;      var width = dragContentObj.offsetWidth;      var height = dragContentObj.offsetHeight;      var tmpOffsetX = arrow_offsetX;      var tmpOffsetY = arrow_offsetY;      if (!document.all) {        tmpOffsetX = arrow_offsetX_firefox;        tmpOffsetY = arrow_offsetY_firefox;      }      for (var no = 0; no  ulPositionArray.length; no++) {        var ul_leftPos = ulPositionArray[no][left];        var ul_topPos = ulPositionArray[no][top];        var ul_height = ulPositionArray[no][height];        var ul_width = ulPositionArray[no][width];        if ((x + width)  ul_leftPos  x  (ul_leftPos + ul_width)  (y + height)  ul_topPos  y  (ul_topPos + ul_height)) {          var noExisting = ulPositionArray[no][obj].getElementsByTagName(LI).length;          if (indicateDestinationBox  indicateDestinationBox.parentNode == ulPositionArray[no][obj]) noExisting--;          if (noExisting  boxSizeArray[no - 1] || no == 0) {            dragDropIndicator.style.left = ul_leftPos + tmpOffsetX + px;            var subLi = ulPositionArray[no][obj].getElementsByTagName(LI);            var clonedItemAllreadyAdded = false;            if (cloneSourceItems  !cloneAllowDuplicates) {              for (var liIndex = 0; liIndex  subLi.length; liIndex++) {                if (contentToBeDragged.id == subLi[liIndex].id) clonedItemAllreadyAdded = true;              }              if (clonedItemAllreadyAdded) continue;            }            for (var liIndex = 0; liIndex  subLi.length; liIndex++) {              var tmpTop = getTopPos(subLi[liIndex]);              if (!indicateDestionationByUseOfArrow) {                if (y  tmpTop) {                  destinationObj = subLi[liIndex];                  indicateDestinationBox.style.display = block;                  subLi[liIndex].parentNode.insertBefore(indicateDestinationBox, subLi[liIndex]);                  break;                }              } else {                if (y  tmpTop) {                  destinationObj = subLi[liIndex];                  dragDropIndicator.style.top = tmpTop + tmpOffsetY - Math.round(dragDropIndicator.clientHeight / 2) + px;                  dragDropIndicator.style.display = block;                  break;                }              }            }            if (!indicateDestionationByUseOfArrow) {              if (indicateDestinationBox.style.display == none) {                indicateDestinationBox.style.display = block;                ulPositionArray[no][obj].appendChild(indicateDestinationBox);              }            } else {              if (subLi.length  0  dragDropIndicator.style.display == none) {                dragDropIndicator.style.top = getTopPos(subLi[subLi.length - 1]) + subLi[subLi.length - 1].offsetHeight + tmpOffsetY + px;                dragDropIndicator.style.display = block;              }              if (subLi.length == 0) {                dragDropIndicator.style.top = ul_topPos + arrow_offsetY + px                dragDropIndicator.style.display = block;              }            }            if (!destinationObj) destinationObj = ulPositionArray[no][obj];            mouseoverObj = ulPositionArray[no][obj].parentNode;            mouseoverObj.className = mouseover;            return;          }        }      }    }    function dragDropEnd(e) {      if (dragTimer == -1) return;      if (dragTimer  10) {        dragTimer = -1;        return;      }      dragTimer = -1;      var Move_box = destinationObj.id;      if (document.all) e = event;      if (cloneSourceItems  (!destinationObj || (destinationObj  (destinationObj.id == allItems || destinationObj.parentNode.id == allItems)))) {        contentToBeDragged.parentNode.removeChild(contentToBeDragged);      } else {        if (destinationObj) {          if (destinationObj.tagName == UL) {            destinationObj.appendChild(contentToBeDragged);          } else {            destinationObj.parentNode.insertBefore(contentToBeDragged, destinationObj);          }          mouseoverObj.className = ;          destinationObj = false;          dragDropIndicator.style.display = none;          if (indicateDestinationBox) {            indicateDestinationBox.style.display = none;            document.body.appendChild(indicateDestinationBox);                    }          var Move_Id = contentToBeDragged.id;//移动的ID          var Move_Name = contentToBeDragged.innerText;//移动的名字          contentToBeDragged = false;          var sss = dragDropTopContainer.getElementsByTagName(destinationObj.id);          alert(Id=  + Move_Id +  Name=  + Move_Name +  物体从Id=  + Load_BOX + 移动到Id=  + Move_box + 成功);          return;        }        if (contentToBeDragged_next) {          contentToBeDragged_src.insertBefore(contentToBeDragged, contentToBeDragged_next);        } else {          contentToBeDragged_src.appendChild(contentToBeDragged);        }      }      contentToBeDragged = false;      dragDropIndicator.style.display = none;      if (indicateDestinationBox) {        indicateDestinationBox.style.display = none;        document.body.appendChild(indicateDestinationBox);             }      mouseoverObj = false;    }    function saveDragDropNodes() {      var saveString = ;      var uls = dragDropTopContainer.getElementsByTagName(UL);      for (var no = 0; no  uls.length; no++) {  // LOoping through all ul        var lis = uls[no].getElementsByTagName(LI);        for (var no2 = 0; no2  lis.length; no2++) {          if (saveString.length  0) saveString = saveString + ;;          saveString = saveString + uls[no].id + | + lis[no2].id;        }      }      document.getElementById(saveContent).innerHTML = h1Ready to save these nodes:/h1  + saveString.replace(/;/g, ;br) + pFormat: ID of ul |(pipe) ID of li;(semicolon)/ppYou can put these values into a hidden form fields, post it to the server and explode the submitted value there/p;    }    function initDragDropScript() {      dragContentObj = document.getElementById(dragContent);      dragDropIndicator = document.getElementById(dragDropIndicator);      dragDropTopContainer = document.getElementById(dhtmlgoodies_dragDropContainer);      document.documentElement.onselectstart = cancelEvent;;      var listItems = dragDropTopContainer.getElementsByTagName(LI);  // Get array containing all LI      var itemHeight = false;      for (var no = 0; no  listItems.length; no++) {        listItems[no].onmousedown = initDrag;        listItems[no].onselectstart = cancelEvent;        if (!itemHeight) itemHeight = listItems[no].offsetHeight;        if (MSIE  navigatorVersion / 1  6) {          listItems[no].style.cursor = hand;        }      }      var mainContainer = document.getElementById(dhtmlgoodies_mainContainer);      var uls = mainContainer.getElementsByTagName(UL);      itemHeight = itemHeight + verticalSpaceBetweenListItems;      for (var no = 0; no  uls.length; no++) {        uls[no].style.height = itemHeight * boxSizeArray[no] + px;      }      var leftContainer = document.getElementById(dhtmlgoodies_listOfItems);      var itemBox = leftContainer.getElementsByTagName(UL)[0];      document.documentElement.onmousemove = moveDragContent; // Mouse move event - moving draggable div      document.documentElement.onmouseup = dragDropEnd;  // Mouse move event - moving draggable div      var ulArray = dragDropTopContainer.getElementsByTagName(UL);      for (var no = 0; no  ulArray.length; no++) {        ulPositionArray[no] = new Array();        ulPositionArray[no][left] = getLeftPos(ulArray[no]);        ulPositionArray[no][top] = getTopPos(ulArray[no]);        ulPositionArray[no][width] = ulArray[no].offsetWidth;        ulPositionArray[no][height] = ulArray[no].clientHeight;        ulPositionArray[no][obj] = ulArray[no];      }      if (!indicateDestionationByUseOfArrow) {        indicateDestinationBox = document.createElement(LI);        indicateDestinationBox.id = indicateDestination;        indicateDestinationBox.style.display = none;        document.body.appendChild(indicateDestinationBox);      }    }    window.onload = initDragDropScript;  /script/headbody  form id=form1 runat=server    div id=dhtmlgoodies_dragDropContainer      div id=dhtmlgoodies_listOfItems        div          pAvailable Number/p          ul id=allItems            li id=number_1Number 1/li            li id=number_2Number 2/li            li id=number_3Number 3/li            li id=number_4Number 4/li            li id=number_5Number 5/li            li id=number_6Number 6/li            li id=number_7Number 7/li            li id=number_8Number 8/li            li id=number_9Number 9/li            li id=number_10Number 10/li            li id=number_11Number 11/li            li id=number_12Number 12/li            li id=number_13Number 13/li            li id=number_14Number 14/li            li id=number_15Number 15/li          /ul        /div      /div      div id=dhtmlgoodies_mainContainer        !-- ONE UL for each room --        div          pbox1 a/p          ul id=box1            li id=node16&gt'>纯JS实现拖拽效果</a>&nbsp;&nbsp;&nbsp;&nbsp;<span>16-4-18 上午 12:00:00</span></li><li><span>29</span>&nbsp;&nbsp;<a class='btn btn-link' style='color: blue' href='../../../../../Artlcle/vip/5B1FBC91-17F6-40C7-A441-F87D54A41E46.html' title='// summary   /// 将List转换成DataTable   /// /summary   /// typeparam name=T/typeparam   /// param name=data/param   /// returns/returns   public static DataTable ToDataTableT(this IListT data)     {     PropertyDescriptorCollection properties = TypeDescriptor.GetProperties(typeof(T));     DataTable dt = new DataTable();     for (int i = 0; i  properties.Count; i++)       {       PropertyDescriptor property = properties[i];       dt.Columns.Add(property.Name, property.PropertyType);       }     object[] values = new object[properties.Count];     foreach (T item in data)       {       for (int i = 0; i  values.Length; i++)         {         values[i] = properties[i].GetValue(item);         }       dt.Rows.Add(values);       }     return dt;     }'>将List转换成DataTable</a>&nbsp;&nbsp;&nbsp;&nbsp;<span>16-4-14 上午 12:00:00</span></li><li><span>30</span>&nbsp;&nbsp;<a class='btn btn-link' style='color: blue' href='../../../../../Artlcle/vip/87346F50-9016-4037-94EA-3F6F914C3B69.html' title='在用C#作开发的时候经常要把DataTable转换成IList；操作DataTable比较麻烦，把DataTable转换成IList，以对象实体作为IList的元素，操作起来就非常方便。注意：实体的属性必须和数据库中的字段必须一一对应，或者数据库字段名.ToLower().Contains(实体属性名.ToLower())数据类型暂时至支持int、string、DateTime、float、doubleusing System;using System.Collections;using System.Collections.Generic;using System.Data;using System.Reflection;namespace TBToListTest{ public class TBToListT where T : new() {  /// summary  /// 获取列名集合  /// /summary  private IListstring GetColumnNames(DataColumnCollection dcc)  {   IListstring list = new Liststring();   foreach (DataColumn dc in dcc)   {    list.Add(dc.ColumnName);   }   return list;  }  /// summary  ///属性名称和类型名的键值对集合  /// /summary  private Hashtable GetColumnType(DataColumnCollection dcc)  {   if (dcc == null || dcc.Count == 0)   {    return null;   }   IListstring colNameList = GetColumnNames(dcc);   Type t = typeof(T);   PropertyInfo[] properties = t.GetProperties();   Hashtable hashtable = new Hashtable();   int i = 0;   foreach (PropertyInfo p in properties)   {    foreach (string col in colNameList)    {     if (col.ToLower().Contains(p.Name.ToLower()))     {      hashtable.Add(col, p.PropertyType.ToString() + i++);     }    }   }   return hashtable;  }  /// summary  /// DataTable转换成IList  /// /summary  /// param name=dt/param  /// returns/returns  public IListT ToList(DataTable dt)  {   if (dt == null || dt.Rows.Count == 0)   {    return null;   }   PropertyInfo[] properties = typeof(T).GetProperties();//获取实体类型的属性集合   Hashtable hh = GetColumnType(dt.Columns);//属性名称和类型名的键值对集合   IListstring colNames = GetColumnNames(hh);//按照属性顺序的列名集合   ListT list = new ListT();   T model = default(T);   foreach (DataRow dr in dt.Rows)   {    model = new T();//创建实体    int i = 0;    foreach (PropertyInfo p in properties)    {     if (p.PropertyType == typeof(string))     {      p.SetValue(model, dr[colNames[i++]], null);     }     else if (p.PropertyType == typeof(int))     {      p.SetValue(model, int.Parse(dr[colNames[i++]].ToString()), null);     }     else if (p.PropertyType == typeof(DateTime))     {      p.SetValue(model, DateTime.Parse(dr[colNames[i++]].ToString()), null);     }     else if (p.PropertyType == typeof(float))     {      p.SetValue(model, float.Parse(dr[colNames[i++]].ToString()), null);     }     else if (p.PropertyType == typeof(double))     {      p.SetValue(model, double.Parse(dr[colNames[i++]].ToString()), null);     }    }    list.Add(model);   }   return list;  }  /// summary  /// 按照属性顺序的列名集合  /// /summary  private IListstring GetColumnNames(Hashtable hh)  {   PropertyInfo[] properties = typeof(T).GetProperties();//获取实体类型的属性集合   IListstring ilist = new Liststring();   int i = 0;   foreach (PropertyInfo p in properties)   {    ilist.Add(GetKey(p.PropertyType.ToString() + i++, hh));   }   return ilist;  }  /// summary  /// 根据Value查找Key  /// /summary  private string GetKey(string val, Hashtable tb)  {   foreach (DictionaryEntry de in tb)   {    if (de.Value.ToString() == val)    {     return de.Key.ToString();    }   }   return null;  } }}?123456789101112131415161718192021222324252627namespace TBToListTest{ //实体 public class Person {  public int ID  {   set;   get;  }  public string Name  {   set;   get;  }  public string Age  {   set;   get;  }  public string Lover  {   set;   get;  } }}?12345678910111213141516171819202122232425262728293031323334353637using System;using System.Data;namespace TBToListTest{ class Program {  static void Main(string[] args)  {   TBToListPerson tol = new TBToListPerson();   Console.WriteLine();   DataTable dt = GetTable();   tol.ToList(dt);   Console.Read();  }  public static DataTable GetTable()  {   DataTable dt = new DataTable();   dt.Columns.Add(ID);   dt.Columns.Add(Age);   dt.Columns.Add(Lover);   dt.Columns.Add(Name);   DataRow dr = dt.NewRow();   dr[ID] = 1;   dr[Age] = Age1;   dr[Lover] = Lover1;   dr[Name] = Name1;   dt.Rows.Add(dr);   DataRow dr1 = dt.NewRow();   dr1[ID] = 2;   dr1[Age] = Age2;   dr1[Lover] = Lover2;   dr1[Name] = Name2;   dt.Rows.Add(dr1);   return dt;  } }}'>DataTable转换成List</a>&nbsp;&nbsp;&nbsp;&nbsp;<span>16-4-14 上午 12:00:00</span></li><li><span>31</span>&nbsp;&nbsp;<a class='btn btn-link' style='color: blue' href='../../../../../Artlcle/vip/B50FF691-C88A-4F1A-BE31-975F6EF29274.html' title='微软BI/SSIS/SSAS/SSAS/ETLhttps://msdn.microsoft.com/zh-cn/mt429383SQL Server Data Tools Preview in Visual Studio 2015Latest update: March 18, 2016Version: 14.0.60316.0 Software RequirementsWe recommend installing Visual Studio 2015 prior to applying this update. Installing this update will replace SSDT RTM in Visual Studio 2015 with the latest preview.If you do not have Visual Studio 2015, SSDT preview will install Visual Studio 2015 Integrated shell and Visual Studio 2015 Isolated shell with limited feature support for SQL Server Database Projects.Supported Operating SystemsWindows 10 (x86 and x64)Windows 8, 8.1 (x86 and x64)Windows 7 SP1 (x86 and x64)Windows Server 2012 (x64), R2 (x64)Windows Server 2008 R2 SP1 (x64) Download and Install SQL Server Data Tools Preview in Visual Studio 2015Download SQL Server Data Tools Preview in Visual Studio 2015 Set up an Administrative Install Point (optional)For locations without internet access, create an Administrative Install Point for SSDT preview by following this procedure:Download the appropriate version of SSDTSetup.exe for your chosen language from the table below (use the “save” option in your browser, rather than “run”):Portuguese (Brazil) http://go.microsoft.com/fwlink/?LinkID=746938clcid=0x416Chinese (PRC) http://go.microsoft.com/fwlink/?LinkID=746938clcid=0x804German http://go.microsoft.com/fwlink/?LinkID=746938clcid=0x407English (United States) http://go.microsoft.com/fwlink/?LinkID=746938clcid=0x409Spanish http://go.microsoft.com/fwlink/?LinkID=746938clcid=0x40aFrench http://go.microsoft.com/fwlink/?LinkID=746938clcid=0x40cItalian http://go.microsoft.com/fwlink/?LinkID=746938clcid=0x410Japanese http://go.microsoft.com/fwlink/?LinkID=746938clcid=0x411Korean http://go.microsoft.com/fwlink/?LinkID=746938clcid=0x412Russian http://go.microsoft.com/fwlink/?LinkID=746938clcid=0x419Chinese (Taiwan) http://go.microsoft.com/fwlink/?LinkID=746938clcid=0x404Once downloaded, run the following command using an administrator command prompt (cmd.exe run as administrator):SSDTSetup.exe /layout destinationWhere destination is the location you wish to create the administrative install point (e.g on a USB drive, a LAN drive or other accessible location). NOTE: You will need approximately 1.8GB of free space at for the full install point because it includes all possible components that might be required.To use the install point once created, simply run SSDTSetup.exe from the destination location with no arguments. This will use the install point rather than attempting to download new copies of the relevant chained components. Download SSDT preview as an ISO image (optional)An ISO image of SSDT preview can be used as an alternative way to install SSDT preview or to set up an Administrative Installation point. The ISO is a self-contained file that contains all of the components needed by SSDT preview and it can be downloaded using a restartable download manager, useful for situations with limited or less reliable network bandwidth. Once downloaded, the ISO can be mounted as a drive or burned to a DVD.Portuguese (Brazil) http://go.microsoft.com/fwlink/?LinkID=746941clcid=0x416Chinese (PRC) http://go.microsoft.com/fwlink/?LinkID=746941clcid=0x804German http://go.microsoft.com/fwlink/?LinkID=746941clcid=0x407English (United States) http://go.microsoft.com/fwlink/?LinkID=746941clcid=0x409Spanish http://go.microsoft.com/fwlink/?LinkID=746941clcid=0x40aFrench http://go.microsoft.com/fwlink/?LinkID=746941clcid=0x40cItalian http://go.microsoft.com/fwlink/?LinkID=746941clcid=0x410Japanese http://go.microsoft.com/fwlink/?LinkID=746941clcid=0x411Korean http://go.microsoft.com/fwlink/?LinkID=746941clcid=0x412Russian http://go.microsoft.com/fwlink/?LinkID=746941clcid=0x419Chinese (Taiwan) http://go.microsoft.com/fwlink/?LinkID=746941clcid=0x404'>SQL Server Data Tools Preview in Visual Studio 201</a>&nbsp;&nbsp;&nbsp;&nbsp;<span>16-4-5 上午 12:00:00</span></li><li><span>32</span>&nbsp;&nbsp;<a class='btn btn-link' style='color: blue' href='../../../../../Artlcle/vip/ECEBF400-1214-48CF-8CAC-F6AA951CB40B.html' title='using System;using System.Collections.Generic;using System.Linq;using System.Text;using System.Data.SqlClient;using System.Data;using System.Data.Common;namespace DAL{  public class DBHelper  {    /// summary    /// 根据SQL从数据库中读取对象集合    /// /summary    /// typeparam name=T/typeparam    /// param name=sqlSQL语句/param    /// param name=p参数集合/param    /// returns对象集合/returns    public static ListT ReadCollectionT(string sql, DynamicParameters p) where T : class    {      using (ConnService connService = new ConnService())      {        return connService.SqlConnection.QueryT(sql, p).ToListT();      }    }    /// summary    /// DataSet插入SAP数据库    /// /summary    /// param name=ds/param    /// returns/returns    public static int InsertDataSet(DataSet ds)    {      string sqlconnectionString = System.Configuration.ConfigurationManager.AppSettings[ConnString];      SqlConnection conn = new SqlConnection(sqlconnectionString);      string sql =  SELECT * FROM SAP;      DbCommand dbCommand = new SqlCommand(sql, conn);      DbDataAdapter adapter = new SqlDataAdapter((SqlCommand)dbCommand);      DbCommandBuilder cmbuilder = new SqlCommandBuilder((SqlDataAdapter)adapter);      return adapter.Update(ds, SAP);    }    public static void InsertDataDataTableSqlBulkCopy_SAP(DataTable dt)    {      string sqlconnectionString = System.Configuration.ConfigurationManager.AppSettings[ConnString];      using (SqlBulkCopy bulk = new SqlBulkCopy(sqlconnectionString))      {        bulk.BatchSize = 100000;        bulk.DestinationTableName = SAP;        bulk.ColumnMappings.Add(MaterialCode, MaterialCode);        bulk.ColumnMappings.Add(Plant, Plant);        bulk.ColumnMappings.Add(BatchNumber, BatchNumber);        bulk.ColumnMappings.Add(Quantity, Quantity);        bulk.ColumnMappings.Add(ScrapReason, ScrapReason);        bulk.WriteToServer(dt);      }    }    public static void InsertDataDataTableSqlBulkCopy_NPI(DataTable dt)    {      dt.Columns.Add(UnitPrice, typeof(string));      foreach (DataRow item in dt.Rows)      {        var Stock = item[54];        var CurrStockBUOM = item[23];        var UnitPrice = Convert.ToString(Math.Round(Convert.ToDecimal(Stock) / Convert.ToDecimal(CurrStockBUOM), 4));        item[UnitPrice] = UnitPrice.ToString();      }      string sqlconnectionString = System.Configuration.ConfigurationManager.AppSettings[ConnString];      using (SqlBulkCopy bulk = new SqlBulkCopy(sqlconnectionString))      {        bulk.BatchSize = 100000;        bulk.DestinationTableName = NPI;        bulk.ColumnMappings.Add(1, Plant);        bulk.ColumnMappings.Add(2, SupplyPlant);        bulk.ColumnMappings.Add(3, Material);        bulk.ColumnMappings.Add(4, MaterialDesc);        bulk.ColumnMappings.Add(5, BatchNumber);        bulk.ColumnMappings.Add(6, TargetMDO);        bulk.ColumnMappings.Add(7, NPIBucket);        bulk.ColumnMappings.Add(8, Subsector);        bulk.ColumnMappings.Add(9, Category);        bulk.ColumnMappings.Add(10, TDCVal);        bulk.ColumnMappings.Add(11, Currentlyworkedbygroup);        bulk.ColumnMappings.Add(12, PreviousOwner);        bulk.ColumnMappings.Add(13, Previouslyworkedbygroup);        bulk.ColumnMappings.Add(14, Currentaction);        bulk.ColumnMappings.Add(15, NextAction);        bulk.ColumnMappings.Add(16, NPIClassification);        bulk.ColumnMappings.Add(17, Rootcause);        bulk.ColumnMappings.Add(18, BlockClass1);        bulk.ColumnMappings.Add(19, BlockClass2);        bulk.ColumnMappings.Add(20, STOPSHIPDate);        bulk.ColumnMappings.Add(21, FirstApperanceDate);        bulk.ColumnMappings.Add(22, Endofshipmentdate);        bulk.ColumnMappings.Add(23, CurrStockBUOM);        bulk.ColumnMappings.Add(24, BUOMUnit);        bulk.ColumnMappings.Add(25, CurrStockLCUR);        bulk.ColumnMappings.Add(26, SellingCurrency);        bulk.ColumnMappings.Add(27, CaseSellingPrice_LCur_buom);        bulk.ColumnMappings.Add(28, SecondaryMarketDiscount);        bulk.ColumnMappings.Add(29, CaseListPrice_LCURR);        bulk.ColumnMappings.Add(30, NetListPrice_LCur_BUOM);        bulk.ColumnMappings.Add(31, ReworkCost);        bulk.ColumnMappings.Add(32, Fcast);        bulk.ColumnMappings.Add(33, Country);        bulk.ColumnMappings.Add(34, GeoGroup);        bulk.ColumnMappings.Add(35, AuthSellCtry);        bulk.ColumnMappings.Add(36, WEAcc);        bulk.ColumnMappings.Add(37, GlMatStatus);        bulk.ColumnMappings.Add(38, LocMatStatus);        bulk.ColumnMappings.Add(39, CaseGTIN);        bulk.ColumnMappings.Add(40, Sector);        bulk.ColumnMappings.Add(41, Brand);        bulk.ColumnMappings.Add(42, MRPDRPContr);        bulk.ColumnMappings.Add(43, GlForm);        bulk.ColumnMappings.Add(44, MatGroup);        bulk.ColumnMappings.Add(45, CSUIndicator);        bulk.ColumnMappings.Add(46, CustType);        bulk.ColumnMappings.Add(47, PTOProduct);        bulk.ColumnMappings.Add(48, CustPurpose);        bulk.ColumnMappings.Add(49, Currentlyworkedby);        bulk.ColumnMappings.Add(50, PublicNotes);        bulk.ColumnMappings.Add(51, PrivateNotes);        bulk.ColumnMappings.Add(52, ActionNote);        bulk.ColumnMappings.Add(53, BatchExpDate);        bulk.ColumnMappings.Add(54, Stock);        bulk.ColumnMappings.Add(55, TotalMaterialPlantFPC);        bulk.ColumnMappings.Add(56, TotalMaterialCountryFPC);        bulk.ColumnMappings.Add(57, Su);        bulk.ColumnMappings.Add(58, Vendor);        bulk.ColumnMappings.Add(59, Productversion);        bulk.ColumnMappings.Add(60, ProdSiteContr);        bulk.ColumnMappings.Add(61, PlantDescription);        bulk.ColumnMappings.Add(62, InboxCounter);        bulk.ColumnMappings.Add(63, InBucketCounter);        bulk.ColumnMappings.Add(64, RemnantDiscount);        bulk.ColumnMappings.Add(65, RTCIS);        bulk.ColumnMappings.Add(66, Steam);        bulk.ColumnMappings.Add(67, SteamDocSubmitted);        bulk.ColumnMappings.Add(68, APOLogNA);        bulk.ColumnMappings.Add(69, APOLogLA);        bulk.ColumnMappings.Add(70, APOLogEMEA);        bulk.ColumnMappings.Add(71, APOLogAS);        bulk.ColumnMappings.Add(72, ofBUOMCase);        bulk.ColumnMappings.Add(73, ofITCase);        bulk.ColumnMappings.Add(74, ofCases);        bulk.ColumnMappings.Add(75, ExtendedCaseSellingPrice);        bulk.ColumnMappings.Add(76, ErrorinRecord);        if (dt.Columns.Count  77)        {          bulk.ColumnMappings.Add(77, Ship_To_MDO);          bulk.ColumnMappings.Add(78, Sub_brand);          bulk.ColumnMappings.Add(79, Item_GTIN);          bulk.ColumnMappings.Add(80, Stop_ShipIndicator);          bulk.ColumnMappings.Add(81, Stop_Ship_Date_Source);          bulk.ColumnMappings.Add(82, Stop_Ship_Date_Final);          bulk.ColumnMappings.Add(83, Stop_Ship_Date_Manual);          bulk.ColumnMappings.Add(84, Stop_Ship_Extension);          bulk.ColumnMappings.Add(85, Confirmed_Stop_Ship_Extension);          bulk.ColumnMappings.Add(86, Steam_Approved);          bulk.ColumnMappings.Add(87, Std_Pallets);          bulk.ColumnMappings.Add(88, Disposal_Type);          bulk.ColumnMappings.Add(89, MOQ);          bulk.ColumnMappings.Add(90, Storage_Location);          bulk.ColumnMappings.Add(91, id);          bulk.ColumnMappings.Add(92, Error_in_Record);                 }        bulk.ColumnMappings.Add(UnitPrice, UnitPrice);        bulk.WriteToServer(dt);      }    }    public static void InsertDataDataTableSqlBulkCopy_ScrapForm(DataTable dt)    {      string sqlconnectionString = System.Configuration.ConfigurationManager.AppSettings[ConnString];      using (SqlBulkCopy bulk = new SqlBulkCopy(sqlconnectionString))      {        bulk.BatchSize = 1000;        bulk.DestinationTableName = DCSCRAPSOURCE;        bulk.ColumnMappings.Add(ID, ID);        bulk.ColumnMappings.Add(Materialcode, Materialcode);        bulk.ColumnMappings.Add(ChineseDescription, ChineseDescription);        bulk.ColumnMappings.Add(PartLotnumber, PartLotnumber);        bulk.ColumnMappings.Add(Location_DCOnly, Location_DCOnly);        bulk.ColumnMappings.Add(Location_Sorting, Location_Sorting);        bulk.ColumnMappings.Add(Quantity, Quantity);        bulk.ColumnMappings.Add(Uom, Uom);        bulk.ColumnMappings.Add(Unitprice_RMB, Unitprice_RMB);        bulk.ColumnMappings.Add(BookValue_RMB, BookValue_RMB);        bulk.ColumnMappings.Add(BookValue_USD, BookValue_USD);        bulk.ColumnMappings.Add(Scrappingreason, Scrappingreason);        bulk.ColumnMappings.Add(SupportingDocoument, SupportingDocoument);        bulk.ColumnMappings.Add(Remarks, Remarks);        bulk.ColumnMappings.Add(Plant, Plant);        bulk.ColumnMappings.Add(ApplicationNo, ApplicationNo);        bulk.ColumnMappings.Add(Note1_GBUConfirm, Note1_GBUConfirm);        bulk.ColumnMappings.Add(Note2, Note2);        bulk.ColumnMappings.Add(Note3, Note3);        bulk.WriteToServer(dt);      }    }    public static void InsertDataDataTableSqlBulkCopy_CompareScrap(DataTable dt)    {      dt.Columns.Add(VERSION,typeof(string));      string VERSION=DAL_History.GetNewVersion(DateTime.Now.ToString(yyyyMMdd));      foreach (DataRow item in dt.Rows)      {        item[VERSION] = VERSION;      }      string sqlconnectionString = System.Configuration.ConfigurationManager.AppSettings[ConnString];      using (SqlBulkCopy bulk = new SqlBulkCopy(sqlconnectionString))      {        bulk.BatchSize = 1000;        bulk.DestinationTableName = CompareScrap;        bulk.ColumnMappings.Add(ID, ID);        bulk.ColumnMappings.Add(Materialcode, Materialcode);        bulk.ColumnMappings.Add(ChineseDescription, ChineseDescription);        bulk.ColumnMappings.Add(PartLotnumber, PartLotnumber);        bulk.ColumnMappings.Add(Location_DCOnly, Location_DCOnly);        bulk.ColumnMappings.Add(Location_Sorting, Location_Sorting);        bulk.ColumnMappings.Add(Quantity, Quantity);        bulk.ColumnMappings.Add(Uom, Uom);        bulk.ColumnMappings.Add(Unitprice_RMB, Unitprice_RMB);        bulk.ColumnMappings.Add(BookValue_RMB, BookValue_RMB);        bulk.ColumnMappings.Add(BookValue_USD, BookValue_USD);        bulk.ColumnMappings.Add(Scrappingreason, Scrappingreason);        bulk.ColumnMappings.Add(SupportingDocoument, SupportingDocoument);        bulk.ColumnMappings.Add(Remarks, Remarks);        bulk.ColumnMappings.Add(Plant, Plant);        bulk.ColumnMappings.Add(ApplicationNo, ApplicationNo);        bulk.ColumnMappings.Add(Note1_GBUConfirm, Note1_GBUConfirm);        bulk.ColumnMappings.Add(Note2, Note2);        bulk.ColumnMappings.Add(Note3, Note3);        bulk.ColumnMappings.Add(VERSION, VERSION);        bulk.ColumnMappings.Add(Value, Value);        bulk.ColumnMappings.Add(ISAdded, ISAdded);        bulk.WriteToServer(dt);      }    }    /// summary    /// 根据存储过程从数据库中读取对象集合    /// /summary    /// typeparam name=T对象类型/typeparam    /// param name=procName存储过程名称/param    /// param name=p参数集合/param    /// returns对象集合/returns    public static ListT ReadCollectionBySPT(string procName, DynamicParameters p) where T : class    {      using (ConnService connService = new ConnService())      {        return connService.SqlConnection.QueryT(procName, p, commandType: CommandType.StoredProcedure).ToListT();      }    }    /// summary    /// 根据存储过程从数据库中读取对象集合    /// /summary    /// typeparam name=T对象类型/typeparam    /// param name=procName存储过程名称/param    /// param name=p参数集合/param    /// returns对象集合/returns    public static ListT ReadCollectionBySPT(string procName, ref DynamicParameters p) where T : class    {      using (ConnService connService = new ConnService())      {        return connService.SqlConnection.QueryT(procName, p, commandType: CommandType.StoredProcedure).ToListT();      }    }    /// summary    /// 根据SQL从数据库中读取对象    /// /summary    /// typeparam name=T对象类型/typeparam    /// param name=sqlSQL语句/param    /// param name=p参数集合/param    /// returns查询出的对象/returns    public static T ReadObjectT(string sql, DynamicParameters p) where T : class    {      using (ConnService connService = new ConnService())      {        return connService.SqlConnection.QueryT(sql, p).SingleOrDefaultT();      }    }    /// summary    /// 根据存储过程从数据库中读取对象    /// /summary    /// typeparam name=T对象类型/typeparam    /// param name=procName存储过程名称/param    /// param name=p参数集合/param    /// returns查询出的对象/returns    public static T ReadObjectBySPT(string procName, DynamicParameters p) where T : class    {      using (ConnService connService = new ConnService())      {        return connService.SqlConnection.QueryT(procName, p, commandType: CommandType.StoredProcedure).SingleOrDefaultT();      }    }    /// summary    /// 执行SQL语句    /// /summary    /// param name=sqlsql语句/param    /// param name=p参数集合/param    public static void ExcuteSQL(string sql, DynamicParameters p)    {      using (ConnService connService = new ConnService())      {        connService.SqlConnection.Execute(sql, p);      }    }    /// summary    /// 执行SQL语句    /// /summary    /// param name=sqlsql语句/param    /// param name=p参数集合/param    public static void CreateDataBase(string sql, DynamicParameters p)    {      using (Conn connService = new Conn())      {        connService.SqlConnection.Execute(sql, p);      }    }    public static int CreateDataBaseOrTable(string sql, DynamicParameters p, bool IsTable)    {      if (IsTable)      {        using (ConnService connService = new ConnService())        {          return connService.SqlConnection.Execute(sql, p);        }      }      else      {        using (Conn connService = new Conn())        {          return connService.SqlConnection.Execute(sql, p);        }      }    }    /// summary    /// 执行SQL语句    /// /summary    /// param name=sqlsql语句/param    /// param name=p参数集合/param    public static void ExcuteSQL(string sql, DynamicParameters p, ConnService connService, IDbTransaction transaction)    {      connService.SqlConnection.Execute(sql, p, transaction);    }    /// summary    /// 执行存储过程    /// /summary    /// param name=procName存储过程名称/param    /// param name=p参数集合/param    public static void ExcuteSP(string procName, DynamicParameters p)    {      using (ConnService connService = new ConnService())      {        connService.SqlConnection.Execute(procName, p, commandTimeout: 1800, commandType: CommandType.StoredProcedure);      }    }    /// summary    /// 查询单个返回值    /// /summary    /// param name=sqlsql语句/param    /// param name=p参数集合/param    /// returnsint型返回值/returns    public static int ExecuteScalar(string sql, DynamicParameters p)    {      using (ConnService connService = new ConnService())      {        return connService.SqlConnection.Queryint(sql, p).First();      }    }    /// summary    /// 查询单个返回值    /// /summary    /// param name=sqlsql语句/param    /// param name=p参数集合/param    /// returnsdecimal型返回值/returns    public static decimal ExecuteScalarDecimal(string sql, DynamicParameters p)    {      using (ConnService connService = new ConnService())      {        return connService.SqlConnection.Querydecimal(sql, p).First();      }    }    /// summary    /// 查询单个返回值    /// /summary    /// param name=sqlsql语句/param    /// param name=p参数集合/param    /// returnsfloat型返回值/returns    public static float ExecuteScalarfloat(string sql, DynamicParameters p)    {      using (ConnService connService = new ConnService())      {        return connService.SqlConnection.Queryfloat(sql, p).First();      }    }    /// summary    /// 查询字符串类型的单个返回值    /// /summary    /// param name=sqlsql语句/param    /// param name=p参数集合/param    /// returnsstring型返回值/returns    public static string ExecuteScalarString(string sql, DynamicParameters p)    {      using (ConnService connService = new ConnService())      {        return connService.SqlConnection.Querystring(sql, p).First();      }    }    /// summary    /// 查询单个返回值    /// /summary    /// param name=procName存储过程名称/param    /// param name=p参数集合/param    /// returnsint型返回值/returns    public static int ExecuteScalarBySP(string procName, DynamicParameters p)    {      using (ConnService connService = new ConnService())      {        return connService.SqlConnection.Queryint(procName, p).First();      }    }    /// summary    /// 将一个集合保存到数据库    /// /summary    /// typeparam name=T集合类型/typeparam    /// param name=sqlsql语句,示例 insert AUT_User (Name,Age) values(@Name, @Age)/param    /// param name=collection集合对象/param    public static void SaveCollectionT(string sql, IListT collection)    {      using (ConnService connService = new ConnService())      {        connService.SqlConnection.Execute(sql, collection, null, 1800);      }    }    /// summary    /// 将一个集合保存到数据库    /// /summary    /// typeparam name=T集合类型/typeparam    /// param name=sqlsql语句,示例 insert AUT_User (Name,Age) values(@Name, @Age)/param    /// param name=collection集合对象/param    public static void SaveCollectionT(string sql, IListT collection, ConnService connService, IDbTransaction transaction)    {      connService.SqlConnection.Execute(sql, collection, transaction);    }    /// summary    /// 判断数据库中是否存在该数据    /// /summary    /// param name=sqlsql语句/param    /// param name=p参数集合/param    /// returns存在返回 True/returns    public static bool Exists(string sql, DynamicParameters p)    {      int recordCount = 0;      using (ConnService connService = new ConnService())      {        recordCount = connService.SqlConnection.Queryint(sql, p).First();      }      return (recordCount  0) ? true : false;    }    /// summary    /// 根据SQL返回DataTable    /// /summary    /// param name=strSQL/param    /// param name=paras/param    /// param name=strTableName/param    /// returns/returns    public static DataTable GetDataTableFromSQL(string strSQL, ListSqlParameter paras = null, string strTableName = null)    {      using (ConnService objConn = new ConnService())      {        DataTable dt = new DataTable();        SqlDataAdapter da = new SqlDataAdapter();        SqlCommand cmd = new SqlCommand();        SqlConne'>DBHelper</a>&nbsp;&nbsp;&nbsp;&nbsp;<span>16-3-27 上午 12:00:00</span></li><li><span>33</span>&nbsp;&nbsp;<a class='btn btn-link' style='color: blue' href='../../../../../Artlcle/vip/3BD01325-4891-4011-A21A-02C5BDAA04F6.html' title=' public static void InsertDataDataTableSqlBulkCopy_ScrapForm(DataTable dt)    {      string sqlconnectionString = System.Configuration.ConfigurationManager.AppSettings[ConnString];      using (SqlBulkCopy bulk = new SqlBulkCopy(sqlconnectionString))      {        bulk.BatchSize = 1000;        bulk.DestinationTableName = DCSCRAPSOURCE;        bulk.ColumnMappings.Add(ID, ID);        bulk.ColumnMappings.Add(Materialcode, Materialcode);        bulk.ColumnMappings.Add(ChineseDescription, ChineseDescription);        bulk.ColumnMappings.Add(PartLotnumber, PartLotnumber);        bulk.ColumnMappings.Add(Location_DCOnly, Location_DCOnly);        bulk.ColumnMappings.Add(Location_Sorting, Location_Sorting);        bulk.ColumnMappings.Add(Quantity, Quantity);        bulk.ColumnMappings.Add(Uom, Uom);        bulk.ColumnMappings.Add(Unitprice_RMB, Unitprice_RMB);        bulk.ColumnMappings.Add(BookValue_RMB, BookValue_RMB);        bulk.ColumnMappings.Add(BookValue_USD, BookValue_USD);        bulk.ColumnMappings.Add(Scrappingreason, Scrappingreason);        bulk.ColumnMappings.Add(SupportingDocoument, SupportingDocoument);        bulk.ColumnMappings.Add(Remarks, Remarks);        bulk.ColumnMappings.Add(Plant, Plant);        bulk.ColumnMappings.Add(ApplicationNo, ApplicationNo);        bulk.ColumnMappings.Add(Note1_GBUConfirm, Note1_GBUConfirm);        bulk.ColumnMappings.Add(Note2, Note2);        bulk.ColumnMappings.Add(Note3, Note3);        bulk.WriteToServer(dt);      }    }'>Sql Server 秒速插入大批量数据SqlBulkCopy</a>&nbsp;&nbsp;&nbsp;&nbsp;<span>16-3-27 上午 12:00:00</span></li><li><span>34</span>&nbsp;&nbsp;<a class='btn btn-link' style='color: blue' href='../../../../../Artlcle/vip/23BCC06A-53BD-4FC4-9A1F-ED88FA20D76B.html' title='遇到这个问题就是指Web服务器并没有支持这种*.unity3d文件类型。需要做的是在Web服务器中添加MIME类型：IIS 7及以上版本：在功能视图的IIS选项卡中：双击打开MIME，选择添加：.unity3dapplication/octet-stream如果是IIS6，则右击计算机名，选择属性，找到MIME类型新建就OK啦！'>Unity 3D本地发布WebPlayer版时Failed to download data fil</a>&nbsp;&nbsp;&nbsp;&nbsp;<span>16-3-25 上午 12:00:00</span></li><li><span>35</span>&nbsp;&nbsp;<a class='btn btn-link' style='color: blue' href='../../../../../Artlcle/vip/0EB07182-637C-4C34-AD0C-106E9D0091DF.html' title='?xml version=1.0 encoding=utf-8 ?ConfigElemment HeaderText  text Name=Material Code    marke=MaterialCode     id=1001/  text Name=Chinese Description marke=ChineseDescription   id=1002/  text Name=PartLotnumber    marke=PartLotnumber     id=1003/  text Name=Location DC Only   marke=Location_DCOnly    id=1004/  text Name=Location Sorting  marke=Location_Sorting    id=1005/  text Name=Quantity      marke=Quantity        id=1006/  text Name=Uom         marke=Uom          id=1007/  text Name=Unitprice RMB    marke=Unitprice_RMB     id=1008/  text Name=BookValue RMB    marke=BookValue_RMB     id=1009/  text Name=BookValue USD    marke=BookValue_USD     id=1010/  text Name=Scrap ping reason   marke=Scrappingreason    id=1011/  text Name=Supporting Docoument marke=SupportingDocoument  id=1012/  text Name=Remarks       marke=Remarks        id=1013/  text Name=Plant        marke=Plant         id=1014/  text Name=Application No    marke=ApplicationNo     id=1015/  text Name=Note1 GBUConfirm  marke=Note1_GBUConfirm    id=1016/  text Name=Note2        marke=Note2         id=1017/  text Name=Note3        marke=Note3         id=1018/  text Name=VERSION       marke=VERSION        id=1019/  text Name=添加        marke=ISAdded        id=1020/ /HeaderText NPIHeaderText  text Name=Plant                marke=Plant                   id=2001/  text Name=SNPP                marke=SupplyPlant                id=2002/  text Name=Material              marke=Material                 id=2003/  text Name=Material Description        marke=MaterialDesc               id=2004/  text Name=Batch               marke=BatchNumber                id=2005/  text Name=Target MDO             marke=TargetMDO                 id=2006/  text Name=NPI Bucket             marke=NPIBucket                 id=2007/  text Name=Sub-sector             marke=Subsector                 id=2008/  text Name=Category              marke=Category                 id=2009/  text Name=TDCVAL               marke=TDCVal                  id=2010/  text Name=Currently worked by group      marke=Currentlyworkedbygroup          id=2011/  text Name=Previous Owner           marke=PreviousOwner               id=2012/  text Name=Previously worked by group     marke=Previouslyworkedbygroup          id=2013/  text Name=Action               marke=Currentaction               id=2014/  text Name=NextAction             marke=NextAction                id=2015/  text Name=NPI Reason             marke=NPIClassification             id=2016/  text Name=Rootcause              marke=Rootcause                 id=2017/  text Name=Block Class -1           marke=BlockClass1                id=2018/  text Name=Block Class2            marke=BlockClass2                id=2019/  text Name=Stop Ship Date           marke=STOPSHIPDate               id=2020/  text Name=In System Counter (days)      marke=FirstApperanceDate            id=2021/  text Name=Must Stop Ship By          marke=Endofshipmentdate             id=2022/  text Name=BUOM Stock(单位：CS)        marke=CurrStockBUOM               id=2023/  text Name=BUOM Name              marke=BUOMUnit                 id=2024/  text Name=Local Stock             marke=CurrStockLCUR               id=2025/  text Name=Cust. Currency           marke=SellingCurrency              id=2026/  text Name=Case Selling Price         marke=CaseSellingPrice_LCur_buom        id=2027/  text Name=Secondary Market Discount      marke=SecondaryMarketDiscount          id=2028/  text Name=CaseList Price LCURR        marke=CaseListPrice_LCURR            id=2029/  text Name=Net Price            marke=NetListPrice_LCur_BUOM          id=2030/  text Name=Rework Cost             marke=ReworkCost                id=2031/  text Name=Fcast                marke=Fcast                   id=2032/  text Name=Country               marke=Country                  id=2033/  text Name=GeoGroup              marke=GeoGroup                 id=2034/  text Name=Auth SellCtry            marke=AuthSellCtry               id=2035/  text Name=WEAcc                marke=WEAcc                   id=2036/  text Name=GlMat Status            marke=GlMatStatus                id=2037/  text Name=Loc Mat Status           marke=LocMatStatus               id=2038/  text Name=CaseGTIN              marke=CaseGTIN                 id=2039/  text Name=Sector               marke=Sector                  id=2040/  text Name=Brand                marke=Brand                   id=2041/  text Name=MRPDRPContr             marke=MRPDRPContr                id=2042/  text Name=GlForm               marke=GlForm                  id=2043/  text Name=MatGroup              marke=MatGroup                 id=2044/  text Name=CSUIndicator            marke=CSUIndicator               id=2045/  text Name=Cust Type              marke=CustType                 id=2046/  text Name=PTO Product             marke=PTOProduct                id=2047/  text Name=Cust Purpose            marke=CustPurpose                id=2048/  text Name=Currently worked by         marke=Currentlyworkedby             id=2049/  text Name=Public Notes            marke=PublicNotes                id=2050/  text Name=Private Notes            marke=PrivateNotes               id=2051/  text Name=Action Note             marke=ActionNote                id=2052/  text Name=BatchExp Date            marke=BatchExpDate               id=2053/  text Name=Stock $(单位：$)          marke=Stock                   id=2054/  text Name=Total Material Plant FPC      marke=TotalMaterialPlantFPC           id=2055/  text Name=Total MaterialCountry FPC      marke=TotalMaterialCountryFPC          id=2056/  text Name=SU                 marke=Su                    id=2057/  text Name=Vendor               marke=Vendor                  id=2058/  text Name=Product version           marke=Productversion              id=2059/  text Name=ProdSite Contr           marke=ProdSiteContr               id=2060/  text Name=Plant Description          marke=PlantDescription             id=2061/  text Name=Inbox Counter            marke=InboxCounter               id=2062/  text Name=In Bucket Counter          marke=InBucketCounter              id=2063/  text Name=Remnant Discount          marke=RemnantDiscount              id=2064/  text Name=RTCIS                marke=RTCIS                   id=2065/  text Name=Steam                marke=Steam                   id=2066/  text Name=Steam Doc Submitted         marke=SteamDocSubmitted             id=2067/  text Name=APOLog NA              marke=APOLogNA                 id=2068/  text Name=APOLog LA              marke=APOLogLA                 id=2069/  text Name=APOLog EMEA             marke=APOLogEMEA                id=2070/  text Name=APOLog AS              marke=APOLogAS                 id=2071/  text Name=of BUOM Case            marke=ofBUOMCase                id=2072/  text Name=of IT Case             marke=ofITCase                 id=2073/  text Name=of Cases              marke=ofCases                  id=2074/  text Name=Extended Case Selling Price     marke=ExtendedCaseSellingPrice         id=2075/  text Name=Errorin Record           marke=ErrorinRecord               id=2076/  text Name=Ship To MDO             marke=Ship_To_MDO                id=2077/  text Name=Item GTIN              marke=Item_GTIN                 id=2078/  text Name=Sub brand              marke=Sub_brand                 id=2079/  text Name=Stop ShipIndicator         marke=Stop_ShipIndicator            id=2080/  text Name=Stop Ship Date Source        marke=Stop_Ship_Date_Source           id=2081/  text Name=Stop Ship Date Final        marke=Stop_Ship_Date_Final           id=2082/  text Name=Stop Ship Date Manual        marke=Stop_Ship_Date_Manual           id=2083/  text Name=Stop Ship Extension         marke=Stop_Ship_Extension            id=2084/  text Name=Confirmed Stop Ship Extension    marke=Confirmed_Stop_Ship_Extension       id=2085/  text Name=Steam Approved           marke=Steam_Approved              id=2086/  text Name=Std Pallets             marke=Std_Pallets                id=2087/  text Name=Disposal Type            marke=Disposal_Type               id=2088/  text Name=MOQ                 marke=MOQ                    id=2089/  text Name=Storage Location          marke=Storage_Location             id=2090/  text Name=id                 marke=id                    id=2091/  text Name=Error in_Record           marke=Error_in_Record              id=2092/ /NPIHeaderText/ConfigElemment Menu  menu Name=Action                marke=Current action              id=1/  menu Name=Block Class -1            marke=Block Class -1              id=2/  menu Name=Quantity               marke=Quantity                 id=3/  menu Name=In Bucket Counter (days)       marke=In Bucket Counter (days)         id=4/  menu Name=View1                 marke=NPI查询按钮               id=5/  menu Name=New Filter              marke=NPI新增按钮               id=6/  menu Name=View                 marke=查询按钮                 id=7/  menu Name=NPI Compare Scrap Form        marke=NPI Compare Scrap Form按钮        id=8/  menu Name=Compare                marke=Compare按钮               id=9/  menu Name=Save                 marke=Save按钮                 id=10/  menu Name=Export                marke=Export按钮                id=11/ /Menu   public static string GetMenuText(int str)    {      try      {        string ConfigFile = Application.StartupPath + \\ConfigFiles\\SysConfig.xml;        //读取所有配置信息        XmlDocument doc = new XmlDocument();        doc.Load(ConfigFile);        //instances下所有instance节点        XmlNodeList DCintances = doc.SelectNodes(ConfigElemment/Menu/menu);        //遍历，放入缓存        for (int i = 0; i  DCintances.Count; i++)        {          string sf = DCintances[i].Attributes[id].Value;          if (sf == str.ToString())          {            return DCintances[i].Attributes[Name].Value;          }        }        return ;      }      catch      {        return null;      }    }     public static string GetMenuText(int str)   {      return XlmHelper.GetMenuText(str);    }         void BindText()    {      lbCurrentAction.Text = BLL_SysConfig.GetMenuText(1);      lbBlockClass1.Text = BLL_SysConfig.GetMenuText(2);      lbBlockClass2.Text = BLL_SysConfig.GetMenuText(2);      lbBlockClass3.Text = BLL_SysConfig.GetMenuText(2);      lbBlockClass4.Text = BLL_SysConfig.GetMenuText(2);      lbBlockClass5.Text = BLL_SysConfig.GetMenuText(2);      lbQuantity1.Text = BLL_SysConfig.GetMenuText(3);      lbQuantity2.Text = BLL_SysConfig.GetMenuText(3);      lbQuantity3.Text = BLL_SysConfig.GetMenuText(3);      lbQuantity4.Text = BLL_SysConfig.GetMenuText(3);      lbQuantity5.Text = BLL_SysConfig.GetMenuText(3);      lbDays1.Text = BLL_SysConfig.GetMenuText(4);      lbDays2.Text = BLL_SysConfig.GetMenuText(4);      lbDays3.Text = BLL_SysConfig.GetMenuText(4);      lbDays4.Text = BLL_SysConfig.GetMenuText(4);      lbDays5.Text = BLL_SysConfig.GetMenuText(4);      btnNpiView1.Text = BLL_SysConfig.GetMenuText(5);      btnNpiView2.Text = BLL_SysConfig.GetMenuText(5);      btnNpiView3.Text = BLL_SysConfig.GetMenuText(5);      btnNpiView4.Text = BLL_SysConfig.GetMenuText(5);      btnNpiView5.Text = BLL_SysConfig.GetMenuText(5);      btnNewFilter1.Text = BLL_SysConfig.GetMenuText(6);      btnNewFilter2.Text = BLL_SysConfig.GetMenuText(6);      btnNewFilter3.Text = BLL_SysConfig.GetMenuText(6);      btnNewFilter4.Text = BLL_SysConfig.GetMenuText(6);      btnSelectView.Text = BLL_SysConfig.GetMenuText(7);      btnNpiPKScrapForm.Text = BLL_SysConfig.GetMenuText(8);      btnCompare.Text = BLL_SysConfig.GetMenuText(9);      btnSave.Text = BLL_SysConfig.GetMenuText(10);      btnExport.Text = BLL_SysConfig.GetMenuText(11);    }  '>XML</a>&nbsp;&nbsp;&nbsp;&nbsp;<span>16-3-8 上午 12:00:00</span></li><li><span>36</span>&nbsp;&nbsp;<a class='btn btn-link' style='color: blue' href='../../../../../Artlcle/vip/280AF413-8F89-412F-8507-4A9A4A6C3023.html' title='  private void tabControlMain_DrawItem(object sender, DrawItemEventArgs e)    {      tabControlMain.Font = new Font(Calibri, 14);      SolidBrush BackBrush = new SolidBrush(Color.Blue);//标签背景填充颜色      Brush selected_color = Brushes.DimGray; //选中的项的背景色      SolidBrush FrontBrush = new SolidBrush(Color.White); //标签文字填充颜色      StringFormat StringF = new StringFormat();      StringF.Alignment = StringAlignment.Center; //设置文字对齐方式      StringF.LineAlignment = StringAlignment.Center;      Rectangle Rec = tabControlMain.GetTabRect(e.Index); //获取标签头工作区域      string title = tabControlMain.TabPages[e.Index].Text;      if (e.Index == this.tabControlMain.SelectedIndex)  //当前选中的Tab页，设置不同的样式以示选中      {        e.Graphics.FillRectangle(selected_color, Rec); //改变选项卡标签的背景色        e.Graphics.DrawString(title, new Font(Calibri,14), FrontBrush, Rec, StringF);//PointF选项卡标题的位置        // Rec.Offset(Rec.Width - iconWidth - 3, 2);      }      else//非选中的      {        e.Graphics.FillRectangle(BackBrush, Rec);//绘制标签头背景颜色        e.Graphics.DrawString(title, new Font(Calibri, 12), FrontBrush, Rec, StringF);//绘制标签头文字      }    }'>Winform tabControl选项页重写</a>&nbsp;&nbsp;&nbsp;&nbsp;<span>16-2-28 上午 12:00:00</span></li><li><span>37</span>&nbsp;&nbsp;<a class='btn btn-link' style='color: blue' href='../../../../../Artlcle/vip/557E285B-BB78-4931-9715-8D96AC90EA26.html' title='using System;using System.Windows.Forms;using BLL;using System.Collections.Generic;using System.Drawing;using System.Threading;namespace DCScrapTool{  public partial class ScrapFormImport : UserControl  {    Liststring list = new Liststring();    TabControl tabControlMain;    StatusStrip sspStatusBar;    public ScrapFormImport(TabControl tabControlMain)    {      InitializeComponent();      DataGridView.CheckForIllegalCrossThreadCalls = false;      this.tabControlMain = tabControlMain;      this.Dock = DockStyle.Fill;      Control[] ctrl = tabControlMain.Parent.Controls.Find(sspStatusBar, true);      if (ctrl.Length  1  ctrl[0].GetType().Name == StatusStrip)        sspStatusBar = (StatusStrip)ctrl[0];      dataGridView.DataSource = BLL_DCScrapSource.GetDataTableAll();    }    private Liststring GetPath()    {      OpenFileDialog dlg = new OpenFileDialog();      dlg.Filter = Excel files(*.xlsm)|*.xlsm;      dlg.Multiselect = true;      if (dlg.ShowDialog() == DialogResult.OK)      {        foreach (string FilePath in dlg.FileNames)        {          if (System.IO.Path.GetExtension(FilePath).ToLower() == .xlsm  !System.IO.Path.GetFileName(FilePath).ToLower().StartsWith(~$))          {            list.Add(FilePath);          }        }      }      return list;    }    private void Method(object sender)    {      StaticTool.Open(sender, pnStatus, ptrStatus, lbStatus);      BLL_DCScrapSource.ImportExcel(list);      dataGridView.DataSource = BLL_DCScrapSource.GetDataTableAll();      StaticTool.Close(pnStatus, ptrStatus, lbStatus);    }    /// summary    /// 关闭进度条    /// /summary    /// param name=pnStatus/param    /// param name=ptrStatus/param    /// param name=lbStatus/param    public void Close(Panel pnStatus, PictureBox ptrStatus, Label lbStatus)    {      try      {        pnStatus.Visible = false;        ptrStatus.Visible = false;        lbStatus.Visible = false;      }      catch (Exception)      {      }    }    /// summary    /// 打开进度条    /// /summary    /// param name=sender/param    /// param name=pnStatus/param    /// param name=ptrStatus/param    /// param name=lbStatus/param    public void Open(object sender, Panel pnStatus, PictureBox ptrStatus, Label lbStatus)    {      try      {        pnStatus.Visible = true;        ptrStatus.Visible = true;        lbStatus.Visible = true;        var Item = sender as Button;        //lbStatus.Text = Item.Text +  Loading...........;        lbStatus.Text =  Loading...;        lbStatus.ForeColor = Color.Blue;      }      catch (Exception)      {      }    }    /// summary    /// 发生异常显示异常    /// /summary    /// param name=Erro/param    /// param name=pnStatus/param    /// param name=ptrStatus/param    /// param name=lbStatus/param    public void Error(Exception Erro, Panel pnStatus, PictureBox ptrStatus, Label lbStatus)    {      try      {        pnStatus.Visible = true;        ptrStatus.Visible = false;        lbStatus.Visible = true;        lbStatus.Text =  Error Message: + Erro.Message;        lbStatus.ForeColor = Color.Blue;      }      catch (Exception)      {      }    }    private void btnImport_Click(object sender, EventArgs e)    {      try      {        list = new Liststring();        list = GetPath();        if (list.Count = 0)          return;        Thread thread = new Thread(Method);        thread.IsBackground = true;        thread.Start(sender);      }      catch (Exception es)      {        StaticTool.Error(es, pnStatus, ptrStatus, lbStatus);      }    }    private void dataGridView_RowPostPaint(object sender, DataGridViewRowPostPaintEventArgs e)    {      var dgv = sender as DataGridView;      if (dgv != null)      {        Rectangle rect = new Rectangle(e.RowBounds.Location.X, e.RowBounds.Location.Y, dgv.RowHeadersWidth - 4, e.RowBounds.Height);        TextRenderer.DrawText(e.Graphics, (e.RowIndex + 1).ToString(), dgv.RowHeadersDefaultCellStyle.Font, rect, dgv.RowHeadersDefaultCellStyle.ForeColor, TextFormatFlags.VerticalCenter | TextFormatFlags.Right);      }    }    /// summary    /// 按钮去背景透明    /// /summary    /// param name=btn/param    private void SetBtnStyle(Button btn)    {      btn.FlatStyle = FlatStyle.Flat;//样式       btn.ForeColor = Color.Blue;//前景       btn.BackColor = Color.Transparent;//去背景       btn.FlatAppearance.BorderSize = 0;//去边线       btn.FlatAppearance.MouseOverBackColor = Color.Transparent;//鼠标经过       btn.FlatAppearance.MouseDownBackColor = Color.Transparent;//鼠标按下       btn.FlatAppearance.BorderSize = 1;    }    private void ScrapFormImport_Load(object sender, EventArgs e)    {      SetBtnStyle(btnImport); StaticTool.Close(pnStatus, ptrStatus, lbStatus);      System.Windows.Forms.Control.CheckForIllegalCrossThreadCalls = false;    }  }}'>Winform 按钮背景透明，多线程 ，进度条显示关闭</a>&nbsp;&nbsp;&nbsp;&nbsp;<span>16-2-28 上午 12:00:00</span></li><li><span>38</span>&nbsp;&nbsp;<a class='btn btn-link' style='color: blue' href='../../../../../Artlcle/vip/1D7D0CEC-9914-4C49-895B-585996BEF763.html' title='private void button2_Click(object sender, EventArgs e)    {      SQLDMO.SQLServer oServer = new SQLDMO.SQLServer();      oServer.Connect(127.0.0.1, sa, sa);      SQLDMO._Database mydb = oServer.Databases.Item(lr, owner);      SQLDMO._Table myTable = mydb.Tables.Item(ArticleComment, dbo);      string s = myTable.Script(SQLDMO.SQLDMO_SCRIPT_TYPE.SQLDMOScript_Default, null, null, SQLDMO.SQLDMO_SCRIPT2_TYPE.SQLDMOScript2_Default);      oServer.DisConnect();      //Source.Text = s;    }    private void button3_Click(object sender, EventArgs e)    {      //引用SQLDMO.dll，SQLDMO由Microsoft SQL Server自带的SQLDMO.dll提供，SQLDMO.dll是一个COM对象       SQLDMO.Backup backup = new SQLDMO.Backup();      SQLDMO.SQLServer sqlserver = new SQLDMO.SQLServer();      sqlserver.LoginSecure = false;      sqlserver.Connect(localhost, sa, sa);      backup.Action = SQLDMO.SQLDMO_BACKUP_TYPE.SQLDMOBackup_Database;      backup.Database = lr;      backup.Files = @E:/DB/userdb.SQL;      backup.BackupSetName = userdb;      backup.BackupSetDescription = 数据库备份;      backup.Initialize = true;      backup.SQLBackup(sqlserver);     }'>C# SQLDMO获取sql Server指定表创建sql 和备份</a>&nbsp;&nbsp;&nbsp;&nbsp;<span>16-2-27 上午 12:00:00</span></li><li><span>39</span>&nbsp;&nbsp;<a class='btn btn-link' style='color: blue' href='../../../../../Artlcle/vip/1581F079-DE58-4355-AE76-2B569B5B8D11.html' title='using System;using System.Collections.Generic;using System.ComponentModel;using System.Data;using System.Drawing;using System.Linq;using System.Text;using System.Threading;using System.Threading.Tasks;using System.Windows.Forms;namespace WindowsFormsApplication3{  public partial class Form1 : Form  {    public Form1()    {      InitializeComponent();    }    private void test()    {      for (int i = 0; i  10000; i++)      {        System.Windows.Forms.Application.DoEvents();        label1.Text = i.ToString();      }      label1.Text = 执行完成;      pictureBox1.Visible = false;    }    private void button1_Click(object sender, EventArgs e)    {      Thread t = new Thread(new ThreadStart(test));      t.Start();    }    private void button1_MouseDown(object sender, MouseEventArgs e)    {      pictureBox1.Visible = true;    }    private void Form1_Load(object sender, EventArgs e)    {      DataTable tblDatas = new DataTable();      tblDatas.Columns.Add(Product, Type.GetType(System.String));      tblDatas.Rows.Add(new object[] { a1 });      tblDatas.Rows.Add(new object[] { a2 });      tblDatas.Rows.Add(new object[] { a3 });      tblDatas.Rows.Add(new object[] { a4 });      tblDatas.Rows.Add(new object[] { a5 });      DataGridViewComboBoxColumn combox = (DataGridViewComboBoxColumn)dataGridView1.Columns[Column3];      combox.ValueMember = Product;      combox.DisplayMember = Product;      combox.DataSource = tblDatas;    }    public void DataGridViewEnableCopy(DataGridView p_Data)    {      Clipboard.SetData(DataFormats.Text, p_Data.GetClipboardContent());    }    public void DataGridViewEnablePaste(DataGridView p_Data)    {      if (p_Data == null)        return;      p_Data.KeyDown += new KeyEventHandler(tolCopy_Click);      p_Data.KeyDown += new KeyEventHandler(dataGridView1_KeyDown);    }    /// summary    /// 剪切板处理,粘贴第一列，第二文本框默认值，第三列下拉框也是默认值    /// /summary    /// param name=p_Data/param    public void DataGirdViewCellPaste(DataGridView p_Data)    {      try      {        StringBuilder str = new StringBuilder();        string[] PublicArray = null;        string[] PublicArrayInsert = null;        string CopyValue = string.Empty;        CopyValue = Clipboard.GetText().Trim();        if (string.IsNullOrEmpty(CopyValue))          return;        PublicArray = CopyValue.Split(\r);        foreach (string line in PublicArray)        {          CopyValue = line.Trim();          if (string.IsNullOrEmpty(CopyValue))            return;          str.Append(CopyValue);          str.Append(ъ停售);          str.Append(ъa3);          CopyValue = str.ToString();          PublicArrayInsert = CopyValue.Split(ъ);          p_Data.Rows.Add(PublicArrayInsert);          str.Length = 0;        }      }      catch (Exception)      {      }    }    /// summary    /// Ctrl+V快捷键粘贴    /// /summary    /// param name=sender/param    /// param name=e/param    private void dataGridView1_KeyDown(object sender, KeyEventArgs e)    {      if (Control.ModifierKeys == Keys.Control  e.KeyCode == Keys.V)      {        if (sender != null  sender.GetType() == typeof(DataGridView))          DataGirdViewCellPaste((DataGridView)sender);      }    }    /// summary    /// 鼠标右键删除选中的全部行    /// /summary    /// param name=sender/param    /// param name=e/param    private void ToolStripMenuItemDelete_Click(object sender, EventArgs e)    {      ///删除选中的行      foreach (DataGridViewRow r in dataGridView1.SelectedRows)      {        if (!r.IsNewRow)        {          dataGridView1.Rows.Remove(r);        }      }    }    /// summary    /// 鼠标右键粘贴    /// /summary    /// param name=sender/param    /// param name=e/param    private void tolCopy_Click(object sender, EventArgs e)    {      DataGirdViewCellPaste(dataGridView1);    }  }}'>DataGirdView控件实现快捷键Ctrl+V粘贴 鼠标右键删除粘贴</a>&nbsp;&nbsp;&nbsp;&nbsp;<span>16-2-25 上午 12:00:00</span></li><li><span>40</span>&nbsp;&nbsp;<a class='btn btn-link' style='color: blue' href='../../../../../Artlcle/vip/EBD2F641-54FD-4531-B15C-A5402E77D4B1.html' title='C#实现WinForm下DataGridView控件的拷贝和粘贴2012年09月20日 综合 共 1955字 字号小中大评论关闭【概述】DataGridView控件应该是数据库应用系统最常用的控件之一，其方便性不言而喻的。往往用户在使用过程中会提出从DataGridView空间中拷贝数据或是向某个DataGridView控件粘贴数据的要求，下面用我的一种方法来实现这个要求，希望大家能提出更好的办法来。注意：粘贴这个方法只用与从Excel或是Word的表格向DataGridView控件粘贴数据，其它的暂时没有测试过。【从DataGridView控件拷贝数据】方法比较简单，控件已经为我们提供了剪贴板环境，调用即可，代码如下：以上代码在DataGridView控件上键入”Ctrl+C”时就可以执行COPY；publicvoidDataGridViewEnableCopy(DataGridViewp_Data){Clipboard.SetData(DataFormats.Text,p_Data.GetClipboardContent());}【向DataGridView控件粘贴数据】这个过程会比上面的复杂，思路：从剪贴板环境中获取已复制内容，假定都是表格数据，因此先分成若干行，然后每行在分成若干字段，最后执行DataGridView.Row.Add()方法来添加记录。代码如下：publicvoidDataGirdViewCellPaste(DataGridViewp_Data){try{//获取剪切板的内容，并按行分割stringpasteText=Clipboard.GetText();if(string.IsNullOrEmpty(pasteText))return;string[]lines=pasteText.Split(newchar[]{,});foreach(stringlineinlines){if(string.IsNullOrEmpty(line.Trim()))continue;//按Tab分割数据string[]vals=line.Split();p_Data.Rows.Add(vals);}}catch{//不处理}}  public void DataGirdViewCellPaste(DataGridView p_Data)    {      try      {        StringBuilder str = new StringBuilder();        string [] PublicArray=null;        string[] PublicArrayInsert = null;        string CopyValue = string.Empty;        CopyValue = Clipboard.GetText().Trim();        if (string.IsNullOrEmpty(CopyValue))          return;        PublicArray = CopyValue.Split(\r);        foreach (string line in PublicArray)        {          CopyValue = line.Trim();          if (string.IsNullOrEmpty(CopyValue))            return;          str.Append(CopyValue);          str.Append(ъ停售);          CopyValue = str.ToString();          PublicArrayInsert = CopyValue.Split(ъ);          p_Data.Rows.Add(PublicArrayInsert);          str.Length = 0;        }      }      catch(Exception)      {      }    }下面一个问题是何时调用如上代码，可以为DataGridView创建一个右键菜单来实现，这里我展示一个通过判断键入”Ctrl+V”时来调用。代码如下：publicvoidDataGridViewEnablePaste(DataGridViewp_Data){if(p_Data==null)return;p_Data.KeyDown+=newKeyEventHandler(p_Data_KeyDown);}publicvoidp_Data_KeyDown(objectsender,KeyEventArgse){if(Control.ModifierKeys==Keys.Controle.KeyCode==Keys.V){if(sender!=nullsender.GetType()==typeof(DataGridView))//调用上面的粘贴代码 DataGirdViewCellPaste((DataGridView)sender);}}'>C#实现WinForm下DataGridView控件的拷贝和粘贴</a>&nbsp;&nbsp;&nbsp;&nbsp;<span>16-2-25 上午 12:00:00</span></li><li><span>41</span>&nbsp;&nbsp;<a class='btn btn-link' style='color: blue' href='../../../../../Artlcle/vip/979BE66F-2943-4AB8-871A-4BDF8E87F7EE.html' title='在循环中加入System.Windows.Forms.Application.DoEvents();'>winform程序中防止程序假死</a>&nbsp;&nbsp;&nbsp;&nbsp;<span>16-2-23 上午 12:00:00</span></li><li><span>42</span>&nbsp;&nbsp;<a class='btn btn-link' style='color: blue' href='../../../../../Artlcle/vip/38E98FC9-C613-4754-A291-98C52FE41A9B.html' title='使用线程Thread的时候如果弹出“线程间操作无效:从不是创建控件“label1”的线程访问它。”怎么解决？？？这样：在load的时候添加System.Windows.Forms.Control.CheckForIllegalCrossThreadCalls=false;'>线程间操作无效: 从不是创建控件“label1”的线程访问它。</a>&nbsp;&nbsp;&nbsp;&nbsp;<span>16-2-23 上午 12:00:00</span></li><li><span>43</span>&nbsp;&nbsp;<a class='btn btn-link' style='color: blue' href='../../../../../Artlcle/vip/997F3454-46E3-48C9-8B34-ACEA9DD2F2E5.html' title='private void button1_Click(object sender, EventArgs e)    {      Thread t = new Thread(new ThreadStart(test));      t.Start();    }    private void button1_MouseDown(object sender, MouseEventArgs e)    {      pictureBox1.Visible = true;    }     private void test()    {      for (int i = 0; i  10000; i++)      {        System.Windows.Forms.Application.DoEvents();        label1.Text = i.ToString();      }      label1.Text = 执行完成;      pictureBox1.Visible = false;    }    private void Form1_Load(object sender, EventArgs e)    {      System.Windows.Forms.Control.CheckForIllegalCrossThreadCalls = false;    }'>Winform 防止界面假死，单击按钮启动图片精度条执行完消失</a>&nbsp;&nbsp;&nbsp;&nbsp;<span>16-2-23 上午 12:00:00</span></li><li><span>44</span>&nbsp;&nbsp;<a class='btn btn-link' style='color: blue' href='../../../../../Artlcle/vip/3FD5E63F-B1AD-4E11-B44B-17BE9F5A1D7F.html' title=' #region ========加密========    /// summary    /// 加密    /// /summary    /// param name=Text/param    /// returns/returns  public static string Encrypt(string Text)  {   return Encrypt(Text,MATICSOFT);  }  /// summary  /// 加密数据  /// /summary  /// param name=Text/param  /// param name=sKey/param  /// returns/returns  public static string Encrypt(string Text,string sKey)  {   DESCryptoServiceProvider des = new DESCryptoServiceProvider();   byte[] inputByteArray;   inputByteArray=Encoding.Default.GetBytes(Text);   des.Key = ASCIIEncoding.ASCII.GetBytes(System.Web.Security.FormsAuthentication.HashPasswordForStoringInConfigFile(sKey, md5).Substring(0, 8));   des.IV = ASCIIEncoding.ASCII.GetBytes(System.Web.Security.FormsAuthentication.HashPasswordForStoringInConfigFile(sKey, md5).Substring(0, 8));   System.IO.MemoryStream ms=new System.IO.MemoryStream();   CryptoStream cs=new CryptoStream(ms,des.CreateEncryptor(),CryptoStreamMode.Write);   cs.Write(inputByteArray,0,inputByteArray.Length);   cs.FlushFinalBlock();   StringBuilder ret=new StringBuilder();   foreach( byte b in ms.ToArray())   {    ret.AppendFormat({0:X2},b);   }   return ret.ToString();  }  #endregion    #region ========解密========     /// summary    /// 解密    /// /summary    /// param name=Text/param    /// returns/returns  public static string Decrypt(string Text)  {   return Decrypt(Text,MATICSOFT);  }  /// summary  /// 解密数据  /// /summary  /// param name=Text/param  /// param name=sKey/param  /// returns/returns  public static string Decrypt(string Text,string sKey)  {   DESCryptoServiceProvider des = new DESCryptoServiceProvider();   int len;   len=Text.Length/2;   byte[] inputByteArray = new byte[len];   int x,i;   for(x=0;xlen;x++)   {    i = Convert.ToInt32(Text.Substring(x * 2, 2), 16);    inputByteArray[x]=(byte)i;   }   des.Key = ASCIIEncoding.ASCII.GetBytes(System.Web.Security.FormsAuthentication.HashPasswordForStoringInConfigFile(sKey, md5).Substring(0, 8));   des.IV = ASCIIEncoding.ASCII.GetBytes(System.Web.Security.FormsAuthentication.HashPasswordForStoringInConfigFile(sKey, md5).Substring(0, 8));   System.IO.MemoryStream ms=new System.IO.MemoryStream();   CryptoStream cs=new CryptoStream(ms,des.CreateDecryptor(),CryptoStreamMode.Write);   cs.Write(inputByteArray,0,inputByteArray.Length);   cs.FlushFinalBlock();   return Encoding.Default.GetString(ms.ToArray());  }  #endregion'>加密/解密方法</a>&nbsp;&nbsp;&nbsp;&nbsp;<span>16-1-28 上午 12:00:00</span></li><li><span>45</span>&nbsp;&nbsp;<a class='btn btn-link' style='color: blue' href='../../../../../Artlcle/vip/2D94AD9A-C9BC-41A8-8CD9-FEBDC09DCC8A.html' title='using System;using System.Collections;using System.Collections.Specialized;using System.Data;using System.Configuration;using System.Data.SQLite;namespace Maticsoft.DBUtility{  /// summary  /// Copyright (C) 2011 Maticsoft  /// 数据访问基础类(基于SQLite)  /// 可以用户可以修改满足自己项目的需要。  /// /summary  public abstract class DbHelperSQLite  {    //数据库连接字符串(web.config来配置)，可以动态更改connectionString支持多数据库.      public static string connectionString = PubConstant.ConnectionString;    public DbHelperSQLite()    {    }    #region 公用方法       public static int GetMaxID(string FieldName, string TableName)    {      string strsql = select max( + FieldName + )+1 from  + TableName;      object obj = GetSingle(strsql);      if (obj == null)      {        return 1;      }      else      {        return int.Parse(obj.ToString());      }    }    public static bool Exists(string strSql)    {      object obj = GetSingle(strSql);      int cmdresult;      if ((Object.Equals(obj, null)) || (Object.Equals(obj, System.DBNull.Value)))      {        cmdresult = 0;      }      else      {        cmdresult = int.Parse(obj.ToString());      }      if (cmdresult == 0)      {        return false;      }      else      {        return true;      }    }    public static bool Exists(string strSql, params SQLiteParameter[] cmdParms)    {      object obj = GetSingle(strSql, cmdParms);      int cmdresult;      if ((Object.Equals(obj, null)) || (Object.Equals(obj, System.DBNull.Value)))      {        cmdresult = 0;      }      else      {        cmdresult = int.Parse(obj.ToString());      }      if (cmdresult == 0)      {        return false;      }      else      {        return true;      }    }       #endregion    #region 执行简单SQL语句    /// summary    /// 执行SQL语句，返回影响的记录数    /// /summary    /// param name=SQLStringSQL语句/param    /// returns影响的记录数/returns    public static int ExecuteSql(string SQLString)    {      using (SQLiteConnection connection = new SQLiteConnection(connectionString))      {        using (SQLiteCommand cmd = new SQLiteCommand(SQLString, connection))        {          try          {            connection.Open();            int rows = cmd.ExecuteNonQuery();            return rows;          }          catch (System.Data.SQLite.SQLiteException E)          {            connection.Close();            throw new Exception(E.Message);          }        }      }    }    /// summary    /// 执行多条SQL语句，实现数据库事务。    /// /summary    /// param name=SQLStringList多条SQL语句/param      public static void ExecuteSqlTran(ArrayList SQLStringList)    {      using (SQLiteConnection conn = new SQLiteConnection(connectionString))      {        conn.Open();        SQLiteCommand cmd = new SQLiteCommand();        cmd.Connection = conn;        SQLiteTransaction tx = conn.BeginTransaction();        cmd.Transaction = tx;        try        {          for (int n = 0; n  SQLStringList.Count; n++)          {            string strsql = SQLStringList[n].ToString();            if (strsql.Trim().Length  1)            {              cmd.CommandText = strsql;              cmd.ExecuteNonQuery();            }          }          tx.Commit();        }        catch (System.Data.SQLite.SQLiteException E)        {          tx.Rollback();          throw new Exception(E.Message);        }      }    }    /// summary    /// 执行带一个存储过程参数的的SQL语句。    /// /summary    /// param name=SQLStringSQL语句/param    /// param name=content参数内容,比如一个字段是格式复杂的文章，有特殊符号，可以通过这个方式添加/param    /// returns影响的记录数/returns    public static int ExecuteSql(string SQLString, string content)    {      using (SQLiteConnection connection = new SQLiteConnection(connectionString))      {        SQLiteCommand cmd = new SQLiteCommand(SQLString, connection);        SQLiteParameter myParameter = new SQLiteParameter(@content, DbType.String);        myParameter.Value = content;        cmd.Parameters.Add(myParameter);        try        {          connection.Open();          int rows = cmd.ExecuteNonQuery();          return rows;        }        catch (System.Data.SQLite.SQLiteException E)        {          throw new Exception(E.Message);        }        finally        {          cmd.Dispose();          connection.Close();        }      }    }    /// summary    /// 向数据库里插入图像格式的字段(和上面情况类似的另一种实例)    /// /summary    /// param name=strSQLSQL语句/param    /// param name=fs图像字节,数据库的字段类型为image的情况/param    /// returns影响的记录数/returns    public static int ExecuteSqlInsertImg(string strSQL, byte[] fs)    {      using (SQLiteConnection connection = new SQLiteConnection(connectionString))      {        SQLiteCommand cmd = new SQLiteCommand(strSQL, connection);        SQLiteParameter myParameter = new SQLiteParameter(@fs, DbType.Binary);        myParameter.Value = fs;        cmd.Parameters.Add(myParameter);        try        {          connection.Open();          int rows = cmd.ExecuteNonQuery();          return rows;        }        catch (System.Data.SQLite.SQLiteException E)        {          throw new Exception(E.Message);        }        finally        {          cmd.Dispose();          connection.Close();        }      }    }    /// summary    /// 执行一条计算查询结果语句，返回查询结果（object）。    /// /summary    /// param name=SQLString计算查询结果语句/param    /// returns查询结果（object）/returns    public static object GetSingle(string SQLString)    {      using (SQLiteConnection connection = new SQLiteConnection(connectionString))      {        using (SQLiteCommand cmd = new SQLiteCommand(SQLString, connection))        {          try          {            connection.Open();            object obj = cmd.ExecuteScalar();            if ((Object.Equals(obj, null)) || (Object.Equals(obj, System.DBNull.Value)))            {              return null;            }            else            {              return obj;            }          }          catch (System.Data.SQLite.SQLiteException e)          {            connection.Close();            throw new Exception(e.Message);          }        }      }    }    /// summary    /// 执行查询语句，返回SQLiteDataReader    /// /summary    /// param name=strSQL查询语句/param    /// returnsSQLiteDataReader/returns    public static SQLiteDataReader ExecuteReader(string strSQL)    {      SQLiteConnection connection = new SQLiteConnection(connectionString);      SQLiteCommand cmd = new SQLiteCommand(strSQL, connection);      try      {        connection.Open();        SQLiteDataReader myReader = cmd.ExecuteReader();        return myReader;      }      catch (System.Data.SQLite.SQLiteException e)      {        throw new Exception(e.Message);      }    }    /// summary    /// 执行查询语句，返回DataSet    /// /summary    /// param name=SQLString查询语句/param    /// returnsDataSet/returns    public static DataSet Query(string SQLString)    {      using (SQLiteConnection connection = new SQLiteConnection(connectionString))      {        DataSet ds = new DataSet();        try        {          connection.Open();          SQLiteDataAdapter command = new SQLiteDataAdapter(SQLString, connection);          command.Fill(ds, ds);        }        catch (System.Data.SQLite.SQLiteException ex)        {          throw new Exception(ex.Message);        }        return ds;      }    }    #endregion    #region 执行带参数的SQL语句    /// summary    /// 执行SQL语句，返回影响的记录数    /// /summary    /// param name=SQLStringSQL语句/param    /// returns影响的记录数/returns    public static int ExecuteSql(string SQLString, params SQLiteParameter[] cmdParms)    {      using (SQLiteConnection connection = new SQLiteConnection(connectionString))      {        using (SQLiteCommand cmd = new SQLiteCommand())        {          try          {            PrepareCommand(cmd, connection, null, SQLString, cmdParms);            int rows = cmd.ExecuteNonQuery();            cmd.Parameters.Clear();            return rows;          }          catch (System.Data.SQLite.SQLiteException E)          {            throw new Exception(E.Message);          }        }      }    }    /// summary    /// 执行多条SQL语句，实现数据库事务。    /// /summary    /// param name=SQLStringListSQL语句的哈希表（key为sql语句，value是该语句的SQLiteParameter[]）/param    public static void ExecuteSqlTran(Hashtable SQLStringList)    {      using (SQLiteConnection conn = new SQLiteConnection(connectionString))      {        conn.Open();        using (SQLiteTransaction trans = conn.BeginTransaction())        {          SQLiteCommand cmd = new SQLiteCommand();          try          {            //循环            foreach (DictionaryEntry myDE in SQLStringList)            {              string cmdText = myDE.Key.ToString();              SQLiteParameter[] cmdParms = (SQLiteParameter[])myDE.Value;              PrepareCommand(cmd, conn, trans, cmdText, cmdParms);              int val = cmd.ExecuteNonQuery();              cmd.Parameters.Clear();              trans.Commit();            }          }          catch          {            trans.Rollback();            throw;          }        }      }    }    /// summary    /// 执行一条计算查询结果语句，返回查询结果（object）。    /// /summary    /// param name=SQLString计算查询结果语句/param    /// returns查询结果（object）/returns    public static object GetSingle(string SQLString, params SQLiteParameter[] cmdParms)    {      using (SQLiteConnection connection = new SQLiteConnection(connectionString))      {        using (SQLiteCommand cmd = new SQLiteCommand())        {          try          {            PrepareCommand(cmd, connection, null, SQLString, cmdParms);            object obj = cmd.ExecuteScalar();            cmd.Parameters.Clear();            if ((Object.Equals(obj, null)) || (Object.Equals(obj, System.DBNull.Value)))            {              return null;            }            else            {              return obj;            }          }          catch (System.Data.SQLite.SQLiteException e)          {            throw new Exception(e.Message);          }        }      }    }    /// summary    /// 执行查询语句，返回SQLiteDataReader    /// /summary    /// param name=strSQL查询语句/param    /// returnsSQLiteDataReader/returns    public static SQLiteDataReader ExecuteReader(string SQLString, params SQLiteParameter[] cmdParms)    {      SQLiteConnection connection = new SQLiteConnection(connectionString);      SQLiteCommand cmd = new SQLiteCommand();      try      {        PrepareCommand(cmd, connection, null, SQLString, cmdParms);        SQLiteDataReader myReader = cmd.ExecuteReader();        cmd.Parameters.Clear();        return myReader;      }      catch (System.Data.SQLite.SQLiteException e)      {        throw new Exception(e.Message);      }    }    /// summary    /// 执行查询语句，返回DataSet    /// /summary    /// param name=SQLString查询语句/param    /// returnsDataSet/returns    public static DataSet Query(string SQLString, params SQLiteParameter[] cmdParms)    {      using (SQLiteConnection connection = new SQLiteConnection(connectionString))      {        SQLiteCommand cmd = new SQLiteCommand();        PrepareCommand(cmd, connection, null, SQLString, cmdParms);        using (SQLiteDataAdapter da = new SQLiteDataAdapter(cmd))        {          DataSet ds = new DataSet();          try          {            da.Fill(ds, ds);            cmd.Parameters.Clear();          }          catch (System.Data.SQLite.SQLiteException ex)          {            throw new Exception(ex.Message);          }          return ds;        }      }    }    private static void PrepareCommand(SQLiteCommand cmd, SQLiteConnection conn, SQLiteTransaction trans, string cmdText, SQLiteParameter[] cmdParms)    {      if (conn.State != ConnectionState.Open)        conn.Open();      cmd.Connection = conn;      cmd.CommandText = cmdText;      if (trans != null)        cmd.Transaction = trans;      cmd.CommandType = CommandType.Text;//cmdType;      if (cmdParms != null)      {        foreach (SQLiteParameter parm in cmdParms)          cmd.Parameters.Add(parm);      }    }    #endregion   }}'>DbHelperSQLite</a>&nbsp;&nbsp;&nbsp;&nbsp;<span>16-1-28 上午 12:00:00</span></li><li><span>46</span>&nbsp;&nbsp;<a class='btn btn-link' style='color: blue' href='../../../../../Artlcle/vip/499A96C1-D480-4D5F-8B4C-FF8A973C97CA.html' title=' /// summary /// RSA加密解密及RSA签名和验证 /// /summary public class RSACryption {     public RSACryption()  {      }    #region RSA 加密解密  #region RSA 的密钥产生   /// summary  /// RSA 的密钥产生 产生?皆?和公钥  /// /summary  /// param name=xmlKeys/param  /// param name=xmlPublicKey/param  public void RSAKey(out string xmlKeys,out string xmlPublicKey)  {        System.Security.Cryptography.RSACryptoServiceProvider rsa=new RSACryptoServiceProvider();    xmlKeys=rsa.ToXmlString(true);    xmlPublicKey = rsa.ToXmlString(false);      }  #endregion  #region RSA的加密函数  //##############################################################################  //RSA 方式加密  //说明KEY必须是XML的行式,返回的是字符串  //在有一点需要说明！！该加密方式有 长度 限制的！！  //##############################################################################  //RSA的加密函数 string  public string RSAEncrypt(string xmlPublicKey,string m_strEncryptString )  {      byte[] PlainTextBArray;   byte[] CypherTextBArray;   string Result;   RSACryptoServiceProvider rsa=new RSACryptoServiceProvider();   rsa.FromXmlString(xmlPublicKey);   PlainTextBArray = (new UnicodeEncoding()).GetBytes(m_strEncryptString);   CypherTextBArray = rsa.Encrypt(PlainTextBArray, false);   Result=Convert.ToBase64String(CypherTextBArray);   return Result;     }  //RSA的加密函数 byte[]  public string RSAEncrypt(string xmlPublicKey,byte[] EncryptString )  {      byte[] CypherTextBArray;   string Result;   RSACryptoServiceProvider rsa=new RSACryptoServiceProvider();   rsa.FromXmlString(xmlPublicKey);   CypherTextBArray = rsa.Encrypt(EncryptString, false);   Result=Convert.ToBase64String(CypherTextBArray);   return Result;     }  #endregion  #region RSA的解密函数  //RSA的解密函数 string  public string RSADecrypt(string xmlPrivateKey, string m_strDecryptString )  {      byte[] PlainTextBArray;   byte[] DypherTextBArray;   string Result;   System.Security.Cryptography.RSACryptoServiceProvider rsa=new RSACryptoServiceProvider();   rsa.FromXmlString(xmlPrivateKey);   PlainTextBArray =Convert.FromBase64String(m_strDecryptString);   DypherTextBArray=rsa.Decrypt(PlainTextBArray, false);   Result=(new UnicodeEncoding()).GetString(DypherTextBArray);   return Result;     }  //RSA的解密函数 byte  public string RSADecrypt(string xmlPrivateKey, byte[] DecryptString )  {      byte[] DypherTextBArray;   string Result;   System.Security.Cryptography.RSACryptoServiceProvider rsa=new RSACryptoServiceProvider();   rsa.FromXmlString(xmlPrivateKey);   DypherTextBArray=rsa.Decrypt(DecryptString, false);   Result=(new UnicodeEncoding()).GetString(DypherTextBArray);   return Result;     }  #endregion  #endregion  #region RSA数字签名  #region 获取Hash描述表  //获取Hash描述表  public bool GetHash(string m_strSource, ref byte[] HashData)  {       //从字符串中取得Hash描述   byte[] Buffer;   System.Security.Cryptography.HashAlgorithm MD5 = System.Security.Cryptography.HashAlgorithm.Create(MD5);   Buffer = System.Text.Encoding.GetEncoding(GB2312).GetBytes(m_strSource);   HashData = MD5.ComputeHash(Buffer);   return true;      }  //获取Hash描述表  public bool GetHash(string m_strSource, ref string strHashData)  {      //从字符串中取得Hash描述   byte[] Buffer;   byte[] HashData;   System.Security.Cryptography.HashAlgorithm MD5 = System.Security.Cryptography.HashAlgorithm.Create(MD5);   Buffer = System.Text.Encoding.GetEncoding(GB2312).GetBytes(m_strSource);   HashData = MD5.ComputeHash(Buffer);   strHashData = Convert.ToBase64String(HashData);   return true;     }  //获取Hash描述表  public bool GetHash(System.IO.FileStream objFile, ref byte[] HashData)  {      //从文件中取得Hash描述   System.Security.Cryptography.HashAlgorithm MD5 = System.Security.Cryptography.HashAlgorithm.Create(MD5);   HashData = MD5.ComputeHash(objFile);   objFile.Close();   return true;     }  //获取Hash描述表  public bool GetHash(System.IO.FileStream objFile, ref string strHashData)  {      //从文件中取得Hash描述   byte[] HashData;   System.Security.Cryptography.HashAlgorithm MD5 = System.Security.Cryptography.HashAlgorithm.Create(MD5);   HashData = MD5.ComputeHash(objFile);   objFile.Close();   strHashData = Convert.ToBase64String(HashData);   return true;     }  #endregion  #region RSA签名  //RSA签名  public bool SignatureFormatter(string p_strKeyPrivate, byte[] HashbyteSignature, ref byte[] EncryptedSignatureData)  {       System.Security.Cryptography.RSACryptoServiceProvider RSA = new System.Security.Cryptography.RSACryptoServiceProvider();    RSA.FromXmlString(p_strKeyPrivate);    System.Security.Cryptography.RSAPKCS1SignatureFormatter RSAFormatter = new System.Security.Cryptography.RSAPKCS1SignatureFormatter(RSA);    //设置签名的算法为MD5    RSAFormatter.SetHashAlgorithm(MD5);    //执行签名    EncryptedSignatureData = RSAFormatter.CreateSignature(HashbyteSignature);    return true;     }  //RSA签名  public bool SignatureFormatter(string p_strKeyPrivate, byte[] HashbyteSignature, ref string m_strEncryptedSignatureData)  {       byte[] EncryptedSignatureData;    System.Security.Cryptography.RSACryptoServiceProvider RSA = new System.Security.Cryptography.RSACryptoServiceProvider();    RSA.FromXmlString(p_strKeyPrivate);    System.Security.Cryptography.RSAPKCS1SignatureFormatter RSAFormatter = new System.Security.Cryptography.RSAPKCS1SignatureFormatter(RSA);    //设置签名的算法为MD5    RSAFormatter.SetHashAlgorithm(MD5);    //执行签名    EncryptedSignatureData = RSAFormatter.CreateSignature(HashbyteSignature);    m_strEncryptedSignatureData = Convert.ToBase64String(EncryptedSignatureData);    return true;     }  //RSA签名  public bool SignatureFormatter(string p_strKeyPrivate, string m_strHashbyteSignature, ref byte[] EncryptedSignatureData)  {       byte[] HashbyteSignature;    HashbyteSignature = Convert.FromBase64String(m_strHashbyteSignature);    System.Security.Cryptography.RSACryptoServiceProvider RSA = new System.Security.Cryptography.RSACryptoServiceProvider();    RSA.FromXmlString(p_strKeyPrivate);    System.Security.Cryptography.RSAPKCS1SignatureFormatter RSAFormatter = new System.Security.Cryptography.RSAPKCS1SignatureFormatter(RSA);    //设置签名的算法为MD5    RSAFormatter.SetHashAlgorithm(MD5);    //执行签名    EncryptedSignatureData = RSAFormatter.CreateSignature(HashbyteSignature);    return true;     }  //RSA签名  public bool SignatureFormatter(string p_strKeyPrivate, string m_strHashbyteSignature, ref string m_strEncryptedSignatureData)  {       byte[] HashbyteSignature;    byte[] EncryptedSignatureData;    HashbyteSignature = Convert.FromBase64String(m_strHashbyteSignature);    System.Security.Cryptography.RSACryptoServiceProvider RSA = new System.Security.Cryptography.RSACryptoServiceProvider();    RSA.FromXmlString(p_strKeyPrivate);    System.Security.Cryptography.RSAPKCS1SignatureFormatter RSAFormatter = new System.Security.Cryptography.RSAPKCS1SignatureFormatter(RSA);    //设置签名的算法为MD5    RSAFormatter.SetHashAlgorithm(MD5);    //执行签名    EncryptedSignatureData = RSAFormatter.CreateSignature(HashbyteSignature);    m_strEncryptedSignatureData = Convert.ToBase64String(EncryptedSignatureData);    return true;     }  #endregion  #region RSA 签名验证  public bool SignatureDeformatter(string p_strKeyPublic, byte[] HashbyteDeformatter, byte[] DeformatterData)  {       System.Security.Cryptography.RSACryptoServiceProvider RSA = new System.Security.Cryptography.RSACryptoServiceProvider();    RSA.FromXmlString(p_strKeyPublic);    System.Security.Cryptography.RSAPKCS1SignatureDeformatter RSADeformatter = new System.Security.Cryptography.RSAPKCS1SignatureDeformatter(RSA);    //指定解密的时候HASH算法为MD5    RSADeformatter.SetHashAlgorithm(MD5);    if(RSADeformatter.VerifySignature(HashbyteDeformatter,DeformatterData))    {     return true;    }    else    {     return false;    }     }  public bool SignatureDeformatter(string p_strKeyPublic, string p_strHashbyteDeformatter, byte[] DeformatterData)  {       byte[] HashbyteDeformatter;    HashbyteDeformatter = Convert.FromBase64String(p_strHashbyteDeformatter);    System.Security.Cryptography.RSACryptoServiceProvider RSA = new System.Security.Cryptography.RSACryptoServiceProvider();    RSA.FromXmlString(p_strKeyPublic);    System.Security.Cryptography.RSAPKCS1SignatureDeformatter RSADeformatter = new System.Security.Cryptography.RSAPKCS1SignatureDeformatter(RSA);    //指定解密的时候HASH算法为MD5    RSADeformatter.SetHashAlgorithm(MD5);    if(RSADeformatter.VerifySignature(HashbyteDeformatter,DeformatterData))    {     return true;    }    else    {     return false;    }     }  public bool SignatureDeformatter(string p_strKeyPublic, byte[] HashbyteDeformatter, string p_strDeformatterData)  {       byte[] DeformatterData;    System.Security.Cryptography.RSACryptoServiceProvider RSA = new System.Security.Cryptography.RSACryptoServiceProvider();    RSA.FromXmlString(p_strKeyPublic);    System.Security.Cryptography.RSAPKCS1SignatureDeformatter RSADeformatter = new System.Security.Cryptography.RSAPKCS1SignatureDeformatter(RSA);    //指定解密的时候HASH算法为MD5    RSADeformatter.SetHashAlgorithm(MD5);    DeformatterData =Convert.FromBase64String(p_strDeformatterData);    if(RSADeformatter.VerifySignature(HashbyteDeformatter,DeformatterData))    {     return true;    }    else    {     return false;    }     }  public bool SignatureDeformatter(string p_strKeyPublic, string p_strHashbyteDeformatter, string p_strDeformatterData)  {       byte[] DeformatterData;    byte[] HashbyteDeformatter;    HashbyteDeformatter = Convert.FromBase64String(p_strHashbyteDeformatter);    System.Security.Cryptography.RSACryptoServiceProvider RSA = new System.Security.Cryptography.RSACryptoServiceProvider();    RSA.FromXmlString(p_strKeyPublic);    System.Security.Cryptography.RSAPKCS1SignatureDeformatter RSADeformatter = new System.Security.Cryptography.RSAPKCS1SignatureDeformatter(RSA);    //指定解密的时候HASH算法为MD5    RSADeformatter.SetHashAlgorithm(MD5);    DeformatterData =Convert.FromBase64String(p_strDeformatterData);    if(RSADeformatter.VerifySignature(HashbyteDeformatter,DeformatterData))    {     return true;    }    else    {     return false;    }     }  #endregion  #endregion }'>RSA加密解密及RSA签名和验证</a>&nbsp;&nbsp;&nbsp;&nbsp;<span>16-1-28 上午 12:00:00</span></li><li><span>47</span>&nbsp;&nbsp;<a class='btn btn-link' style='color: blue' href='../../../../../Artlcle/vip/16AF8FB0-F10E-4AE8-B384-143392A740A2.html' title='  /// /summary    /// param name=num金额/param    /// returns返回大写形式/returns    public static string CmycurD(decimal num)    {      string str1 = 零壹贰叁肆伍陆柒捌玖;      //0-9所对应的汉字      string str2 = 万仟佰拾亿仟佰拾万仟佰拾元角分; //数字位所对应的汉字      string str3 = ;  //从原num值中取出的值      string str4 = ;  //数字的字符串形式      string str5 = ; //人民币大写金额形式      int i;  //循环变量      int j;  //num的值乘以100的字符串长度      string ch1 = ;  //数字的汉语读法      string ch2 = ;  //数字位的汉字读法      int nzero = 0; //用来计算连续的零值是几个      int temp;      //从原num值中取出的值      num = Math.Round(Math.Abs(num), 2);  //将num取绝对值并四舍五入取2位小数      str4 = ((long)(num * 100)).ToString();    //将num乘100并转换成字符串形式      j = str4.Length;   //找出最高位      if (j  15) { return 溢出; }      str2 = str2.Substring(15 - j);  //取出对应位数的str2的值。如：200.55,j为5所以str2=佰拾元角分      //循环取出每一位需要转换的值      for (i = 0; i  j; i++)      {        str3 = str4.Substring(i, 1);     //取出需转换的某一位的值        temp = Convert.ToInt32(str3);   //转换为数字        if (i != (j - 3)  i != (j - 7)  i != (j - 11)  i != (j - 15))        {          //当所取位数不为元、万、亿、万亿上的数字时          if (str3 == 0)          {            ch1 = ;            ch2 = ;            nzero = nzero + 1;          }          else          {            if (str3 != 0  nzero != 0)            {              ch1 = 零 + str1.Substring(temp * 1, 1);              ch2 = str2.Substring(i, 1);              nzero = 0;            }            else            {              ch1 = str1.Substring(temp * 1, 1);              ch2 = str2.Substring(i, 1);              nzero = 0;            }          }        }        else        {          //该位是万亿，亿，万，元位等关键位          if (str3 != 0  nzero != 0)          {            ch1 = 零 + str1.Substring(temp * 1, 1);            ch2 = str2.Substring(i, 1);            nzero = 0;          }          else          {            if (str3 != 0  nzero == 0)            {              ch1 = str1.Substring(temp * 1, 1);              ch2 = str2.Substring(i, 1);              nzero = 0;            }            else            {              if (str3 == 0  nzero = 3)              {                ch1 = ;                ch2 = ;                nzero = nzero + 1;              }              else              {                if (j = 11)                {                  ch1 = ;                  nzero = nzero + 1;                }                else                {                  ch1 = ;                  ch2 = str2.Substring(i, 1);                  nzero = nzero + 1;                }              }            }          }        }        if (i == (j - 11) || i == (j - 3))        {          //如果该位是亿位或元位，则必须写上          ch2 = str2.Substring(i, 1);        }        str5 = str5 + ch1 + ch2;        if (i == j - 1  str3 == 0)        {          //最后一位（分）为0时，加上“整”          str5 = str5 + 整;        }      }      if (num == 0)      {        str5 = 零元整;      }      return str5;    }'>转换人民币大写金额</a>&nbsp;&nbsp;&nbsp;&nbsp;<span>16-1-28 上午 12:00:00</span></li><li><span>48</span>&nbsp;&nbsp;<a class='btn btn-link' style='color: blue' href='../../../../../Artlcle/vip/2495F5A3-20A3-4AE3-B4DC-3DC026914868.html' title=' public class TimeParser  {    /// summary    /// 把秒转换成分钟    /// /summary    /// returns/returns    public static int SecondToMinute(int Second)    {      decimal mm = (decimal)((decimal)Second / (decimal)60);      return Convert.ToInt32(Math.Ceiling(mm));         }    #region 返回某年某月最后一天    /// summary    /// 返回某年某月最后一天    /// /summary    /// param name=year年份/param    /// param name=month月份/param    /// returns日/returns    public static int GetMonthLastDate(int year, int month)    {      DateTime lastDay = new DateTime(year, month, new System.Globalization.GregorianCalendar().GetDaysInMonth(year, month));      int Day = lastDay.Day;      return Day;    }    #endregion    #region 返回时间差    public static string DateDiff(DateTime DateTime1, DateTime DateTime2)    {      string dateDiff = null;      try      {        //TimeSpan ts1 = new TimeSpan(DateTime1.Ticks);        //TimeSpan ts2 = new TimeSpan(DateTime2.Ticks);        //TimeSpan ts = ts1.Subtract(ts2).Duration();        TimeSpan ts = DateTime2 - DateTime1;        if (ts.Days =1)        {          dateDiff = DateTime1.Month.ToString() + 月 + DateTime1.Day.ToString() + 日;        }        else        {          if (ts.Hours  1)          {            dateDiff = ts.Hours.ToString() + 小时前;          }          else          {            dateDiff = ts.Minutes.ToString() + 分钟前;          }        }      }      catch      { }      return dateDiff;    }    #endregion  }'>时间处理方法</a>&nbsp;&nbsp;&nbsp;&nbsp;<span>16-1-28 上午 12:00:00</span></li><li><span>49</span>&nbsp;&nbsp;<a class='btn btn-link' style='color: blue' href='../../../../../Artlcle/vip/F02A3EA3-4F59-4193-B7E3-20469D94D1E9.html' title='using System;using System.Collections;using System.Collections.Specialized;using System.Data;using System.Data.SqlClient;using System.Configuration;using System.Data.Common;using System.Collections.Generic;namespace Maticsoft.DBUtility{  /// summary  /// 数据访问抽象基础类  /// Copyright (C) Maticsoft  /// /summary  public abstract class DbHelperSQL  {    //数据库连接字符串(web.config来配置)，多数据库可使用DbHelperSQLP来实现.    public static string connectionString = PubConstant.ConnectionString;         public DbHelperSQL()    {          }    #region 公用方法    /// summary    /// 判断是否存在某表的某个字段    /// /summary    /// param name=tableName表名称/param    /// param name=columnName列名称/param    /// returns是否存在/returns    public static bool ColumnExists(string tableName, string columnName)    {      string sql = select count(1) from syscolumns where [id]=object_id( + tableName + ) and [name]= + columnName + ;      object res = GetSingle(sql);      if (res == null)      {        return false;      }      return Convert.ToInt32(res)  0;    }    public static int GetMaxID(string FieldName, string TableName)    {      string strsql = select max( + FieldName + )+1 from  + TableName;      object obj = GetSingle(strsql);      if (obj == null)      {        return 1;      }      else      {        return int.Parse(obj.ToString());      }    }    public static bool Exists(string strSql)    {      object obj = GetSingle(strSql);      int cmdresult;      if ((Object.Equals(obj, null)) || (Object.Equals(obj, System.DBNull.Value)))      {        cmdresult = 0;      }      else      {        cmdresult = int.Parse(obj.ToString());      }      if (cmdresult == 0)      {        return false;      }      else      {        return true;      }    }    /// summary    /// 表是否存在    /// /summary    /// param name=TableName/param    /// returns/returns    public static bool TabExists(string TableName)    {      string strsql = select count(*) from sysobjects where id = object_id(N[ + TableName + ]) and OBJECTPROPERTY(id, NIsUserTable) = 1;      //string strsql = SELECT count(*) FROM sys.objects WHERE object_id = OBJECT_ID(N[dbo].[ + TableName + ]) AND type in (NU);      object obj = GetSingle(strsql);      int cmdresult;      if ((Object.Equals(obj, null)) || (Object.Equals(obj, System.DBNull.Value)))      {        cmdresult = 0;      }      else      {        cmdresult = int.Parse(obj.ToString());      }      if (cmdresult == 0)      {        return false;      }      else      {        return true;      }    }    public static bool Exists(string strSql, params SqlParameter[] cmdParms)    {      object obj = GetSingle(strSql, cmdParms);      int cmdresult;      if ((Object.Equals(obj, null)) || (Object.Equals(obj, System.DBNull.Value)))      {        cmdresult = 0;      }      else      {        cmdresult = int.Parse(obj.ToString());      }      if (cmdresult == 0)      {        return false;      }      else      {        return true;      }    }    #endregion    #region 执行简单SQL语句    /// summary    /// 执行SQL语句，返回影响的记录数    /// /summary    /// param name=SQLStringSQL语句/param    /// returns影响的记录数/returns    public static int ExecuteSql(string SQLString)    {      using (SqlConnection connection = new SqlConnection(connectionString))      {        using (SqlCommand cmd = new SqlCommand(SQLString, connection))        {          try          {            connection.Open();            int rows = cmd.ExecuteNonQuery();            return rows;          }          catch (System.Data.SqlClient.SqlException e)          {            connection.Close();            throw e;          }        }      }    }    public static int ExecuteSqlByTime(string SQLString, int Times)    {      using (SqlConnection connection = new SqlConnection(connectionString))      {        using (SqlCommand cmd = new SqlCommand(SQLString, connection))        {          try          {            connection.Open();            cmd.CommandTimeout = Times;            int rows = cmd.ExecuteNonQuery();            return rows;          }          catch (System.Data.SqlClient.SqlException e)          {            connection.Close();            throw e;          }        }      }    }      /// summary    /// 执行Sql和Oracle滴混合事务    /// /summary    /// param name=listSQL命令行列表/param    /// param name=oracleCmdSqlListOracle命令行列表/param    /// returns执行结果 0-由于SQL造成事务失败 -1 由于Oracle造成事务失败 1-整体事务执行成功/returns    public static int ExecuteSqlTran(ListCommandInfo list, ListCommandInfo oracleCmdSqlList)    {      using (SqlConnection conn = new SqlConnection(connectionString))      {        conn.Open();        SqlCommand cmd = new SqlCommand();        cmd.Connection = conn;        SqlTransaction tx = conn.BeginTransaction();        cmd.Transaction = tx;        try        {          foreach (CommandInfo myDE in list)          {            string cmdText = myDE.CommandText;            SqlParameter[] cmdParms = (SqlParameter[])myDE.Parameters;            PrepareCommand(cmd, conn, tx, cmdText, cmdParms);            if (myDE.EffentNextType == EffentNextType.SolicitationEvent)            {              if (myDE.CommandText.ToLower().IndexOf(count() == -1)              {                tx.Rollback();                throw new Exception(违背要求+myDE.CommandText+必须符合select count(..的格式);                //return 0;              }              object obj = cmd.ExecuteScalar();              bool isHave = false;              if (obj == null  obj == DBNull.Value)              {                isHave = false;              }              isHave = Convert.ToInt32(obj)  0;              if (isHave)              {                //引发事件                myDE.OnSolicitationEvent();              }            }            if (myDE.EffentNextType == EffentNextType.WhenHaveContine || myDE.EffentNextType == EffentNextType.WhenNoHaveContine)            {              if (myDE.CommandText.ToLower().IndexOf(count() == -1)              {                tx.Rollback();                throw new Exception(SQL:违背要求 + myDE.CommandText + 必须符合select count(..的格式);                //return 0;              }              object obj = cmd.ExecuteScalar();              bool isHave = false;              if (obj == null  obj == DBNull.Value)              {                isHave = false;              }              isHave = Convert.ToInt32(obj)  0;              if (myDE.EffentNextType == EffentNextType.WhenHaveContine  !isHave)              {                tx.Rollback();                throw new Exception(SQL:违背要求 + myDE.CommandText + 返回值必须大于0);                //return 0;              }              if (myDE.EffentNextType == EffentNextType.WhenNoHaveContine  isHave)              {                tx.Rollback();                throw new Exception(SQL:违背要求 + myDE.CommandText + 返回值必须等于0);                //return 0;              }              continue;            }            int val = cmd.ExecuteNonQuery();            if (myDE.EffentNextType == EffentNextType.ExcuteEffectRows  val == 0)            {              tx.Rollback();              throw new Exception(SQL:违背要求 + myDE.CommandText + 必须有影响行);              //return 0;            }            cmd.Parameters.Clear();          }          string oraConnectionString = PubConstant.GetConnectionString(ConnectionStringPPC);          bool res = OracleHelper.ExecuteSqlTran(oraConnectionString, oracleCmdSqlList);          if (!res)          {            tx.Rollback();            throw new Exception(Oracle执行失败);            // return -1;          }          tx.Commit();          return 1;        }        catch (System.Data.SqlClient.SqlException e)        {          tx.Rollback();          throw e;        }        catch (Exception e)        {          tx.Rollback();          throw e;        }      }    }        /// summary    /// 执行多条SQL语句，实现数据库事务。    /// /summary    /// param name=SQLStringList多条SQL语句/param      public static int ExecuteSqlTran(ListString SQLStringList)    {      using (SqlConnection conn = new SqlConnection(connectionString))      {        conn.Open();        SqlCommand cmd = new SqlCommand();        cmd.Connection = conn;        SqlTransaction tx = conn.BeginTransaction();        cmd.Transaction = tx;        try        {          int count = 0;          for (int n = 0; n  SQLStringList.Count; n++)          {            string strsql = SQLStringList[n];            if (strsql.Trim().Length  1)            {              cmd.CommandText = strsql;              count += cmd.ExecuteNonQuery();            }          }          tx.Commit();          return count;        }        catch        {          tx.Rollback();          return 0;        }      }    }    /// summary    /// 执行带一个存储过程参数的的SQL语句。    /// /summary    /// param name=SQLStringSQL语句/param    /// param name=content参数内容,比如一个字段是格式复杂的文章，有特殊符号，可以通过这个方式添加/param    /// returns影响的记录数/returns    public static int ExecuteSql(string SQLString, string content)    {      using (SqlConnection connection = new SqlConnection(connectionString))      {        SqlCommand cmd = new SqlCommand(SQLString, connection);        System.Data.SqlClient.SqlParameter myParameter = new System.Data.SqlClient.SqlParameter(@content, SqlDbType.NText);        myParameter.Value = content;        cmd.Parameters.Add(myParameter);        try        {          connection.Open();          int rows = cmd.ExecuteNonQuery();          return rows;        }        catch (System.Data.SqlClient.SqlException e)        {          throw e;        }        finally        {          cmd.Dispose();          connection.Close();        }      }    }    /// summary    /// 执行带一个存储过程参数的的SQL语句。    /// /summary    /// param name=SQLStringSQL语句/param    /// param name=content参数内容,比如一个字段是格式复杂的文章，有特殊符号，可以通过这个方式添加/param    /// returns影响的记录数/returns    public static object ExecuteSqlGet(string SQLString, string content)    {      using (SqlConnection connection = new SqlConnection(connectionString))      {        SqlCommand cmd = new SqlCommand(SQLString, connection);        System.Data.SqlClient.SqlParameter myParameter = new System.Data.SqlClient.SqlParameter(@content, SqlDbType.NText);        myParameter.Value = content;        cmd.Parameters.Add(myParameter);        try        {          connection.Open();          object obj = cmd.ExecuteScalar();          if ((Object.Equals(obj, null)) || (Object.Equals(obj, System.DBNull.Value)))          {            return null;          }          else          {            return obj;          }        }        catch (System.Data.SqlClient.SqlException e)        {          throw e;        }        finally        {          cmd.Dispose();          connection.Close();        }      }    }    /// summary    /// 向数据库里插入图像格式的字段(和上面情况类似的另一种实例)    /// /summary    /// param name=strSQLSQL语句/param    /// param name=fs图像字节,数据库的字段类型为image的情况/param    /// returns影响的记录数/returns    public static int ExecuteSqlInsertImg(string strSQL, byte[] fs)    {      using (SqlConnection connection = new SqlConnection(connectionString))      {        SqlCommand cmd = new SqlCommand(strSQL, connection);        System.Data.SqlClient.SqlParameter myParameter = new System.Data.SqlClient.SqlParameter(@fs, SqlDbType.Image);        myParameter.Value = fs;        cmd.Parameters.Add(myParameter);        try        {          connection.Open();          int rows = cmd.ExecuteNonQuery();          return rows;        }        catch (System.Data.SqlClient.SqlException e)        {          throw e;        }        finally        {          cmd.Dispose();          connection.Close();        }      }    }    /// summary    /// 执行一条计算查询结果语句，返回查询结果（object）。    /// /summary    /// param name=SQLString计算查询结果语句/param    /// returns查询结果（object）/returns    public static object GetSingle(string SQLString)    {      using (SqlConnection connection = new SqlConnection(connectionString))      {        using (SqlCommand cmd = new SqlCommand(SQLString, connection))        {          try          {            connection.Open();            object obj = cmd.ExecuteScalar();            if ((Object.Equals(obj, null)) || (Object.Equals(obj, System.DBNull.Value)))            {              return null;            }            else            {              return obj;            }          }          catch (System.Data.SqlClient.SqlException e)          {            connection.Close();            throw e;          }        }      }    }    public static object GetSingle(string SQLString, int Times)    {      using (SqlConnection connection = new SqlConnection(connectionString))      {        using (SqlCommand cmd = new SqlCommand(SQLString, connection))        {          try          {            connection.Open();            cmd.CommandTimeout = Times;            object obj = cmd.ExecuteScalar();            if ((Object.Equals(obj, null)) || (Object.Equals(obj, System.DBNull.Value)))            {              return null;            }            else            {              return obj;            }          }          catch (System.Data.SqlClient.SqlException e)          {            connection.Close();            throw e;          }        }      }    }    /// summary    /// 执行查询语句，返回SqlDataReader ( 注意：调用该方法后，一定要对SqlDataReader进行Close )    /// /summary    /// param name=strSQL查询语句/param    /// returnsSqlDataReader/returns    public static SqlDataReader ExecuteReader(string strSQL)    {      SqlConnection connection = new SqlConnection(connectionString);      SqlCommand cmd = new SqlCommand(strSQL, connection);      try      {        connection.Open();        SqlDataReader myReader = cmd.ExecuteReader(CommandBehavior.CloseConnection);        return myReader;      }      catch (System.Data.SqlClient.SqlException e)      {        throw e;      }     }    /// summary    /// 执行查询语句，返回DataSet    /// /summary    /// param name=SQLString查询语句/param    /// returnsDataSet/returns    public static DataSet Query(string SQLString)    {      using (SqlConnection connection = new SqlConnection(connectionString))      {        DataSet ds = new DataSet();        try        {          connection.Open();          SqlDataAdapter command = new SqlDataAdapter(SQLString, connection);          command.Fill(ds, ds);        }        catch (System.Data.SqlClient.SqlException ex)        {          throw new Exception(ex.Message);        }        return ds;      }    '>DbHelperSQL</a>&nbsp;&nbsp;&nbsp;&nbsp;<span>16-1-28 上午 12:00:00</span></li><li><span>50</span>&nbsp;&nbsp;<a class='btn btn-link' style='color: blue' href='../../../../../Artlcle/vip/E6D6A875-C2A5-47A1-A83F-66C7C140F6C3.html' title='using System;using System.Configuration;using System.Data;using System.Data.OracleClient;using System.Collections;using System.Collections.Generic;namespace Maticsoft.DBUtility{  /// summary  /// A helper class used to execute queries against an Oracle database  /// /summary  public abstract class OracleHelper  {    // Read the connection strings from the configuration file    public static readonly string ConnectionStringLocalTransaction = ConfigurationManager.AppSettings[OraConnString1];    public static readonly string ConnectionStringInventoryDistributedTransaction = ConfigurationManager.AppSettings[OraConnString2];    public static readonly string ConnectionStringOrderDistributedTransaction = ConfigurationManager.AppSettings[OraConnString3];    public static readonly string ConnectionStringProfile = ConfigurationManager.AppSettings[OraProfileConnString];    public static readonly string ConnectionStringMembership = ConfigurationManager.AppSettings[OraMembershipConnString];    //Create a hashtable for the parameter cached    private static Hashtable parmCache = Hashtable.Synchronized(new Hashtable());    /// summary    /// Execute a database query which does not include a select    /// /summary    /// param name=connStringConnection string to database/param    /// param name=cmdTypeCommand type either stored procedure or SQL/param    /// param name=cmdTextAcutall SQL Command/param    /// param name=commandParametersParameters to bind to the command/param    /// returns/returns    public static int ExecuteNonQuery(string connectionString, CommandType cmdType, string cmdText, params OracleParameter[] commandParameters)    {      // Create a new Oracle command      OracleCommand cmd = new OracleCommand();      //Create a connection      using (OracleConnection connection = new OracleConnection(connectionString))      {        //Prepare the command        PrepareCommand(cmd, connection, null, cmdType, cmdText, commandParameters);        //Execute the command        int val = cmd.ExecuteNonQuery();        connection.Close();        cmd.Parameters.Clear();        return val;      }    }    /// summary    /// 执行查询语句，返回DataSet    /// /summary    /// param name=SQLString查询语句/param    /// returnsDataSet/returns    public static DataSet Query(string connectionString, string SQLString)    {      using (OracleConnection connection = new OracleConnection(connectionString))      {        DataSet ds = new DataSet();        try        {          connection.Open();          OracleDataAdapter command = new OracleDataAdapter(SQLString, connection);          command.Fill(ds, ds);        }        catch (OracleException ex)        {          throw new Exception(ex.Message);        }        finally        {          if (connection.State != ConnectionState.Closed)          {            connection.Close();          }        }        return ds;      }    }    public static DataSet Query(string connectionString, string SQLString, params OracleParameter[] cmdParms)    {      using (OracleConnection connection = new OracleConnection(connectionString))      {        OracleCommand cmd = new OracleCommand();        PrepareCommand(cmd, connection, null, SQLString, cmdParms);        using (OracleDataAdapter da = new OracleDataAdapter(cmd))        {          DataSet ds = new DataSet();          try          {            da.Fill(ds, ds);            cmd.Parameters.Clear();          }          catch (System.Data.OracleClient.OracleException ex)          {            throw new Exception(ex.Message);          }          finally          {            if (connection.State != ConnectionState.Closed)            {              connection.Close();            }          }          return ds;        }      }    }    private static void PrepareCommand(OracleCommand cmd, OracleConnection conn, OracleTransaction trans, string cmdText, OracleParameter[] cmdParms)    {      if (conn.State != ConnectionState.Open)        conn.Open();      cmd.Connection = conn;      cmd.CommandText = cmdText;      if (trans != null)        cmd.Transaction = trans;      cmd.CommandType = CommandType.Text;//cmdType;      if (cmdParms != null)      {        foreach (OracleParameter parameter in cmdParms)        {          if ((parameter.Direction == ParameterDirection.InputOutput || parameter.Direction == ParameterDirection.Input)             (parameter.Value == null))          {            parameter.Value = DBNull.Value;          }          cmd.Parameters.Add(parameter);        }      }    }    /// summary    /// 执行一条计算查询结果语句，返回查询结果（object）。    /// /summary    /// param name=SQLString计算查询结果语句/param    /// returns查询结果（object）/returns    public static object GetSingle(string connectionString, string SQLString)    {      using (OracleConnection connection = new OracleConnection(connectionString))      {        using (OracleCommand cmd = new OracleCommand(SQLString, connection))        {          try          {            connection.Open();            object obj = cmd.ExecuteScalar();            if ((Object.Equals(obj, null)) || (Object.Equals(obj, System.DBNull.Value)))            {              return null;            }            else            {              return obj;            }          }          catch (OracleException ex)          {            throw new Exception(ex.Message);          }          finally          {            if (connection.State != ConnectionState.Closed)            {              connection.Close();            }          }        }      }    }    public static bool Exists(string connectionString,string strOracle)    {      object obj = OracleHelper.GetSingle(connectionString,strOracle);      int cmdresult;      if ((Object.Equals(obj, null)) || (Object.Equals(obj, System.DBNull.Value)))      {        cmdresult = 0;      }      else      {        cmdresult = int.Parse(obj.ToString());      }      if (cmdresult == 0)      {        return false;      }      else      {        return true;      }    }    /// summary    /// Execute an OracleCommand (that returns no resultset) against an existing database transaction    /// using the provided parameters.    /// /summary    /// remarks    /// e.g.:     /// int result = ExecuteNonQuery(trans, CommandType.StoredProcedure, PublishOrders, new OracleParameter(:prodid, 24));    /// /remarks    /// param name=transan existing database transaction/param    /// param name=commandTypethe CommandType (stored procedure, text, etc.)/param    /// param name=commandTextthe stored procedure name or PL/SQL command/param    /// param name=commandParametersan array of OracleParamters used to execute the command/param    /// returnsan int representing the number of rows affected by the command/returns    public static int ExecuteNonQuery(OracleTransaction trans, CommandType cmdType, string cmdText, params OracleParameter[] commandParameters)    {      OracleCommand cmd = new OracleCommand();      PrepareCommand(cmd, trans.Connection, trans, cmdType, cmdText, commandParameters);      int val = cmd.ExecuteNonQuery();      cmd.Parameters.Clear();      return val;    }    /// summary    /// Execute an OracleCommand (that returns no resultset) against an existing database connection    /// using the provided parameters.    /// /summary    /// remarks    /// e.g.:     /// int result = ExecuteNonQuery(connString, CommandType.StoredProcedure, PublishOrders, new OracleParameter(:prodid, 24));    /// /remarks    /// param name=connan existing database connection/param    /// param name=commandTypethe CommandType (stored procedure, text, etc.)/param    /// param name=commandTextthe stored procedure name or PL/SQL command/param    /// param name=commandParametersan array of OracleParamters used to execute the command/param    /// returnsan int representing the number of rows affected by the command/returns    public static int ExecuteNonQuery(OracleConnection connection, CommandType cmdType, string cmdText, params OracleParameter[] commandParameters)    {      OracleCommand cmd = new OracleCommand();      PrepareCommand(cmd, connection, null, cmdType, cmdText, commandParameters);      int val = cmd.ExecuteNonQuery();      cmd.Parameters.Clear();      return val;    }    /// summary    /// Execute an OracleCommand (that returns no resultset) against an existing database connection    /// using the provided parameters.    /// /summary    /// remarks    /// e.g.:     /// int result = ExecuteNonQuery(connString, CommandType.StoredProcedure, PublishOrders, new OracleParameter(:prodid, 24));    /// /remarks    /// param name=connan existing database connection/param    /// param name=commandTextthe stored procedure name or PL/SQL command/param    /// returnsan int representing the number of rows affected by the command/returns    public static int ExecuteNonQuery(string connectionString, string cmdText)    {      OracleCommand cmd = new OracleCommand();      OracleConnection connection = new OracleConnection(connectionString);      PrepareCommand(cmd, connection, null, CommandType.Text, cmdText, null);      int val = cmd.ExecuteNonQuery();      cmd.Parameters.Clear();      return val;    }    /// summary    /// Execute a select query that will return a result set    /// /summary    /// param name=connStringConnection string/param    //// param name=commandTypethe CommandType (stored procedure, text, etc.)/param    /// param name=commandTextthe stored procedure name or PL/SQL command/param    /// param name=commandParametersan array of OracleParamters used to execute the command/param    /// returns/returns    public static OracleDataReader ExecuteReader(string connectionString, CommandType cmdType, string cmdText, params OracleParameter[] commandParameters)    {            OracleCommand cmd = new OracleCommand();      OracleConnection conn = new OracleConnection(connectionString);      try      {        //Prepare the command to execute        PrepareCommand(cmd, conn, null, cmdType, cmdText, commandParameters);                OracleDataReader rdr = cmd.ExecuteReader(CommandBehavior.CloseConnection);        cmd.Parameters.Clear();        return rdr;      }      catch      {        conn.Close();        throw;      }    }    /// summary    /// Execute an OracleCommand that returns the first column of the first record against the database specified in the connection string    /// using the provided parameters.    /// /summary    /// remarks    /// e.g.:     /// Object obj = ExecuteScalar(connString, CommandType.StoredProcedure, PublishOrders, new OracleParameter(:prodid, 24));    /// /remarks    /// param name=connectionStringa valid connection string for a SqlConnection/param    /// param name=commandTypethe CommandType (stored procedure, text, etc.)/param    /// param name=commandTextthe stored procedure name or PL/SQL command/param    /// param name=commandParametersan array of OracleParamters used to execute the command/param    /// returnsAn object that should be converted to the expected type using Convert.To{Type}/returns    public static object ExecuteScalar(string connectionString, CommandType cmdType, string cmdText, params OracleParameter[] commandParameters)    {      OracleCommand cmd = new OracleCommand();      using (OracleConnection conn = new OracleConnection(connectionString))      {        PrepareCommand(cmd, conn, null, cmdType, cmdText, commandParameters);        object val = cmd.ExecuteScalar();        cmd.Parameters.Clear();        return val;      }    }    /// summary    /// Execute a OracleCommand (that returns a 1x1 resultset) against the specified SqlTransaction    /// using the provided parameters.    /// /summary    /// param name=transactionA valid SqlTransaction/param    /// param name=commandTypeThe CommandType (stored procedure, text, etc.)/param    /// param name=commandTextThe stored procedure name or PL/SQL command/param    /// param name=commandParametersAn array of OracleParamters used to execute the command/param    /// returnsAn object containing the value in the 1x1 resultset generated by the command/returns    public static object ExecuteScalar(OracleTransaction transaction, CommandType commandType, string commandText, params OracleParameter[] commandParameters)    {      if (transaction == null)        throw new ArgumentNullException(transaction);      if (transaction != null  transaction.Connection == null)        throw new ArgumentException(The transaction was rollbacked or commited, please provide an open transaction., transaction);      // Create a command and prepare it for execution      OracleCommand cmd = new OracleCommand();      PrepareCommand(cmd, transaction.Connection, transaction, commandType, commandText, commandParameters);      // Execute the command  return the results      object retval = cmd.ExecuteScalar();      // Detach the SqlParameters from the command object, so they can be used again      cmd.Parameters.Clear();      return retval;    }    /// summary    /// Execute an OracleCommand that returns the first column of the first record against an existing database connection    /// using the provided parameters.    /// /summary    /// remarks    /// e.g.:     /// Object obj = ExecuteScalar(conn, CommandType.StoredProcedure, PublishOrders, new OracleParameter(:prodid, 24));    /// /remarks    /// param name=connan existing database connection/param    /// param name=commandTypethe CommandType (stored procedure, text, etc.)/param    /// param name=commandTextthe stored procedure name or PL/SQL command/param    /// param name=commandParametersan array of OracleParamters used to execute the command/param    /// returnsAn object that should be converted to the expected type using Convert.To{Type}/returns    public static object ExecuteScalar(OracleConnection connectionString, CommandType cmdType, string cmdText, params OracleParameter[] commandParameters)    {      OracleCommand cmd = new OracleCommand();      PrepareCommand(cmd, connectionString, null, cmdType, cmdText, commandParameters);      object val = cmd.ExecuteScalar();      cmd.Parameters.Clear();      return val;    }    /// summary    /// Add a set of parameters to the cached    /// /summary    /// param name=cacheKeyKey value to look up the parameters/param    /// param name=commandParametersActual parameters to cached/param    public static void CacheParameters(string cacheKey, params OracleParameter[] commandParameters)    {      parmCache[cacheKey] = commandParameters;    }    /// summary    /// Fetch parameters from the cache    /// /summary    /// param name=cacheKeyKey to look up the parameters/param    /// returns/returns    public static OracleParameter[] GetCachedParameters(string cacheKey)    {      OracleParameter[] cachedParms = (OracleParameter[])parmCache[cacheKey];      if (cachedParms == null)        return null;      // If the parameters are in the cache      OracleParameter[] clonedParms = new OracleParameter[cachedParms.Length];      // return a copy of the parameters      for (int i = 0, j = cachedParms.Length; i  j; i++)        clonedParms[i] = (OracleParameter)((ICloneable)cachedParms[i]).Clone();      return clonedParms;    }       /// summary    /// Internal function to prepare a command for execution by the database    /// /summary    /// param name=cmdExisting command object/param    /// param name=connDatabase connection object/param    /// param name=transOptional transaction object/param    /// param name=cmdTypeCommand type, e.g. stored procedure/param    /// param name=cmdTextCommand test/param    /// param name=commandParametersParameters for the command/param    private static void PrepareCommand(OracleCommand cmd, OracleConnection conn, OracleTransaction trans, CommandType cmdType, string cmdText, OracleParameter[] commandParameters)    {      //Open the connection if required      if (conn.State != ConnectionState.Open)        conn.Open();      //Set up the command      cmd.Connection = conn;      cmd.CommandText = cmdText;      cmd.CommandType = cmdType;      //Bind it to the transaction if it exists      if (trans != null)        cmd.Transaction = trans;      // Bind the parameters passed in      if (commandParameters != null)      {        foreach (OracleParameter parm in commandParameters)          cmd.Parameters.Add(parm);      }    }    /// summary    /// Converter to use boolean data type with Oracle    /// /summary    /// param name=valueValue to convert/param    /// returns/returns    public static string OraBit(bool value)    {      if (value)        return Y;      else        return N;    }    /// summary    /// Converter to use boolean data type with Oracle    /// /summary    /// param name=valueValue to convert/param    /// returns/returns    public static bool OraBool(string value)    {      if (value.Equals(Y))        return true;      else        return false;    }    /// summary    /// 执行多条SQL语句，实现数据库事务。    /// /summary    /// param name=SQLStringList多条SQL语句/param      public static bool ExecuteSqlTran(string conStr, ListCommandInfo cmdList)    {      using (OracleConnection conn = new OracleConnection(conStr))      {        conn.Open();        OracleCommand cmd = new OracleCommand();        cmd.Connection = conn;        OracleTransaction tx = conn.BeginTransaction();        cmd.Transaction = tx;        try        {          foreach (CommandInfo c in cmdList)          {            if (!String.IsNullOrEmpty(c.CommandText))            {              PrepareCommand(cmd, conn, tx, CommandType.Text, c.CommandText, (OracleParameter[])c.Parameters);              if (c.EffentNextType == EffentNextType.WhenHaveContine || c.EffentNextType == EffentNextType.WhenNoHaveContine)              {                if (c.CommandText.ToLower().IndexOf(count() == -1)                {                  tx.Rollback();                  throw new Exception(Oracle:违背要求 + c.CommandText + 必须符合select count(..的格式);                  //return false;                }                object obj = cmd.ExecuteScalar();                bool isHave = false;                if (obj == null  obj == DBNull.Value)                {                  isHave = false;                }                isHave = Convert.ToInt32(obj)  0;                if (c.EffentNextType == EffentNextType.WhenHaveContine  !isHave)                {     &nbsp'>OracleHelper</a>&nbsp;&nbsp;&nbsp;&nbsp;<span>16-1-28 上午 12:00:00</span></li><li><span>51</span>&nbsp;&nbsp;<a class='btn btn-link' style='color: blue' href='../../../../../Artlcle/vip/46492F93-7B0C-4C7C-81D6-73CCBF7E936C.html' title=' /// summary /// 显示消息提示对话框。  /// Copyright (C) Maticsoft /// /summary public class MessageBox {    private MessageBox()  {     }  /// summary  /// 显示消息提示对话框  /// /summary  /// param name=page当前页面指针，一般为this/param  /// param name=msg提示信息/param  public static void Show(System.Web.UI.Page page,string msg)  {            page.ClientScript.RegisterStartupScript(page.GetType(),message, script language=javascript deferalert( + msg.ToString() + );/script);  }  /// summary  /// 控件点击 消息确认提示框  /// /summary  /// param name=page当前页面指针，一般为this/param  /// param name=msg提示信息/param  public static void ShowConfirm(System.Web.UI.WebControls.WebControl Control,string msg)  {   //Control.Attributes.Add(onClick,if (!window.confirm(+msg+)){return false;});   Control.Attributes.Add(onclick, return confirm( + msg + );) ;  }  /// summary  /// 显示消息提示对话框，并进行页面跳转  /// /summary  /// param name=page当前页面指针，一般为this/param  /// param name=msg提示信息/param  /// param name=url跳转的目标URL/param  public static void ShowAndRedirect(System.Web.UI.Page page,string msg,string url)  {         //Response.Write(scriptalert(帐户审核通过！现在去为企业充值。);window.location=\ + pageurl + \/script);      page.ClientScript.RegisterStartupScript(page.GetType(), message, script language=javascript deferalert( + msg + );window.location=\ + url + \/script);  }    /// summary    /// 显示消息提示对话框，并进行页面跳转    /// /summary    /// param name=page当前页面指针，一般为this/param    /// param name=msg提示信息/param    /// param name=url跳转的目标URL/param    public static void ShowAndRedirects(System.Web.UI.Page page, string msg, string url)    {      StringBuilder Builder = new StringBuilder();      Builder.Append(script language=javascript defer);      Builder.AppendFormat(alert({0});, msg);      Builder.AppendFormat(top.location.href={0}, url);      Builder.Append(/script);      page.ClientScript.RegisterStartupScript(page.GetType(), message, Builder.ToString());    }  /// summary  /// 输出自定义脚本信息  /// /summary  /// param name=page当前页面指针，一般为this/param  /// param name=script输出脚本/param  public static void ResponseScript(System.Web.UI.Page page,string script)  {      page.ClientScript.RegisterStartupScript(page.GetType(), message, script language=javascript defer + script + /script);        } }'>asp.net 显示消息提示对话框方法。</a>&nbsp;&nbsp;&nbsp;&nbsp;<span>16-1-28 上午 12:00:00</span></li><li><span>52</span>&nbsp;&nbsp;<a class='btn btn-link' style='color: blue' href='../../../../../Artlcle/vip/ECB52A31-7ADD-46B4-824A-7AF48A6CFCAD.html' title='/// summary /// 缓存相关的操作类  /// Copyright (C) Maticsoft /// /summary public class DataCache {  /// summary  /// 获取当前应用程序指定CacheKey的Cache值  /// /summary  /// param name=CacheKey/param  /// returns/returns  public static object GetCache(string CacheKey)  {   System.Web.Caching.Cache objCache = HttpRuntime.Cache;   return objCache[CacheKey];  }  /// summary  /// 设置当前应用程序指定CacheKey的Cache值  /// /summary  /// param name=CacheKey/param  /// param name=objObject/param  public static void SetCache(string CacheKey, object objObject)  {   System.Web.Caching.Cache objCache = HttpRuntime.Cache;   objCache.Insert(CacheKey, objObject);  }  /// summary  /// 设置当前应用程序指定CacheKey的Cache值  /// /summary  /// param name=CacheKey/param  /// param name=objObject/param  public static void SetCache(string CacheKey, object objObject, DateTime absoluteExpiration,TimeSpan slidingExpiration )  {   System.Web.Caching.Cache objCache = HttpRuntime.Cache;   objCache.Insert(CacheKey, objObject,null,absoluteExpiration,slidingExpiration);  } }'>缓存相关的操作类</a>&nbsp;&nbsp;&nbsp;&nbsp;<span>16-1-28 上午 12:00:00</span></li><li><span>53</span>&nbsp;&nbsp;<a class='btn btn-link' style='color: blue' href='../../../../../Artlcle/vip/F6C9C1EB-BAB6-4C82-B019-99F6950A52EE.html' title='using System;using System.Collections;using System.Collections.Specialized;using System.Data;using MySql.Data.MySqlClient;using System.Configuration;using System.Data.Common;using System.Collections.Generic;namespace Maticsoft.DBUtility{  /// summary  /// 数据访问抽象基础类  /// Copyright (C) Maticsoft  /// /summary  public abstract class DbHelperMySQL  {    //数据库连接字符串(web.config来配置)，可以动态更改connectionString支持多数据库.      public static string connectionString = PubConstant.ConnectionString;    public DbHelperMySQL()    {          }    #region 公用方法    /// summary    /// 得到最大值    /// /summary    /// param name=FieldName/param    /// param name=TableName/param    /// returns/returns    public static int GetMaxID(string FieldName, string TableName)    {      string strsql = select max( + FieldName + )+1 from  + TableName;      object obj = GetSingle(strsql);      if (obj == null)      {        return 1;      }      else      {        return int.Parse(obj.ToString());      }    }    /// summary    /// 是否存在    /// /summary    /// param name=strSql/param    /// returns/returns    public static bool Exists(string strSql)    {      object obj = GetSingle(strSql);      int cmdresult;      if ((Object.Equals(obj, null)) || (Object.Equals(obj, System.DBNull.Value)))      {        cmdresult = 0;      }      else      {        cmdresult = int.Parse(obj.ToString());      }      if (cmdresult == 0)      {        return false;      }      else      {        return true;      }    }      /// summary    /// 是否存在（基于MySqlParameter）    /// /summary    /// param name=strSql/param    /// param name=cmdParms/param    /// returns/returns    public static bool Exists(string strSql, params MySqlParameter[] cmdParms)    {      object obj = GetSingle(strSql, cmdParms);      int cmdresult;      if ((Object.Equals(obj, null)) || (Object.Equals(obj, System.DBNull.Value)))      {        cmdresult = 0;      }      else      {        cmdresult = int.Parse(obj.ToString());      }      if (cmdresult == 0)      {        return false;      }      else      {        return true;      }    }    #endregion    #region 执行简单SQL语句    /// summary    /// 执行SQL语句，返回影响的记录数    /// /summary    /// param name=SQLStringSQL语句/param    /// returns影响的记录数/returns    public static int ExecuteSql(string SQLString)    {      using (MySqlConnection connection = new MySqlConnection(connectionString))      {        using (MySqlCommand cmd = new MySqlCommand(SQLString, connection))        {          try          {            connection.Open();            int rows = cmd.ExecuteNonQuery();            return rows;          }          catch (MySql.Data.MySqlClient.MySqlException e)          {            connection.Close();            throw e;          }        }      }    }    public static int ExecuteSqlByTime(string SQLString, int Times)    {      using (MySqlConnection connection = new MySqlConnection(connectionString))      {        using (MySqlCommand cmd = new MySqlCommand(SQLString, connection))        {          try          {            connection.Open();            cmd.CommandTimeout = Times;            int rows = cmd.ExecuteNonQuery();            return rows;          }          catch (MySql.Data.MySqlClient.MySqlException e)          {            connection.Close();            throw e;          }        }      }    }      /// summary    /// 执行Sql和Oracle滴混合事务    /// /summary    /// param name=listSQL命令行列表/param    /// param name=oracleCmdSqlListOracle命令行列表/param    /// returns执行结果 0-由于SQL造成事务失败 -1 由于Oracle造成事务失败 1-整体事务执行成功/returns    public static int ExecuteSqlTran(ListCommandInfo list, ListCommandInfo oracleCmdSqlList)    {      using (MySqlConnection conn = new MySqlConnection(connectionString))      {        conn.Open();        MySqlCommand cmd = new MySqlCommand();        cmd.Connection = conn;        MySqlTransaction tx = conn.BeginTransaction();        cmd.Transaction = tx;        try        {          foreach (CommandInfo myDE in list)          {            string cmdText = myDE.CommandText;            MySqlParameter[] cmdParms = (MySqlParameter[])myDE.Parameters;            PrepareCommand(cmd, conn, tx, cmdText, cmdParms);            if (myDE.EffentNextType == EffentNextType.SolicitationEvent)            {              if (myDE.CommandText.ToLower().IndexOf(count() == -1)              {                tx.Rollback();                throw new Exception(违背要求+myDE.CommandText+必须符合select count(..的格式);                //return 0;              }              object obj = cmd.ExecuteScalar();              bool isHave = false;              if (obj == null  obj == DBNull.Value)              {                isHave = false;              }              isHave = Convert.ToInt32(obj)  0;              if (isHave)              {                //引发事件                myDE.OnSolicitationEvent();              }            }            if (myDE.EffentNextType == EffentNextType.WhenHaveContine || myDE.EffentNextType == EffentNextType.WhenNoHaveContine)            {              if (myDE.CommandText.ToLower().IndexOf(count() == -1)              {                tx.Rollback();                throw new Exception(SQL:违背要求 + myDE.CommandText + 必须符合select count(..的格式);                //return 0;              }              object obj = cmd.ExecuteScalar();              bool isHave = false;              if (obj == null  obj == DBNull.Value)              {                isHave = false;              }              isHave = Convert.ToInt32(obj)  0;              if (myDE.EffentNextType == EffentNextType.WhenHaveContine  !isHave)              {                tx.Rollback();                throw new Exception(SQL:违背要求 + myDE.CommandText + 返回值必须大于0);                //return 0;              }              if (myDE.EffentNextType == EffentNextType.WhenNoHaveContine  isHave)              {                tx.Rollback();                throw new Exception(SQL:违背要求 + myDE.CommandText + 返回值必须等于0);                //return 0;              }              continue;            }            int val = cmd.ExecuteNonQuery();            if (myDE.EffentNextType == EffentNextType.ExcuteEffectRows  val == 0)            {              tx.Rollback();              throw new Exception(SQL:违背要求 + myDE.CommandText + 必须有影响行);              //return 0;            }            cmd.Parameters.Clear();          }          string oraConnectionString = PubConstant.GetConnectionString(ConnectionStringPPC);          bool res = OracleHelper.ExecuteSqlTran(oraConnectionString, oracleCmdSqlList);          if (!res)          {            tx.Rollback();            throw new Exception(执行失败);            // return -1;          }          tx.Commit();          return 1;        }        catch (MySql.Data.MySqlClient.MySqlException e)        {          tx.Rollback();          throw e;        }        catch (Exception e)        {          tx.Rollback();          throw e;        }      }    }        /// summary    /// 执行多条SQL语句，实现数据库事务。    /// /summary    /// param name=SQLStringList多条SQL语句/param      public static int ExecuteSqlTran(ListString SQLStringList)    {      using (MySqlConnection conn = new MySqlConnection(connectionString))      {        conn.Open();        MySqlCommand cmd = new MySqlCommand();        cmd.Connection = conn;        MySqlTransaction tx = conn.BeginTransaction();        cmd.Transaction = tx;        try        {          int count = 0;          for (int n = 0; n  SQLStringList.Count; n++)          {            string strsql = SQLStringList[n];            if (strsql.Trim().Length  1)            {              cmd.CommandText = strsql;              count += cmd.ExecuteNonQuery();            }          }          tx.Commit();          return count;        }        catch        {          tx.Rollback();          return 0;        }      }    }    /// summary    /// 执行带一个存储过程参数的的SQL语句。    /// /summary    /// param name=SQLStringSQL语句/param    /// param name=content参数内容,比如一个字段是格式复杂的文章，有特殊符号，可以通过这个方式添加/param    /// returns影响的记录数/returns    public static int ExecuteSql(string SQLString, string content)    {      using (MySqlConnection connection = new MySqlConnection(connectionString))      {        MySqlCommand cmd = new MySqlCommand(SQLString, connection);        MySql.Data.MySqlClient.MySqlParameter myParameter = new MySql.Data.MySqlClient.MySqlParameter(@content, SqlDbType.NText);        myParameter.Value = content;        cmd.Parameters.Add(myParameter);        try        {          connection.Open();          int rows = cmd.ExecuteNonQuery();          return rows;        }        catch (MySql.Data.MySqlClient.MySqlException e)        {          throw e;        }        finally        {          cmd.Dispose();          connection.Close();        }      }    }    /// summary    /// 执行带一个存储过程参数的的SQL语句。    /// /summary    /// param name=SQLStringSQL语句/param    /// param name=content参数内容,比如一个字段是格式复杂的文章，有特殊符号，可以通过这个方式添加/param    /// returns影响的记录数/returns    public static object ExecuteSqlGet(string SQLString, string content)    {      using (MySqlConnection connection = new MySqlConnection(connectionString))      {        MySqlCommand cmd = new MySqlCommand(SQLString, connection);        MySql.Data.MySqlClient.MySqlParameter myParameter = new MySql.Data.MySqlClient.MySqlParameter(@content, SqlDbType.NText);        myParameter.Value = content;        cmd.Parameters.Add(myParameter);        try        {          connection.Open();          object obj = cmd.ExecuteScalar();          if ((Object.Equals(obj, null)) || (Object.Equals(obj, System.DBNull.Value)))          {            return null;          }          else          {            return obj;          }        }        catch (MySql.Data.MySqlClient.MySqlException e)        {          throw e;        }        finally        {          cmd.Dispose();          connection.Close();        }      }    }    /// summary    /// 向数据库里插入图像格式的字段(和上面情况类似的另一种实例)    /// /summary    /// param name=strSQLSQL语句/param    /// param name=fs图像字节,数据库的字段类型为image的情况/param    /// returns影响的记录数/returns    public static int ExecuteSqlInsertImg(string strSQL, byte[] fs)    {      using (MySqlConnection connection = new MySqlConnection(connectionString))      {        MySqlCommand cmd = new MySqlCommand(strSQL, connection);        MySql.Data.MySqlClient.MySqlParameter myParameter = new MySql.Data.MySqlClient.MySqlParameter(@fs, SqlDbType.Image);        myParameter.Value = fs;        cmd.Parameters.Add(myParameter);        try        {          connection.Open();          int rows = cmd.ExecuteNonQuery();          return rows;        }        catch (MySql.Data.MySqlClient.MySqlException e)        {          throw e;        }        finally        {          cmd.Dispose();          connection.Close();        }      }    }    /// summary    /// 执行一条计算查询结果语句，返回查询结果（object）。    /// /summary    /// param name=SQLString计算查询结果语句/param    /// returns查询结果（object）/returns    public static object GetSingle(string SQLString)    {      using (MySqlConnection connection = new MySqlConnection(connectionString))      {        using (MySqlCommand cmd = new MySqlCommand(SQLString, connection))        {          try          {            connection.Open();            object obj = cmd.ExecuteScalar();            if ((Object.Equals(obj, null)) || (Object.Equals(obj, System.DBNull.Value)))            {              return null;            }            else            {              return obj;            }          }          catch (MySql.Data.MySqlClient.MySqlException e)          {            connection.Close();            throw e;          }        }      }    }    public static object GetSingle(string SQLString, int Times)    {      using (MySqlConnection connection = new MySqlConnection(connectionString))      {        using (MySqlCommand cmd = new MySqlCommand(SQLString, connection))        {          try          {            connection.Open();            cmd.CommandTimeout = Times;            object obj = cmd.ExecuteScalar();            if ((Object.Equals(obj, null)) || (Object.Equals(obj, System.DBNull.Value)))            {              return null;            }            else            {              return obj;            }          }          catch (MySql.Data.MySqlClient.MySqlException e)          {            connection.Close();            throw e;          }        }      }    }    /// summary    /// 执行查询语句，返回MySqlDataReader ( 注意：调用该方法后，一定要对MySqlDataReader进行Close )    /// /summary    /// param name=strSQL查询语句/param    /// returnsMySqlDataReader/returns    public static MySqlDataReader ExecuteReader(string strSQL)    {      MySqlConnection connection = new MySqlConnection(connectionString);      MySqlCommand cmd = new MySqlCommand(strSQL, connection);      try      {        connection.Open();        MySqlDataReader myReader = cmd.ExecuteReader(CommandBehavior.CloseConnection);        return myReader;      }      catch (MySql.Data.MySqlClient.MySqlException e)      {        throw e;      }     }    /// summary    /// 执行查询语句，返回DataSet    /// /summary    /// param name=SQLString查询语句/param    /// returnsDataSet/returns    public static DataSet Query(string SQLString)    {      using (MySqlConnection connection = new MySqlConnection(connectionString))      {        DataSet ds = new DataSet();        try        {          connection.Open();          MySqlDataAdapter command = new MySqlDataAdapter(SQLString, connection);          command.Fill(ds, ds);        }        catch (MySql.Data.MySqlClient.MySqlException ex)        {          throw new Exception(ex.Message);        }        return ds;      }    }    public static DataSet Query(string SQLString, int Times)    {      using (MySqlConnection connection = new MySqlConnection(connectionString))      {        DataSet ds = new DataSet();        try        {          connection.Open();          MySqlDataAdapter command = new MySqlDataAdapter(SQLString, connection);          command.SelectCommand.CommandTimeout = Times;          command.Fill(ds, ds);        }        catch (MySql.Data.MySqlClient.MySqlException ex)        {          throw new Exception(ex.Message);        }        return ds;      }    }    #endregion    #region 执行带参数的SQL语句    /// summary    /// 执行SQL语句，返回影响的记录数    /// /summary    /// param name=SQLStringSQL语句/param&'>DbHelperMySQL</a>&nbsp;&nbsp;&nbsp;&nbsp;<span>16-1-28 上午 12:00:00</span></li><li><span>54</span>&nbsp;&nbsp;<a class='btn btn-link' style='color: blue' href='../../../../../Artlcle/vip/B8CD95BD-67E5-4056-B0C3-A8409CE7D573.html' title='/// summary  /// 页面数据校验类  /// Copyright (C) Maticsoft 2004-2012 /// /summary public class PageValidate {    private static Regex RegPhone = new Regex(^[0-9]+[-]?[0-9]+[-]?[0-9]$);  private static Regex RegNumber = new Regex(^[0-9]+$);  private static Regex RegNumberSign = new Regex(^[+-]?[0-9]+$);  private static Regex RegDecimal = new Regex(^[0-9]+[.]?[0-9]+$);  private static Regex RegDecimalSign = new Regex(^[+-]?[0-9]+[.]?[0-9]+$); //等价于^[+-]?\d+[.]?\d+$  private static Regex RegEmail = new Regex(^[\\w-]+@[\\w-]+\\.(com|net|org|edu|mil|tv|biz|info)$);//w 英文字母或数字的字符串，和 [a-zA-Z0-9] 语法一样  private static Regex RegCHZN = new Regex([\u4e00-\u9fa5]);  public PageValidate()  {  }  #region 数字字符串检查      public static bool IsPhone(string inputData)    {      Match m = RegPhone.Match(inputData);      return m.Success;    }  /// summary  /// 检查Request查询字符串的键值，是否是数字，最大长度限制  /// /summary  /// param name=reqRequest/param  /// param name=inputKeyRequest的键值/param  /// param name=maxLen最大长度/param  /// returns返回Request查询字符串/returns  public static string FetchInputDigit(HttpRequest req, string inputKey, int maxLen)  {   string retVal = string.Empty;   if(inputKey != null  inputKey != string.Empty)   {    retVal = req.QueryString[inputKey];    if(null == retVal)     retVal = req.Form[inputKey];    if(null != retVal)    {     retVal = SqlText(retVal, maxLen);     if(!IsNumber(retVal))      retVal = string.Empty;    }   }   if(retVal == null)    retVal = string.Empty;   return retVal;  }    /// summary  /// 是否数字字符串  /// /summary  /// param name=inputData输入字符串/param  /// returns/returns  public static bool IsNumber(string inputData)  {   Match m = RegNumber.Match(inputData);   return m.Success;  }  /// summary  /// 是否数字字符串 可带正负号  /// /summary  /// param name=inputData输入字符串/param  /// returns/returns  public static bool IsNumberSign(string inputData)  {   Match m = RegNumberSign.Match(inputData);   return m.Success;  }    /// summary  /// 是否是浮点数  /// /summary  /// param name=inputData输入字符串/param  /// returns/returns  public static bool IsDecimal(string inputData)  {   Match m = RegDecimal.Match(inputData);   return m.Success;  }    /// summary  /// 是否是浮点数 可带正负号  /// /summary  /// param name=inputData输入字符串/param  /// returns/returns  public static bool IsDecimalSign(string inputData)  {   Match m = RegDecimalSign.Match(inputData);   return m.Success;  }    #endregion  #region 中文检测  /// summary  /// 检测是否有中文字符  /// /summary  /// param name=inputData/param  /// returns/returns  public static bool IsHasCHZN(string inputData)  {   Match m = RegCHZN.Match(inputData);   return m.Success;  }   #endregion  #region 邮件地址  /// summary  /// 是否是浮点数 可带正负号  /// /summary  /// param name=inputData输入字符串/param  /// returns/returns  public static bool IsEmail(string inputData)  {   Match m = RegEmail.Match(inputData);   return m.Success;  }    #endregion    #region 日期格式判断    /// summary    /// 日期格式字符串判断    /// /summary    /// param name=str/param    /// returns/returns    public static bool IsDateTime(string str)    {      try      {        if (!string.IsNullOrEmpty(str))        {          DateTime.Parse(str);          return true;        }        else        {          return false;        }      }      catch      {        return false;      }    }    #endregion    #region 其他    /// summary  /// 检查字符串最大长度，返回指定长度的串  /// /summary  /// param name=sqlInput输入字符串/param  /// param name=maxLength最大长度/param  /// returns/returns     public static string SqlText(string sqlInput, int maxLength)  {      if(sqlInput != null  sqlInput != string.Empty)   {    sqlInput = sqlInput.Trim();           if(sqlInput.Length  maxLength)//按最大长度截取字符串     sqlInput = sqlInput.Substring(0, maxLength);   }   return sqlInput;  }    /// summary  /// 字符串编码  /// /summary  /// param name=inputData/param  /// returns/returns  public static string HtmlEncode(string inputData)  {   return HttpUtility.HtmlEncode(inputData);  }  /// summary  /// 设置Label显示Encode的字符串  /// /summary  /// param name=lbl/param  /// param name=txtInput/param  public static void SetLabel(Label lbl, string txtInput)  {   lbl.Text = HtmlEncode(txtInput);  }  public static void SetLabel(Label lbl, object inputObj)  {   SetLabel(lbl, inputObj.ToString());  }    //字符串清理  public static string InputText(string inputString, int maxLength)  {      StringBuilder retVal = new StringBuilder();   // 检查是否为空   if ((inputString != null)  (inputString != String.Empty))   {    inputString = inputString.Trim();        //检查长度    if (inputString.Length  maxLength)     inputString = inputString.Substring(0, maxLength);        //替换危险字符    for (int i = 0; i  inputString.Length; i++)    {     switch (inputString[i])     {      case :       retVal.Append(quot;);       break;      case :       retVal.Append(lt;);       break;      case :       retVal.Append(gt;);       break;      default:       retVal.Append(inputString[i]);       break;     }    }        retVal.Replace(,  );// 替换单引号   }   return retVal.ToString();     }  /// summary  /// 转换成 HTML code  /// /summary  /// param name=strstring/param  /// returnsstring/returns  public static string Encode(string str)  {      str = str.Replace(,amp;);   str = str.Replace(,);   str = str.Replace(\,quot;);   str = str.Replace( ,nbsp;);   str = str.Replace(,lt;);   str = str.Replace(,gt;);   str = str.Replace(\n,br);   return str;  }  /// summary  ///解析html成 普通文本  /// /summary  /// param name=strstring/param  /// returnsstring/returns  public static string Decode(string str)  {      str = str.Replace(br,\n);   str = str.Replace(gt;,);   str = str.Replace(lt;,);   str = str.Replace(nbsp;, );   str = str.Replace(quot;,\);   return str;  }    public static string SqlTextClear(string sqlText)    {      if (sqlText == null)      {        return null;      }      if (sqlText == )      {        return ;      }      sqlText = sqlText.Replace(,, );//去除,      sqlText = sqlText.Replace(, );//去除      sqlText = sqlText.Replace(, );//去除      sqlText = sqlText.Replace(--, );//去除--      sqlText = sqlText.Replace(, );//去除      sqlText = sqlText.Replace(\, );//去除      sqlText = sqlText.Replace(=, );//去除=      sqlText = sqlText.Replace(%, );//去除%      sqlText = sqlText.Replace( , );//去除空格      return sqlText;    }  #endregion    #region 是否由特定字符组成    public static bool isContainSameChar(string strInput)    {      string charInput = string.Empty;      if (!string.IsNullOrEmpty(strInput))      {        charInput = strInput.Substring(0, 1);      }      return isContainSameChar(strInput, charInput, strInput.Length);    }    public static bool isContainSameChar(string strInput, string charInput, int lenInput)    {      if (string.IsNullOrEmpty(charInput))      {        return false;      }      else      {        Regex RegNumber = new Regex(string.Format(^([{0}])+$, charInput));        //Regex RegNumber = new Regex(string.Format(^([{0}]{{1}})+$, charInput,lenInput));        Match m = RegNumber.Match(strInput);        return m.Success;      }    }    #endregion    #region 检查输入的参数是不是某些定义好的特殊字符：这个方法目前用于密码输入的安全检查    /// summary    /// 检查输入的参数是不是某些定义好的特殊字符：这个方法目前用于密码输入的安全检查    /// /summary    public static bool isContainSpecChar(string strInput)    {      string[] list = new string[] { 123456, 654321 };      bool result = new bool();      for (int i = 0; i  list.Length; i++)      {        if (strInput == list[i])        {          result = true;          break;        }      }      return result;    }    #endregion  }'>页面数据校验类</a>&nbsp;&nbsp;&nbsp;&nbsp;<span>16-1-28 上午 12:00:00</span></li><li><span>55</span>&nbsp;&nbsp;<a class='btn btn-link' style='color: blue' href='../../../../../Artlcle/vip/5955163E-1CAD-4F79-B20D-A894CE611390.html' title='using System;using System.Collections;using System.Collections.Specialized;using System.Data;using System.Data.OleDb;using System.Configuration;namespace Maticsoft.DBUtility{  /// summary  /// 数据访问基础类(基于OleDb) Copyright (C) Maticsoft  /// 可以用户可以修改满足自己项目的需要。  /// /summary  public abstract class DbHelperOleDb  {    //数据库连接字符串(web.config来配置)，可以动态更改connectionString支持多数据库.      public static string connectionString = PubConstant.ConnectionString;         public DbHelperOleDb()    {    }    #region 公用方法       public static int GetMaxID(string FieldName, string TableName)    {      string strsql = select max( + FieldName + )+1 from  + TableName;      object obj = DbHelperSQL.GetSingle(strsql);      if (obj == null)      {        return 1;      }      else      {        return int.Parse(obj.ToString());      }    }    public static bool Exists(string strSql)    {      object obj = DbHelperSQL.GetSingle(strSql);      int cmdresult;      if ((Object.Equals(obj, null)) || (Object.Equals(obj, System.DBNull.Value)))      {        cmdresult = 0;      }      else      {        cmdresult = int.Parse(obj.ToString());      }      if (cmdresult == 0)      {        return false;      }      else      {        return true;      }    }    public static bool Exists(string strSql, params OleDbParameter[] cmdParms)    {      object obj = GetSingle(strSql, cmdParms);      int cmdresult;      if ((Object.Equals(obj, null)) || (Object.Equals(obj, System.DBNull.Value)))      {        cmdresult = 0;      }      else      {        cmdresult = int.Parse(obj.ToString());      }      if (cmdresult == 0)      {        return false;      }      else      {        return true;      }    }       #endregion    #region 执行简单SQL语句    /// summary    /// 执行SQL语句，返回影响的记录数    /// /summary    /// param name=SQLStringSQL语??lt;/param    /// returns影响的记录数/returns    public static int ExecuteSql(string SQLString)    {      using (OleDbConnection connection = new OleDbConnection(connectionString))      {        using (OleDbCommand cmd = new OleDbCommand(SQLString, connection))        {          try          {            connection.Open();            int rows = cmd.ExecuteNonQuery();            return rows;          }          catch (System.Data.OleDb.OleDbException E)          {            connection.Close();            throw new Exception(E.Message);          }        }      }    }    /// summary    /// 执行多条SQL语句，实现数据库事务。    /// /summary    /// param name=SQLStringList多条SQL语句/param      public static void ExecuteSqlTran(ArrayList SQLStringList)    {      using (OleDbConnection conn = new OleDbConnection(connectionString))      {        conn.Open();        OleDbCommand cmd = new OleDbCommand();        cmd.Connection = conn;        OleDbTransaction tx = conn.BeginTransaction();        cmd.Transaction = tx;        try        {          for (int n = 0; n  SQLStringList.Count; n++)          {            string strsql = SQLStringList[n].ToString();            if (strsql.Trim().Length  1)            {              cmd.CommandText = strsql;              cmd.ExecuteNonQuery();            }          }          tx.Commit();        }        catch (System.Data.OleDb.OleDbException E)        {          tx.Rollback();          throw new Exception(E.Message);        }      }    }    /// summary    /// 执行带一个存储过程参数的的SQL语句。    /// /summary    /// param name=SQLStringSQL语句/param    /// param name=content参数内容,比如一个字段是格式复杂的文章，有特殊符号，可以通过这个方式添加/param    /// returns影响的记录数/returns    public static int ExecuteSql(string SQLString, string content)    {      using (OleDbConnection connection = new OleDbConnection(connectionString))      {        OleDbCommand cmd = new OleDbCommand(SQLString, connection);        System.Data.OleDb.OleDbParameter myParameter = new System.Data.OleDb.OleDbParameter(@content, OleDbType.VarChar);        myParameter.Value = content;        cmd.Parameters.Add(myParameter);        try        {          connection.Open();          int rows = cmd.ExecuteNonQuery();          return rows;        }        catch (System.Data.OleDb.OleDbException E)        {          throw new Exception(E.Message);        }        finally        {          cmd.Dispose();          connection.Close();        }      }    }    /// summary    /// 向数据库里插入图像格式的字段(和上面情况类似的另一种实例)    /// /summary    /// param name=strSQLSQL语句/param    /// param name=fs图像字节,数据库的字段类型为image的情况/param    /// returns影响的记录数/returns    public static int ExecuteSqlInsertImg(string strSQL, byte[] fs)    {      using (OleDbConnection connection = new OleDbConnection(connectionString))      {        OleDbCommand cmd = new OleDbCommand(strSQL, connection);        System.Data.OleDb.OleDbParameter myParameter = new System.Data.OleDb.OleDbParameter(@fs, OleDbType.Binary);        myParameter.Value = fs;        cmd.Parameters.Add(myParameter);        try        {          connection.Open();          int rows = cmd.ExecuteNonQuery();          return rows;        }        catch (System.Data.OleDb.OleDbException E)        {          throw new Exception(E.Message);        }        finally        {          cmd.Dispose();          connection.Close();        }      }    }    /// summary    /// 执行一条计算查询结果语句，返回查询结果（object）。    /// /summary    /// param name=SQLString计算查询结果语句/param    /// returns查询结果（object）/returns    public static object GetSingle(string SQLString)    {      using (OleDbConnection connection = new OleDbConnection(connectionString))      {        using (OleDbCommand cmd = new OleDbCommand(SQLString, connection))        {          try          {            connection.Open();            object obj = cmd.ExecuteScalar();            if ((Object.Equals(obj, null)) || (Object.Equals(obj, System.DBNull.Value)))            {              return null;            }            else            {              return obj;            }          }          catch (System.Data.OleDb.OleDbException e)          {            connection.Close();            throw new Exception(e.Message);          }        }      }    }    /// summary    /// 执行查询语句，返回OleDbDataReader    /// /summary    /// param name=strSQL查询语句/param    /// returnsOleDbDataReader/returns    public static OleDbDataReader ExecuteReader(string strSQL)    {      OleDbConnection connection = new OleDbConnection(connectionString);      OleDbCommand cmd = new OleDbCommand(strSQL, connection);      try      {        connection.Open();        OleDbDataReader myReader = cmd.ExecuteReader();        return myReader;      }      catch (System.Data.OleDb.OleDbException e)      {        throw new Exception(e.Message);      }    }    /// summary    /// 执行查询语句，返回DataSet    /// /summary    /// param name=SQLString查询语句/param    /// returnsDataSet/returns    public static DataSet Query(string SQLString)    {      using (OleDbConnection connection = new OleDbConnection(connectionString))      {        DataSet ds = new DataSet();        try        {          connection.Open();          OleDbDataAdapter command = new OleDbDataAdapter(SQLString, connection);          command.Fill(ds, ds);        }        catch (System.Data.OleDb.OleDbException ex)        {          throw new Exception(ex.Message);        }        return ds;      }    }    #endregion    #region 执行带参数的SQL语句    /// summary    /// 执行SQL语句，返回影响的记录数    /// /summary    /// param name=SQLStringSQL语句/param    /// returns影响的记录数/returns    public static int ExecuteSql(string SQLString, params OleDbParameter[] cmdParms)    {      using (OleDbConnection connection = new OleDbConnection(connectionString))      {        using (OleDbCommand cmd = new OleDbCommand())        {          try          {            PrepareCommand(cmd, connection, null, SQLString, cmdParms);            int rows = cmd.ExecuteNonQuery();            cmd.Parameters.Clear();            return rows;          }          catch (System.Data.OleDb.OleDbException E)          {            throw new Exception(E.Message);          }        }      }    }    /// summary    /// 执行多条SQL语句，实现数据库事务。    /// /summary    /// param name=SQLStringListSQL语句的哈希表（key为sql语句，value是该语句的OleDbParameter[]）/param    public static void ExecuteSqlTran(Hashtable SQLStringList)    {      using (OleDbConnection conn = new OleDbConnection(connectionString))      {        conn.Open();        using (OleDbTransaction trans = conn.BeginTransaction())        {          OleDbCommand cmd = new OleDbCommand();          try          {            //循环            foreach (DictionaryEntry myDE in SQLStringList)            {              string cmdText = myDE.Key.ToString();              OleDbParameter[] cmdParms = (OleDbParameter[])myDE.Value;              PrepareCommand(cmd, conn, trans, cmdText, cmdParms);              int val = cmd.ExecuteNonQuery();              cmd.Parameters.Clear();              trans.Commit();            }          }          catch          {            trans.Rollback();            throw;          }        }      }    }    /// summary    /// 执行一条计算查询结果语句，返回查询结果（object）。    /// /summary    /// param name=SQLString计算查询结果语句/param    /// returns查询结果（object）/returns    public static object GetSingle(string SQLString, params OleDbParameter[] cmdParms)    {      using (OleDbConnection connection = new OleDbConnection(connectionString))      {        using (OleDbCommand cmd = new OleDbCommand())        {          try          {            PrepareCommand(cmd, connection, null, SQLString, cmdParms);            object obj = cmd.ExecuteScalar();            cmd.Parameters.Clear();            if ((Object.Equals(obj, null)) || (Object.Equals(obj, System.DBNull.Value)))            {              return null;            }            else            {              return obj;            }          }          catch (System.Data.OleDb.OleDbException e)          {            throw new Exception(e.Message);          }        }      }    }    /// summary    /// 执行查询语句，返回OleDbDataReader    /// /summary    /// param name=strSQL查询语句/param    /// returnsOleDbDataReader/returns    public static OleDbDataReader ExecuteReader(string SQLString, params OleDbParameter[] cmdParms)    {      OleDbConnection connection = new OleDbConnection(connectionString);      OleDbCommand cmd = new OleDbCommand();      try      {        PrepareCommand(cmd, connection, null, SQLString, cmdParms);        OleDbDataReader myReader = cmd.ExecuteReader();        cmd.Parameters.Clear();        return myReader;      }      catch (System.Data.OleDb.OleDbException e)      {        throw new Exception(e.Message);      }    }    /// summary    /// 执行查询语句，返回DataSet    /// /summary    /// param name=SQLString查询语句/param    /// returnsDataSet/returns    public static DataSet Query(string SQLString, params OleDbParameter[] cmdParms)    {      using (OleDbConnection connection = new OleDbConnection(connectionString))      {        OleDbCommand cmd = new OleDbCommand();        PrepareCommand(cmd, connection, null, SQLString, cmdParms);        using (OleDbDataAdapter da = new OleDbDataAdapter(cmd))        {          DataSet ds = new DataSet();          try          {            da.Fill(ds, ds);            cmd.Parameters.Clear();          }          catch (System.Data.OleDb.OleDbException ex)          {            throw new Exception(ex.Message);          }          return ds;        }      }    }    private static void PrepareCommand(OleDbCommand cmd, OleDbConnection conn, OleDbTransaction trans, string cmdText, OleDbParameter[] cmdParms)    {      if (conn.State != ConnectionState.Open)        conn.Open();      cmd.Connection = conn;      cmd.CommandText = cmdText;      if (trans != null)        cmd.Transaction = trans;      cmd.CommandType = CommandType.Text;//cmdType;      if (cmdParms != null)      {        foreach (OleDbParameter parm in cmdParms)          cmd.Parameters.Add(parm);      }    }    #endregion   }}'>DbHelperOleDb</a>&nbsp;&nbsp;&nbsp;&nbsp;<span>16-1-28 上午 12:00:00</span></li><li><span>56</span>&nbsp;&nbsp;<a class='btn btn-link' style='color: blue' href='../../../../../Artlcle/vip/EC530458-31FE-4E0B-9E0D-CEC9E3A85D30.html' title='NPOI使用手册目录1.认识NPOI2.使用NPOI生成xls文件2.1创建基本内容2.1.1创建Workbook和Sheet2.1.2创建DocumentSummaryInformation和SummaryInformation2.1.3创建单元格2.1.5创建批注2.1.6创建页眉和页脚2.2单元格操作2.2.1设置格式2.2.2合并单元格2.2.3对齐相关设置2.2.4使用边框2.2.5字体设置2.2.6背景和纹理2.2.7设置宽度和高度2.3使用Excel公式2.3.1基本计算2.3.2 SUM函数2.3.3日期函数2.3.4字符串相关函数2.3.5 IF函数2.3.6 CountIf和SumIf函数2.3.7 Lookup函数2.3.8随机数函数2.3.9通过NPOI获得公式的返回值2.4创建图形2.4.1画线2.4.2画矩形2.4.3画圆形2.4.4画Grid2.4.5插入图片2.5打印相关设置2.6高级功能2.6.1调整表单显示比例2.6.2设置密码2.6.3组合行、列2.6.4锁定列2.6.5显示/隐藏网格线2.6.6设置初始视图的行、列2.6.7数据有效性2.6.8生成下拉式菜单3.项目实践3.1基于.xls模板生成Excel文件3.2生成九九乘法表3.3生成一张工资单3.4从xls文件中抽取文本3.5巧妙使用ExcelChart3.6导入Excel文件NPOI 1.2教程- 1认识NPOI本章将介绍NPOI的一些基本信息，包括以下几个部分·什么是NPOI·版权说明·相关资源·团队介绍·未来展望·各Assembly的作用1.1什么是NPOINPOI，顾名思义，就是POI的.NET版本。那POI又是什么呢？POI是一套用Java写成的库，能够帮助开发者在没有安装微软Office的情况下读写Office 97-2003的文件，支持的文件格式包括xls, doc, ppt等。在本文发布时，POI的最新版本是3.5 beta 6。NPOI 1.x是基于POI 3.x版本开发的，与poi 3.2对应的版本是NPOI 1.2，目前最新发布的版本是1.2.1，在该版本中仅支持读写Excel文件和Drawing格式，其他文件格式将在以后的版本中得到支持。1.2版权说明NPOI采用的是Apache 2.0许可证（poi也是采用这个许可证），这意味着它可以被用于任何商业或非商业项目，你不用担心因为使用它而必须开放你自己的源代码，所以它对于很多从事业务系统开发的公司来说绝对是很不错的选择。当然作为一个开源许可证，肯定也是有一些义务的，例如如果你在系统中使用NPOI，你必须保留NPOI中的所有声明信息。对于源代码的任何修改，必须做出明确的标识。完整的apache 2.0许可证请见http://www.phpx.com/man/Apache-2/license.html1.3相关资源官方网站：http://npoi.codeplex.com/POIFS Browser 1.2下载地址：http://npoi.codeplex.com/Release/ProjectReleases.aspx?ReleaseId=24305QQ交流群: 781425901.4团队介绍Tony Qu来自于中国上海，是这个项目的发起人和开发人员，时区是GMT+8，2008年9月开始了NPOI的开发，负责NPOI所有底层库的开发、测试和bug修复。个人blog地址为http://tonyqus.cnblogs.com/HüseyinTüfekilerli来自于土耳其的伊斯坦布尔，也是这个项目的开发人员，时区是GMT+2，2008年11月参与了NPOI的开发，主要负责POIFS Browser 1.0的开发工作。个人blog地址为http://huseyint.com/aTao.Xiang，来自中国，2009年8月开始参与该项目，主要参与了NPOI 1.2中文版的撰写工作和推广工作个人blog地址为http://www.cnblogs.com/atao/1.5回顾与展望目前POI版本中的HWPF（用于Word的读写库）还不是很稳定，并非正式发布版本，且负责HWPF的关键开发人员已经离开，所以NPOI可能考虑自己重新开发HWPF。另外，目前微软正在开发Open XML Format SDK，NPOI可能会放弃对ooxml的支持，当然这取决于用户的需求和Open XML Format SDK的稳定性和速度。从目前而言，NPOI有几大优势第一，完全基于.NET 2.0，而非.NET 3.0/3.5。第二，读写速度快（有个国外的兄弟回复说，他原来用ExcelPackage生成用了4-5个小时，现在只需要4-5分钟）第三，稳定性好（相对于用Office OIA而言，毕竟那东西是基于Automation做的，在Server上跑个Automation的东西，想想都觉得可怕），跑过了将近1000个测'>NPOI使用手册</a>&nbsp;&nbsp;&nbsp;&nbsp;<span>16-1-18 上午 12:00:00</span></li><li><span>57</span>&nbsp;&nbsp;<a class='btn btn-link' style='color: blue' href='../../../../../Artlcle/vip/74A8E39F-DC89-4BD1-954D-1E698BF24586.html' title='using System;using System.IO;using System.Data;using iTextSharp.text.pdf;using iTextSharp.text.pdf.parser;namespace RoadFlow.App_Code{  public static class ReadPDF  {    /// summary    /// 读取PDF内容    /// /summary    /// param name=Path读取PDF文件地址/param    /// param name=Page开始都去页码/param    /// returns/returns    public static string GetPdfContent(string Path)    {      PdfReader pdfReader = new PdfReader(Path);      string Content = string.Empty;      string FilterValue = string.Empty;      string newContent = string.Empty;      PdfReader pdfReader1 = new PdfReader(Path);      int PDFPage = Convert.ToInt32(pdfReader1.NumberOfPages);      Content = PdfTextExtractor.GetTextFromPage(pdfReader, PDFPage);      newContent = Content.Remove(20);      if (Path.Contains(ZH.pdf))      {        Content = PdfTextExtractor.GetTextFromPage(pdfReader, PDFPage - 1);        FilterValue = 号 号 号 号;        Content = Content.Substring(Content.LastIndexOf(FilterValue) + FilterValue.Length);        int c = PDFPage - 1;        Content = Content.Remove(Content.IndexOf(页  + c +  of  + PDFPage +  ));        Content = newContent + Content;        Content = Content.Replace(采购订单号/日期, );      }      else      {        FilterValue = Usage Document Type Lang Ver Description;        Content = Content.Substring(Content.LastIndexOf(FilterValue) + FilterValue.Length);        Content = Content.Remove(Content.IndexOf(__________________));        Content = newContent + Content;        Content = Content.Replace(PO number,  );      }      return Content;    }    /// summary    /// 读取PDF转换成DataTable    /// /summary    /// param name=Path/param    /// returns/returns    public static DataTable GetPDF(string Path)    {      DataTable dt = new DataTable();      dt.Columns.Add(PoNumber);      dt.Columns.Add(Item);      dt.Columns.Add(Material);      dt.Columns.Add(Usage);      dt.Columns.Add(Document);      dt.Columns.Add(Type);      dt.Columns.Add(Ver);      dt.Columns.Add(Lang);      dt.Columns.Add(Description);      DataRow dr;      string content = GetPdfContent(Path);      string[] lis = content.Split( );      dr = dt.NewRow();      if (lis[1].ToString() != )      {        dr[PoNumber] = lis[1].ToString();      }      else      {        dr[PoNumber] = lis[2].ToString();      }      dr[Item] = lis[5].ToString();      dr[Material] = lis[6].ToString();      dr[Usage] = lis[7].ToString() + lis[8].ToString() + lis[9].ToString() + lis[10].ToString() + lis[11].ToString() + lis[12].ToString();      dr[Document] = lis[13].ToString();      dr[Type] = lis[14].ToString();      dr[Ver] = lis[15].ToString();      dr[Lang] = lis[16].ToString();      dr[Description] = lis[17].ToString();      dt.Rows.Add(dr);      dr = dt.NewRow();      dr[Item] = lis[20].ToString();      dr[Material] = lis[21].ToString();      dr[Usage] = lis[22].ToString() + lis[23].ToString() + lis[24].ToString() + lis[25].ToString() + lis[26].ToString() + lis[27].ToString() + lis[28].ToString();      dr[Document] = lis[29].ToString();      dr[Type] = lis[30].ToString();      dr[Ver] = lis[31].ToString();      dr[Lang] = lis[32].ToString();      dr[Description] = lis[33].ToString();      dt.Rows.Add(dr);      return dt;    }    /// summary    /// 读取PDF转换成string    /// /summary    /// param name=Path/param    /// returns/returns    public static string ReturnPDFContent(string Path)    {      string Str = string.Empty;      if (System.IO.Path.GetFileNameWithoutExtension(Path).ToUpper().Contains(PO)  System.IO.Path.GetExtension(Path).ToUpper()==.PDF)      {        #region 开始获取Pdf内容        DocumentPDF pdf = new DocumentPDF();        string content = GetPdfContent(Path);        string[] lis = content.Split( );        if (lis[1].ToString() != )        {          pdf.PoNumber = lis[1].ToString();        }        else        {          pdf.PoNumber = lis[2].ToString();        }        pdf.Item = lis[5].ToString();        pdf.Material = lis[6].ToString();        pdf.Usage = lis[7].ToString() + lis[8].ToString() + lis[9].ToString() + lis[10].ToString() + lis[11].ToString() + lis[12].ToString();        pdf.Document = lis[13].ToString();        pdf.Type = lis[14].ToString();        pdf.Ver = lis[15].ToString();        pdf.Lang = lis[16].ToString();        pdf.Description = lis[17].ToString();        Str = pdf.PoNumber + | + pdf.Item + | + pdf.Material + | + pdf.Usage + | + pdf.Document + | + pdf.Type + | + pdf.Ver + | + pdf.Lang + | + pdf.Description + |;        pdf.Item = lis[20].ToString();        pdf.Material = lis[21].ToString();        pdf.Usage = lis[22].ToString() + lis[23].ToString() + lis[24].ToString() + lis[25].ToString() + lis[26].ToString() + lis[27].ToString() + lis[28].ToString();        pdf.Document = lis[29].ToString();        pdf.Type = lis[30].ToString();        pdf.Ver = lis[31].ToString();        pdf.Lang = lis[32].ToString();        pdf.Description = lis[33].ToString();        Str += pdf.Item + | + pdf.Material + | + pdf.Usage + | + pdf.Document + | + pdf.Type + | + pdf.Ver + | + pdf.Lang + | + pdf.Description;        #endregion      }      return Str;    }  }  public class DocumentPDF  {    public string Item { get; set; }    public string Material { get; set; }    public string Usage { get; set; }    public string Document { get; set; }    public string Type { get; set; }    public string Ver { get; set; }    public string Lang { get; set; }    public string Description { get; set; }    public string PoNumber { get; set; }  }}'>c#使用iTextSharp接口解析PDF文档指定内容实例</a>&nbsp;&nbsp;&nbsp;&nbsp;<span>15-12-22 上午 12:00:00</span></li><li><span>58</span>&nbsp;&nbsp;<a class='btn btn-link' style='color: blue' href='../../../../../Artlcle/vip/97440732-6F8A-45AF-A006-7CC31D299F1B.html' title='开源代码2004/1220－PDF格式/文件相关最近研究PDF的生成和解析，PDF文档是网络上最好的复合文件格式。关于PDF的代码，真是多得不得了，光http://www.sourceforge.net上C#写的就超过8个，Java/PHP等不同语言写的版本就更加多了。以下代码，如果无额外说明，皆为C#开发。1、iTextSharp，类库，创建PDF、RTF、XML等，并可解析PDF，功能最强，2、Report.NET，类库，创建PDF，不错，3、sharpPDF，类库，创建PDF，不错，4、iTextdotNET，J#, 类库，创建PDF，与Java原版最能保持更新同步，5、PDFCreator，VB6写的程序，图形化创建PDF最佳，6、ApdfForms Parser，类库，PDF解析器，效果不错，7、pdfLibrary for creatingpdfwith tables and text, in C#，类库，轻量级的创建，效果不错，8、PdfCreator v1.1，同上，9、pdfizer, a dumb HTML topdfconverter, in C#，转换HTML到PDF，效果不错，10、Generate Thumbnail Images frompdfDocuments，VB.NET写的把PDF页内容生成缩略图，效果不错，11、TEXT topdfConverter in .NET using Reporter.NET，利用Report.NET把纯文本转换成为PDF，12、pdfcreation using C# (and Office) from RTF/DOC files，从RTF/Doc文件中生产PDF文件，13、Generatepdfdocuments from a HTML page using ASP.NET，使用ASP.NET把HTML生成PDF，'>开源代码2004/1220－PDF格式/文件相关</a>&nbsp;&nbsp;&nbsp;&nbsp;<span>15-12-22 上午 12:00:00</span></li><li><span>59</span>&nbsp;&nbsp;<a class='btn btn-link' style='color: blue' href='../../../../../Artlcle/vip/51738A09-D443-4711-A590-457C6191F06E.html' title='#region内存回收[DllImport(kernel32.dll,EntryPoint=SetProcessWorkingSetSize)]publicstaticexternintSetProcessWorkingSetSize(IntPtrprocess,intminSize,intmaxSize);///summary///释放内存////summarypublicstaticvoidClearMemory(){GC.Collect();GC.WaitForPendingFinalizers();if(Environment.OSVersion.Platform==PlatformID.Win32NT){App.SetProcessWorkingSetSize(System.Diagnostics.Process.GetCurrentProcess().Handle,-1,-1);}}#endregion'>C# Winform 内存回收 释放内存</a>&nbsp;&nbsp;&nbsp;&nbsp;<span>15-12-16 上午 12:00:00</span></li><li><span>60</span>&nbsp;&nbsp;<a class='btn btn-link' style='color: blue' href='../../../../../Artlcle/vip/BEB8120C-4766-4326-AAF6-D208FD95311A.html' title='using System;using System.Threading;using System.Windows.Forms;namespace WindowsFormsApplication1{  public partial class Form1 : Form  {    public Form1()    {      InitializeComponent();      CheckForIllegalCrossThreadCalls = false;// 设为false以后，那么我们的控件夸线程访问也不会报异常了    }    private void Form1_Load(object sender, EventArgs e)    {      Thread thread = new Thread(new ParameterizedThreadStart(Run));//窗口加载的时候 开启一个子线程      thread.Start();    }    //创建一个委托方法 run    private void Run(object obj)    {      int count = 10000;      //这里写我们子线程的代码      while (true)      {        Thread.Sleep(200);//让当前线程在这里就是子线程        count--;        label1.Text = count.ToString();      }    }  }}'>Winform多线程防止界面假死</a>&nbsp;&nbsp;&nbsp;&nbsp;<span>15-12-16 上午 12:00:00</span></li><li><span>61</span>&nbsp;&nbsp;<a class='btn btn-link' style='color: blue' href='../../../../../Artlcle/vip/1B781332-81CC-4898-96AC-04DBF2AFB4FB.html' title='在环境搭建好之后，我们就来学习一下怎样快速创建一个流程，并执行和流转该流程（我们这里讲的只是入门，不涉及到具体流程参数设置）。创建一个流程步骤为:在数据库在创建表--设计表单--设置流程--配置菜单 即可点击新配置的菜单运行该流程。1、创建业务数据表　　根据自己的业务需求我们创建自己的业务表：　　　　建表注意事项：　　表必须要有一个主键，主键只能是int型的自增字段或者uniqueidentifier(guid)类型。2、设计表单　　打开表单设计器:　　　　点击新建表单按钮弹出新表单属性设置：　　　　表单名称：为您的表单取一个名称吧。　　数据连接：刚才新建表数据库对应的连接，连接在系统管理--数据库连接里维护。　　数据表：选中刚才新建的表。　　主键：选择表的主键。　　标题字段：表中存储待办已办事项等流程标题的字段，这个字段里的内容将会作为流程标题。　　程序库分类：即表单类别，该类别在数据字典中维护。　　任务标题：是否自动生成标题，如果是则根据 流程名称（发起人）的格式自动生成标题。　　验证提示：弹出(alert) 即window.alert(提示信息的方式)， 图标和提示信息：，图标：只显示错误图标，鼠标移上去之后显示错误信息。　　表单属性设置完成之后即可以点确定后开始设计表单，设计完成之后即可点击红框所示的发布按钮，发布之后表单即进入应用程序库，设计流程时就可以选择该表单作为流程表单了。　　3、设计流程　　点击菜单进入流程设计界面，并点击新建按钮弹出流程基本属性设计框：　　　　在基本信息中设计流程基本属性，具体各项含义将在详细中说明，这里只需要设置流程名称和选定分类即可。　　在数据连接中设置和刚才表单对应的数据连接：　　　　设定好之后即可点 确定 进行流程设计　　　　点击步骤按钮，即可以新建一个步骤，选中一个步骤再点击连接，再到要连接至的步骤上单击即可实现两个步骤之间的连线。　　步骤属性设置：　　　　由于这个是讲快速入门，所以步骤的详细设置和每个参数的意义将在后面说明，这里只需要设置好步骤名称，和选定刚才设计好的表单即可。　　配置相关按钮：　　　　在按钮标签栏配置当前步骤可执行的操作的相应按钮，普通步骤一般配置发送按钮，最后一步要配置完成按钮来结束流程。　　流程设计完之后即可点工具栏中的 ：安装来发布该流程。　　流程安装发布之后即进入应用程序库中，下一步只需将流程配置为菜单即可开始运行了。4、配置菜单　　　　点设置应用即弹出该角色的菜单配置界面：　　　　然后在关联程序中选中刚才设计的流程：　　　　这里要注意：关联程序绑定到的是设计的流程，不是设计的表单　　这样即把刚才设计的流程配置为菜单，点击该菜单即可发起该流程的新实例：　　　　至此一个新流程设计即完成。复杂流程配置请关注后面教程。'>.NET工作流RoadFlow-快速入门</a>&nbsp;&nbsp;&nbsp;&nbsp;<span>15-12-15 上午 12:00:00</span></li><li><span>62</span>&nbsp;&nbsp;<a class='btn btn-link' style='color: blue' href='../../../../../Artlcle/vip/0652BA54-71EB-4977-AFA6-5DE049625D11.html' title='.NET开源工作流RoadFlow-系统布署及注意事项非常感谢您在百忙之中抽空来了解RoadFlow，下面我们说一下如果在自己本地搭建环境吧。1、环境要求　　数据库：sqlserver2005以上版本。服务器：IIS6.0以上，或iisexpress。dotNetFramework4.0以上。 如果要编辑或修改代码还需要vs2012以上。2、源代码获取　　RoadFlow源代码公开网站为:http://www.cqroad.cn请从官网下载最新版源码后解压到自己指定目录。3、创建数据库　　SqlServer版本要求2005以 。 我们采用SQL脚本的方式来创建表和数据，我们用的sqlserver版本为2012，考虑到很多朋友还在用较低版本的数据库，如果直接提供mdf文件，可能无法还原数据库，所以采用 执行脚本的方式。数据库脚本位于：DB/MSSQL.SQL。首先要自己创建一个数据库，然后再在该库中执行脚本文件即可，创建表和导入初始数据。建立好数据库后需要修改web.config的数据库连接的对应数据库，用户和密码：如果执行脚本中有什么错误提示，可以看表是否建立和数据是否导入，如果有表和数据可以忽略错误。4、建立站点　　如果你是用vs打开，可以直接运行。如果是用iis方式则需要在iis中建立站点。首先要确认您的系统安装的iis服务。建站点的几点注意事项：　　（1）、应用程序池的版本选择：双击对应的应用程序池，选择4.0版本，  　　（2）、应用程序池-高级设置要启动32位模式:5、需要启动的服务　　IIS建立站点后要开启系统的一些必须服务：ASP.NET状态服务　　分布式事务服务：　　　6、经过以上设置之后即可浏览RoadFlow了　　　　默认用户名：xh，密码：111　　登录之后还需要修改一下数据连接：　　至此系统搭建就完成了。　　.NET开源工作流RoadFlow-系统布署中常见错误及处理方法1、未开启asp.net状态服务时会出现以下错误：　　　　解决办法：开启ASP.NET STATE SERVICE服务　　2、未开启应用程序池32位：　　　　解决办法：启用32位　　'>.NET工作流RoadFlow-系统布署</a>&nbsp;&nbsp;&nbsp;&nbsp;<span>15-12-15 上午 12:00:00</span></li><li><span>63</span>&nbsp;&nbsp;<a class='btn btn-link' style='color: blue' href='../../../../../Artlcle/vip/80658AA7-3594-4F35-81AB-7C3A36E65F84.html' title='打开流程设计器点击新建流程后会弹出新流程属性设置框，属性设置包括基本信息，数据连接和标识字段三项设置。1、基本信息　　　　流程ID：系统自动给每个流程分配的一个唯一ID。　　流程名称：给您的新流程取一个名称。　　流程分类：流程的分类管理，此分类在数据字典中维护。　　管理者：指定该流程的管理者，管理者可以修改和删除该流程。　　实例管理者：该流程的实例管理者，管理者可以查看该流程的处理过程和人工干预该流程的流转，如中途指派，强制退回等。　　删除已完成：当流程实例完成后是否从任务表中删除该流程实例的审批过程。　　设计模式：方便流程调试人员测试新流程，如果在后面人员选择中选定了人员为当前流程的调试人员，当该人员走该流程时，会一个人把流程走完，不需要切换账号来测试流程。如果开启了调试窗口，则如果流程在发送过程中有什么错误信息会在调试窗口中输出。　　备注：流程的备注信息。2、数据连接　　指定该流程所对的数据库连接和表，该项选择一般是和表单设置中对应的数据连接和表一致，以便在流程流转过程中控制数据表字段的编辑，显示以及隐藏状态。　　　　如果是包含子表的流程，则子表也要加入到列表中。3、标识字段　　　　标识字段的作用是标记流程实例是否完成的一个标识，选定一个字段来记录该状态，流程在流转过程中该字段内容为NULL，如果流程流转到最后一步完成则会将该字段的值更新为1。　　流程属性设置完成就可以点确定?磁ネ瓿墒粜陨柚茫酉吕淳涂梢钥剂鞒滩街枭柚昧恕?/span>流程属性设置完成后点击确定之后，即可进行流程步骤设置了。点击工具栏上的步骤按钮，即可添加一个新步骤。在新步骤图形上双击即可弹出该步骤相应属性设置框。步骤ID：系统自动为该步骤生成的唯一ID。步骤名称：该步骤的名称。意见显示：是否在审批表单的底部显示历史步骤的审批意见，如果选择了显示则会如下图显示历史意见：审签类型：无签批意见栏：在表单底部没有签批意见栏，该步骤不需要签批意见即可发送，有签批意见栏（无须签章）：在表单底部有签批意见栏，但没有签章按钮，此步骤需要签意见，但不须要签章，有签批意见栏（须签章）：在表单底部有签批意见栏，但没有签章按钮，此步骤需要签意见并且还要签章。效果如下图：　是否归档：该步骤发送之后是否将表单数据存入到档案数据库，以便以后不依赖业务数据表也能查询到当时流程的审批情况。表单：与该步骤绑定的表单，可以是表单设计器设计的表单，也可以是自己通过程序写的表单。只要在应用程序库中存在的应用都可以作为流程表单来进行审批。说明：步骤的说明，该说明同时显示在发送时的界面上。策略设置包括当前步骤的流转方式，处理人员，退回策略等设置。流转类型：当前步骤后面有多个步骤时，此类型选择可以决定后续步骤的发送方式。　　1.系统控制：由系统根据您在线上设置的流转条件来判断该发送到哪一步（线上的条件设置将在后面说明）。　　2.单选一个分支流转：后面有多个步骤时当前处理人员只能选择发送到后面的某一个步骤。　　3.多选几个分支流转：后面有多个步骤时当前处理人员可以多选发送到后面的某几个或全部步骤。运行时选择：是否允许该步骤处理人员在发送到下一步的时候选择接收人员，如果设置为不允许则只能发送给默认设置的处理者，效果如下图：　　　　处理者类型：设定上一步在发送到该步骤时的处理者类型。　　1.所有成员：当前步骤处理者可以是组织机构中的任意类型，可以选择部门，岗位，人员，工作组。如果选择的是部门或岗位则发送到部门或岗位下的所有人。　　2.部门：设定当前步骤的处理者只能是部门，也就是上一步在发送时选择该步骤的接收人的时候只能选择部门。　　3.岗位：设定当前步骤的处理者只能是岗位，上一步在发送到该步骤时接收人处只能选择岗位。　　4.工作组：设定当前步骤的处理者只能是工作组，上一步在发送到该步骤时接收人处只能选择工作组。　　5.人员：设定当前步骤的处理者只能是人员，上一步在发送到该步骤时接收人处只能选择人员，不能选择部门岗位等类型。　　6.发起者：设定当前步骤的处理者为当前流程实例的发起人员。　　7.前一步骤处理者：当前步骤的处理者为前一步骤的处理人员。　　8.某一步骤处理者：当前步骤的处理者设定为流程前面某一步的处理人员，该项要结果处理者步骤使用，即要选是哪一步骤的处理者来处理当前步骤。　　　　　　9.字段值：当前处理者步骤为业务表中某个字段存储的组织机构ID字符串。设定了该选项时需要在值字段中选择字段。　　　　　　10.发起者领导：即当前步骤处理者为流程实例发起者的部门领导。　　11.发起者分管领导：当前步骤处理者为流程实例发起者的分管领导，比如张总分管信息部，如果发起者是信息部的人员则此步由张总审核。　　12.前一步处理者领导：当前步骤的前一步处理者的部门分层。　　13.前一步处理者分管领导：当前步骤的前一步处理者的分管领导。选择范围：限定流程处理人员在选择下一步接收人的选择范围。如我们在流程设计时限定了范围为财务部，则在流程发送时只能从财务部中选择接收人员：　　　　处理者步骤：前面处理者类型选择 某一步骤处理者 时在这里选择哪一步的处理者。值字段：前面处理者类型选择 字段值 时在这里选择哪一个字段的值来作为当前步骤的处理者。默认处理者：选择当前步骤的默认处理人员，可以选择部门，岗位，工作组等。退回策略：设置当前步骤的退回方式。　　1.根据处理策略退回：根据设置的处理策略来退回，如一人同意即可，则只要有一人退回，则该步骤的其他处理者也将退回。　　2.不能退回：即设置当前步骤不能退回。处理策略：设置当前步骤的处理策略。　　1.所有人必须同意：如果当前步骤有多个人处理时，所有人都要同意才能发送到下一步，如果其中一人退回，则所有人的待办任务都将退回。　　2.一人同意即可：当前步骤有多人处理时，只要其中一个人处理了就发送到下一步，其他人就不须要再处理了。　　3.依据人数比例：按照下面的 策略百分比 来判断是否发送到下一步。如当有步骤有5人处理，策略设置为50，则只要有3人处理了则会发送到下一步。　　4.独立处理：每个人独立处理，如当前步骤有5人处理，则每个人发送了，下一步处理者都会收到一个待办任务。退回类型：设置当前步骤的退回类型。　　1.退回前一步：退回到当前步骤的前一步，即退回给发送者。　　2.退回某一步：设置退回到当前步骤的前面某一步。选择了此项，则需要在下面的退回步骤中选择要退回的步骤。　　3.退回第一步：即退回给流程发起者。会签策略：如果当前步骤前面有多个步骤时，设置会签的处理策略，策略规则和处理策略类型，只是处理策略是以人为单位来判断，而会签策略是以步骤为单位来判断。　　.NET开源工作流RoadFlow-流程设计-流程步骤设置-按钮设置按钮设置是配置当前步骤的处理者可以执行哪些操作，每个按钮都有对应的执行脚本（javascript脚本）。从左边的按钮列表中选择当前步骤需要的按钮。注意：如果是流程最后一步则要配置完成按钮而不是发送按钮。左边的按钮列表数据来源于：流程管理--按钮管理执行脚本为js脚本，如这里的flowBack();为一个js方法，该方法在common.js文件中。.NET开源工作流RoadFlow-流程设计-流程步骤设置-事件设置事件设置是设置当前步骤在提交前后或退回前后要执行的一些操作（该事件为服务器事件）。事件格式为：dll名称.命名空间名称.类名.方法名，这里不需要写括号和参数，处理时会自动带上当前流程实例的相关参数。参数为：RoadFlow.Data.Model.WorkFlowCustomEventParams类的实例，里面包含当前流程步骤的相关信息。　　FlowID:当前流程ID。　　StepID：当前步骤ID。　　GroupID：当前流程实例的分组ID，一个流程实例的分组ID相同，此ID是为了区分一个流程的不同实例。　　TaskID：当前任务ID。　　InstanceID：当前流程的实例ID，即业务表中的主键ID。.NET开源工作流RoadFlow-流程设计-流转条件设置（路由）当一个步骤后面有多个步骤时，可以设置为根据设置条件系统自动判断该流向哪些步骤，也叫路由。roadflow没有单独的路由步骤来设置条件，流程条件通过双击连线弹出条件设置框来设置。1.sql条件　　即通过sql条件来判断条件是否满足,条件对应的表为流程对应的表。2.组织机构　　通过当前人员在组织机构中的关系来判断条件是否满足。　　3.自定义方法　　　　该方法的使用和参数与步骤中的事件相同。注意：如果要使设置的条件生效需要在步骤设置中将流转类型设置为：系统控制 系统会根据您设置的条件自动判断该发送到哪些步骤。　　.NET开源工作流RoadFlow-流程设计-保存与发布如果流程未设计完时可以先保存，以后再打开接着设计。点击工具栏上的保存按钮即可保存当前流程设计:如果下次要接着设计，则可以打开该流程继续设计：如果流程设计完成，可以点击安装按钮来发布流程，流程安装成功后即加入到了应用程序库，可以通过角色应用来将该流程配置给相应的角色用户使用。'>.NET开源工作流RoadFlow-流程设计操作文档</a>&nbsp;&nbsp;&nbsp;&nbsp;<span>15-12-15 上午 12:00:00</span></li><li><span>64</span>&nbsp;&nbsp;<a class='btn btn-link' style='color: blue' href='../../../../../Artlcle/vip/929E85A6-5101-44BC-A45F-A403DB138A33.html' title='.NET开源工作流RoadFlow-流程运行-菜单配置经过流程设计和表单设计后，一个流程就设置完成了，下面说说怎么让设计好的流程运行起来吧。流程和表单设计完成发布后都在应用程序库里，我们只要将流程在角色应用中配置给相应的用户即可让流程选择了。在系统管理--角色应用--设置应用中打开菜单配置选中要将流程添加到此项的目录点击右边的添加子项按钮，在关联程序中选中刚才安装的新流程（注意这里绑定的是新设计的流程，不是表单）后保存即将新设计的流程配置给了相应的角色，这个角色所有的用户从新登录后即可看到新配置的流程菜单。点击相应的菜单即可发起该流程的新实例：.NET开源工作流RoadFlow-流程运行-工作委托如果某一个人某一段时间不在单位，则可以将自己的工作委托给他人代为处理。在 流程处理--工作委托 中可以管理自己的委托，管理员也可以在 流程管理--工作委托 中管理所有人的委托：委托人：这里是自己管理自己的委托，所以委托人只能是自己，不能选择。被委托人：要把工作委托给谁。开始时间：委托的开始时间。结束时间：委托的结束时间。委托流程：要委托的流程，委托可以添加多条，这样就可以把不同的流程委托给不同的人。备注说明：备注说明信息。.NET开源工作流RoadFlow-流程运行-运行时监控流程实例参与者都可以随时查看流程实例的运行情况，如果是待办任务，则在待办事项列表的后面点查看，如果是已完成任务则可以在已办事项列表的后面点查看：打开之后默认为列表方式显示流程的处理过程，还可以点图形方式，以图形方式查看流程处理进度：.NET开源工作流RoadFlow-流程运行-任务收回如果一个任务则发送，又觉得还要想修改可以立即收回刚刚发送的任务。任务收回条件：任务发送后下一步处理人还没有打开该任务，则在已办事项中会看到 收回 按钮，否则不能收回。点击收回按钮再确认即可收回刚刚发送的任务。.NET开源工作流RoadFlow-流程运行-管理员干预在流程运行过程中管理员可以干预流程实例的走向，如管理加强制退回，指派和删除流程实例操作。在 流程管理--实例管理 中查找到相应的流程实例，点击管理按钮即可管理该流程实例：点击指派按钮，选择要指派的人员，即可将当前待办事项指派给其他人处理：'>.NET开源工作流RoadFlow-流程运行</a>&nbsp;&nbsp;&nbsp;&nbsp;<span>15-12-15 上午 12:00:00</span></li><li><span>65</span>&nbsp;&nbsp;<a class='btn btn-link' style='color: blue' href='../../../../../Artlcle/vip/B0DECB6C-6483-49B1-B473-7DC199F3F59C.html' title='QQ互联第三方登陆 redirect uri is illegal(100010)想必第一次大家接触QQ第三方登陆都会遇到各种各样的问题，备受折磨，因此，今天我把自己做QQ登陆的过程描述一下，希望给大家提供参考，少走弯路。在开发之前，我们先了解下QQ登陆的流程第一：查看熟悉网站接入概述第二：开发者注册 网站接入流程第三：前两步熟悉以后，获取到appid后，即可进行开发了。本次只介绍PC网站接入QQ过程登陆页面放置QQ登陆按钮spanid=qqLoginBtn/spanid可自定义修改，如果样式不对，也可以自定义class，做一些样式控制。在登陆页面引用QQ登陆js库。scripttype=text/javascriptsrc=http://qzonestyle.gtimg.cn/qzone/openapi/qc_loader.jsdata-appid=XXXXdata-redirecturi=http://www.51purse.com/qq_back.htmlcharset=utf-8/scriptdata-appid对应的XXXX需要替换为你自己的appid,上面您完成开发者注册后，即可获取到appid。data-redirecturi为回调地址，后面对应的值是我目前网站的回调页面，大家也可以自己写一个页面。新建空白页面（回调页面）!DOCTYPEhtml  htmlxmlns=http://www.w3.org/1999/xhtml  head  metahttp-equiv=Content-Typecontent=text/html;charset=utf-8/  title我爱分享网，分享从这里起航/title  scripttype=text/javascriptsrc=http://qzonestyle.gtimg.cn/qzone/openapi/qc_loader.jsdata-callback=truecharset=utf-8/script  /head  body    /body  /html大家一定要切记：此处必须是空白页面，就是什么内容都不放，值建一个空的HTML文件，引入sdk文件即可，大家完全可复制我的。登陆页面初始化相关参数，初始化QQ图标，自定义尺寸，传入id。if($(#qqLoginBtn).size()0){  QC.Login({  btnId:qqLoginBtn,//插入按钮的html标签id  size:A_M,//按钮尺寸  scope:get_user_info,//展示授权，全部可用授权可填all  display:pc//应用场景，可选  },function(reqData,opts){  document.cookie=flag=2;  window.location.href=welcome.html;  });  }此处代码，引入到登陆页面中，初始化的时候，就会加载QQ图片到按钮上去。function(reqData,opts){}方法，即为登陆成功后的回调，登陆成功以后，我这边会手动让他回到主页面，因为我是JS开发者，做的是单页面应用，所以只能自己手动回到主页面，当然，大家其它语言的，可以直接通过action跳转到主页面。在主页面（welcome.html）同样需要引用sdk文件库，如果QQ按钮和主页面在同一个页面的话，只需要引入一次即可，比如某些论坛。scripttype=text/javascriptsrc=http://qzonestyle.gtimg.cn/qzone/openapi/qc_loader.jsdata-appid=XXXXdata-redirecturi=http://www.51purse.com/qq_back.htmlcharset=utf-8/script此处代码，同登陆页面一样，大家直接复制过去即可。登陆成功后，大家需要调用QQ的API来获取用户的资料信息，方便在自己网站上展示，同时可将相关字段存入自己的数据库，以维护用户的数据。//判断当前用户是否登陆if(QC.Login.check()){//如果已登录  //用JSSDK调用OpenAPI，此处可获得openId,accessToken  QC.Login.getMe(function(openId,accessToken){//调用get_user_info接口，可得到用户的资料信息,此处不需要传入任何参数，因为QQapi会自动带入参数  QC.api(get_user_info,{}).success(function(rep){varnickName=rep.data.nickname;vargender=rep.data.gender;varfigureurl=rep.data.figureurl;  $(#currentUserNickName).text(rep.data.nickname);  });  });  }else{  document.cookie=flag=1;expires=+newDate(0).toUTCString();  window.location.href=login.html;  }此代码可以获取用户资料信息，同时也可以?袢〉給penId和accessToken。到此基本QQ第三方登陆就结束了，另外一个非常重要的地方是，在您个人的管理中心中，申请appid的地方，需要将回调地址，改成和上面建的空白页面的地址一样即为：http://www.51purse.com/qq_back.html，切记，必须这么写，否则，登陆会报错（redirect uri is illegal(100010)），这一点我深有体会，官网的Demo是有问题的，我查阅了很多资料都无法解决，我总以后是登陆成功后的页面，所以，我之前填的是主页面，可是怎么弄都不想，必须是之前建的空白页面。以上7条基本可以实现完整的QQ登陆了。下面给大家补充一下get_user_info接口的返回数据，大家其实也可以去查看API文档，我这边稍微提一下。get_user_info接口    ret返回码  msg如果ret0，会有相应的错误信息提示，返回数据全部用UTF-8编码。  nickname用户在QQ空间的昵称。  figureurl大小为30×30像素的QQ空间头像URL。  figureurl_1大小为50×50像素的QQ空间头像URL。  figureurl_2大小为100×100像素的QQ空间头像URL。  figureurl_qq_1大小为40×40像素的QQ头像URL。  figureurl_qq_2大小为100×100像素的QQ头像URL。需要注意，不是所有的用户都拥有QQ的100x100的头像，但40x40像素则是一定会有。  gender性别。如果获取不到则默认返回男is_yellow_vip标识用户是否为黄钻用户（0：不是；1：是）。  vip标识用户是否为黄钻用户（0：不是；1：是）  yellow_vip_level黄钻等级  level黄钻等级  is_yellow_year_vip标识是否为年费黄钻用户（0：不是；1：是）      {  ret:0,  msg:,  nickname:Peter,  figureurl:http://qzapp.qlogo.cn/qzapp/111111/942FEA70050EEAFBD4DCE2C1FC775E56/30,  figureurl_1:http://qzapp.qlogo.cn/qzapp/111111/942FEA70050EEAFBD4DCE2C1FC775E56/50,  figureurl_2:http://qzapp.qlogo.cn/qzapp/111111/942FEA70050EEAFBD4DCE2C1FC775E56/100,  figureurl_qq_1:http://q.qlogo.cn/qqapp/100312990/DE1931D5330620DBD07FB4A5422917B6/40,  figureurl_qq_2:http://q.qlogo.cn/qqapp/100312990/DE1931D5330620DBD07FB4A5422917B6/100,  gender:男,  is_yellow_vip:1,  vip:1,  yellow_vip_level:7,  level:7,  is_yellow_year_vip:1  }。。最好给大家提供几个地址：sdk下载地址api文档列表地址'>第一次做QQ互联第三方登陆,遇到各种各样的问题，备受折磨，因此，今天我把自己做QQ登陆的过程描述</a>&nbsp;&nbsp;&nbsp;&nbsp;<span>15-12-13 上午 12:00:00</span></li><li><span>66</span>&nbsp;&nbsp;<a class='btn btn-link' style='color: blue' href='../../../../../Artlcle/vip/9E66EA88-F482-43F4-AC0C-310F262C2D3E.html' title='//不加时间限制永不过期，只有IIS重启后才过期protected void Page_Load(object sender, EventArgs e){ //Cache[date]=要缓存的数据;  这里是自定义缓存的简单声明使用 string datastr = Label1.Text; Response.Write(第一个输出时间: + datastr + /br); //这里读取的当前的时间，刷新页面时，这里的时,会随着变化。 if (Cache[date] == null) //判断是否存在value值为date的缓存是否存在  {  Cache[date] = datastr;  Response.Write(第二个输出时间为： + Cache[date] + 这里读取的当前的时间);  //这里读取的当前的时间，刷新页面时，这里的时间会随着变化。  }   else   {   Response.Write(Cache[date] + 这里是从缓存中读取的时间);//这里读取的缓存中的时间，刷新页面时，这里的随着时间变化，不会变化。   } }protected void Page_Load(object sender, EventArgs e){string ids = Label1.Text; ids = ids + 完; //这里的ids为从数据库中读取表中的id值然后用--链接起来的一个字符串 if (Cache[key] == null) { Cache.Insert(key, ids, null, DateTime.Now.AddSeconds(10),     System.Web.Caching.Cache.NoSlidingExpiration); //这里给数据加缓存，设置缓存时间        //key为缓存的键，ids为缓存起来的值,null为缓存依赖项，这里没有使用缓存依赖项，所以为null，下面会详细介绍缓存依赖项        //null后面为缓存的时间为40秒        //最后一个参数为设置时间的格式，ASP.NET允许你设置一个绝对过期时间或滑动过期时间，但不能同时使用，        //我们这里设置的为绝对过期时间，也就是没刷新一次页面后缓存数据为40秒，40秒后会从数据库中重新获取。  Response.Write(cache加载为--- + Cache[key] + /br);  }  else  {   Response.Write(cache加载为--- + Cache[key] + /br);   }   Response.Write(直接加载为--- + ids + /br);}'>ASP.NET Cache缓存实例引用案例永不过期和限定时间过期</a>&nbsp;&nbsp;&nbsp;&nbsp;<span>15-12-12 上午 12:00:00</span></li><li><span>67</span>&nbsp;&nbsp;<a class='btn btn-link' style='color: blue' href='../../../../../Artlcle/vip/99AB2A28-DD44-4CC8-A183-1CB64B04C12D.html' title='?? 网站目前www的域名下用户访问到的其实可能有两个版本，一个是带www的，一个是不带www的????根域名，带“www”的域名做主站是互联网人习惯的网站建设形式，也是中国人习惯的认为的主页。通常网站带www和不带www的都要做解析。但是两个都解析后，产生一个问题，即搜索引擎认为这是两个站点。为了自己网站的权重集中以及对搜索引擎的友好，我们需要做301重定向，比较好的处理方式是把根域名301到带www的域名下代码实现方法：?????在首页的Page_Load事件中增加如下代码即可Page_Load{Response.Status = 301 Moved Permanently;      Response.AddHeader(Location,Request.Url.ToString().Replace(http://,http://www.));}'>asp.net网站把不带WWW域名定向到带WWW域名下代码实现方法</a>&nbsp;&nbsp;&nbsp;&nbsp;<span>15-12-10 上午 12:00:00</span></li><li><span>68</span>&nbsp;&nbsp;<a class='btn btn-link' style='color: blue' href='../../../../../Artlcle/vip/5A6290E7-295F-4814-8842-F81093C5F90B.html' title='在写记录日志功能时，需要记录日志调用方所在的模块名、命名空间名、类名以及方法名，想到使用的是反射（涉及到反射请注意性能），但具体是哪一块儿还不了解，于是搜索，整理如下：需要添加相应的命名空间：复制代码代码如下:using System;using System.Diagnostics;using System.Reflection;如果仅是获取当前方法名，可以使用如下代码：复制代码代码如下:public static void WriteSysLog(int level, string content){ MethodBase mb = MethodBase.GetCurrentMethod(); string systemModule = Environment.NewLine; systemModule += 模块名: + mb.Module.ToString() + Environment.NewLine; systemModule += 命名空间名: + mb.ReflectedType.Namespace + Environment.NewLine; //完全限定名，包括命名空间 systemModule += 类名: + mb.ReflectedType.FullName + Environment.NewLine; systemModule += 方法名: + mb.Name; Console.WriteLine(LogDate: {0}{1}Level: {2}{1}systemModule: {3}{1}content: {4}, DateTime.Now, Environment.NewLine, level, systemModule, content); Console.WriteLine();}但一般情况下是获取此记录日志方法的调用方，因此需要使用下面的代码：（此方法仅为演示）复制代码代码如下:public static void WriteSysLog(string content){ const int level = 1000; StackTrace ss = new StackTrace(true); //index:0为本身的方法；1为调用方法；2为其上上层，依次类推 MethodBase mb = ss.GetFrame(1).GetMethod(); StackFrame[] sfs = ss.GetFrames(); string systemModule = Environment.NewLine; systemModule += 模块名: + mb.Module.ToString() + Environment.NewLine; systemModule += 命名空间名: + mb.DeclaringType.Namespace + Environment.NewLine; //仅有类名 systemModule += 类名: + mb.DeclaringType.Name + Environment.NewLine; systemModule += 方法名: + mb.Name; Console.WriteLine(LogDate: {0}{1}Level: {2}{1}systemModule: {3}{1}content: {4}, DateTime.Now, Environment.NewLine, level, systemModule, content); Console.WriteLine();}对于这一点儿，感觉有意思的是Main的调用方复制代码代码如下:System.AppDomain._nExecuteAssembly(Assembly assembly, String[] args)通过复制代码代码如下:StackTrace ss = new StackTrace(true);StackFrame[] sfs = ss.GetFrames();可以得知.NET程序的执行顺序：复制代码代码如下:System.Threading.ThreadHelper.ThreadStart()System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state)Microsoft.VisualStudio.HostingProcess.HostProc.RunUsersAssembly()System.AppDomain._nExecuteAssembly(Assembly assembly, String[] args)然后进入方法Main中。另外，从 MethodBase 类 还可以获取很多其他属性，可以自行定位到System.Reflection.MethodBase 查看。使用反射可以遍历获得类的所有属性名,方法名,成员名，其中一个有趣的小例子：通过反射将变量值转为变量名本身。希望本文所述对大家的asp.net程序设计有所帮助。'>ASP.NET中实现获取调用方法名的技巧</a>&nbsp;&nbsp;&nbsp;&nbsp;<span>15-12-8 上午 12:00:00</span></li><li><span>69</span>&nbsp;&nbsp;<a class='btn btn-link' style='color: blue' href='../../../../../Artlcle/vip/369418D0-F843-4D54-95F0-FF33930A4E46.html' title='%@ Page Title= Language=C# MasterPageFile=~/MaterPage/BasePage.Master AutoEventWireup=true CodeBehind=WebForm1.aspx.cs Inherits=share.WebForm1 %%@ Import Namespace=System %%@ Import Namespace=System.IO %%@ Import Namespace=System.Drawing %%@ Import Namespace=System.Drawing.Imaging %asp:Content ID=Content1 ContentPlaceHolderID=cphBlank runat=server  script runat=server 　     void Page_Load(Object sender, EventArgs e)    {      if (!Page.IsPostBack)      {        ImgPreview.Visible = false;      }    }    void GetThumbnailImage(int width, int height, string strInfo, int left, int right)    {      string file = Upload/ + uploadFile.PostedFile.FileName.Substring(uploadFile.PostedFile.FileName.LastIndexOf(\\) + 1);      string newfile = Upload/ + uploadFile.PostedFile.FileName.Substring(uploadFile.PostedFile.FileName.LastIndexOf(\\) + 1) + .jpg;      string strAdd = strInfo;      System.Drawing.Image oldimage = System.Drawing.Image.FromFile(Server.MapPath(file));      System.Drawing.Image thumbnailImage =      oldimage.GetThumbnailImage(width, height, new System.Drawing.Image.GetThumbnailImageAbort(ThumbnailCallback), IntPtr.Zero);      Response.Clear();      Bitmap output = new Bitmap(thumbnailImage);      Graphics g = Graphics.FromImage(output);      g.DrawString(strAdd, new Font(Courier New, 14), new SolidBrush(Color.Red), left, right);      output.Save(Server.MapPath(newfile), System.Drawing.Imaging.ImageFormat.Jpeg);      Response.ContentType = image/gif;      ImgPreview.Visible = true;      ImgPreview.ImageUrl = newfile;    }    bool ThumbnailCallback()    {      return true;    }    void Button_Click(object sender, EventArgs e)    {      int width, height, left, right;      string strAddInfo = txtAddInfo.Text;      width = Int32.Parse(txtWidth.Text);      height = Int32.Parse(txtHeight.Text);      left = Int32.Parse(txtLeft.Text);      right = Int32.Parse(txtRight.Text);      if (!(uploadFile.PostedFile.ContentLength  0))      {        lblErrInfo.Text = 没有选择文件;      }      else      {        string path = Server.MapPath(./Upload/ + uploadFile.PostedFile.FileName.Substring(uploadFile.PostedFile.FileName.LastIndexOf(\\) + 1));        if (File.Exists(path))        {          lblErrInfo.Text = 已经有同名文件;        }        else        {          uploadFile.PostedFile.SaveAs(path);          GetThumbnailImage(width, height, strAddInfo, left, right);        }      }    }  /script  p    input id=uploadFile type=file runat=server /    asp:Label ID=lblErrInfo runat=server ForeColor=Red/asp:Label  /p  p    width:asp:TextBox ID=txtWidth runat=server Width=40px100/asp:TextBox    height:asp:TextBox ID=txtHeight runat=server Width=40px150/asp:TextBox  /p  p    添加信息：asp:TextBox ID=txtAddInfo runat=server AspxBoy.Com/asp:TextBox  /p  p    信息位置：left:asp:TextBox ID=txtLeft runat=server Width=40px10/asp:TextBox    right:asp:TextBox ID=txtRight runat=server Width=40px135/asp:TextBox  /p  p    input id=button type=button value=上传生成所略图 onserverclick=Button_Click runat=server /  /p  p    asp:Image ID=ImgPreview runat=server/asp:Image  /p/asp:Content'>图片上传生成指定大小缩略图并附上文字</a>&nbsp;&nbsp;&nbsp;&nbsp;<span>15-12-8 上午 12:00:00</span></li><li><span>70</span>&nbsp;&nbsp;<a class='btn btn-link' style='color: blue' href='../../../../../Artlcle/vip/13A0FC11-A320-44E2-9E08-35719228003D.html' title='1.弹出对话框.点击转向指定页面Code:Response.Write(scriptwindow.alert(该会员没有提交申请,请重新提交！)/script);Response.Write(scriptwindow.location =http://www.msproject.cn/index.asp/script);2.弹出对话框Code:Response.Write(script language=javascriptalert(产品添加成功！)/script );3.删除文件Code:string filename =20059595157517.jpg;pub.util.DeleteFile(HttpContext.Current.Server.MapPath(../file/)+filename);4.绑定下拉列表框datalistCode:System.Data.DataView dv=conn.Exec_ex(select -1 as code,请选择经营模式 as content from dealin union select code,content from dealin);this.dealincode.DataSource=dv;this.dealincode.DataTextField=content;this.dealincode.DataValueField=code;this.dealincode.DataBind();this.dealincode.Items.FindByValue(dv[0][dealincode].ToString()).Selected=true;5.时间去秒显示Code:%# System.DateTime.Parse(DataBinder.Eval(Container.DataItem,begtime).ToString()).ToShortDateString()%6.标题带链接Code:%# a class=\12c\ target=\_blank\ href=\http://www.51aspx/CV/_+DataBinder.Eval(Container.DataItem,procode)+.html\+ DataBinder.Eval(Container.DataItem,proname)+/a%7.修改转向Code:%# A href=\editpushpro.aspx?id=+DataBinder.Eval(Container.DataItem,code)+\+修改+/A%8.弹出确定按钮Code:%# A id=\btnDelete\ onclick=\return confirm(你是否确定删除这条记录吗?);\ href=\pushproduct.aspx?dl=+DataBinder.Eval(Container.DataItem,code)+\+删除+/A%9.输出数据格式化 {0:F2} 是格式 F2表示小数点后剩两位Code:%# DataBinder.Eval(Container, DataItem.PriceMoney,{0:F2}) %10.提取动态网页内容Code:Uri uri = new Uri(http://www.51aspx.com/);WebRequest req = WebRequest.Create(uri);WebResponse resp = req.GetResponse();Stream str = resp.GetResponseStream();StreamReader sr = new StreamReader(str,System.Text.Encoding.Default);string t = sr.ReadToEnd();this.Response.Write(t.ToString());11.获取 . 后面的字符Code:i.ToString().Trim().Substring(i.ToString().Trim().LastIndexOf(.)+1).ToLower().Trim()12. 打开新的窗口并传送参数：　　传送参数：Code:response.write(scriptwindow.open(*.aspx?id=+this.DropDownList1.SelectIndex+id1=+...+)/script)接收参数：Code:string a = Request.QueryString(id);string b = Request.QueryString(id1);12.为按钮添加对话框Code:Button1.Attributes.Add(onclick,return confirm(确认?));button.attributes.add(onclick,if(confirm(are you sure...?)){return true;}else{return false;})13.删除表格选定记录Code:int intEmpID = (int)MyDataGrid.DataKeys[e.Item.ItemIndex];string deleteCmd = Delete from Employee where emp_id =  + intEmpID.ToString()14.删除表格记录警告Code:private void DataGrid_ItemCreated(Object sender,DataGridItemEventArgs e){　　switch(e.Item.ItemType)　　{　　case ListItemType.Item :　　case ListItemType.AlternatingItem :　　case ListItemType.EditItem:　　TableCell myTableCell;　　myTableCell = e.Item.Cells[14];　　LinkButton myDeleteButton ;　　myDeleteButton = (LinkButton)myTableCell.Controls[0];　　myDeleteButton.Attributes.Add(onclick,return confirm(您是否确定要删除这条信息););　　break;　　default:　　break;　　}}15.点击表格行链接另一页Code:private void grdCustomer_ItemDataBound(object sender, System.Web.UI.WebControls.DataGridItemEventArgs e){　　//点击表格打开　　if (e.Item.ItemType == ListItemType.Item || e.Item.ItemType == ListItemType.AlternatingItem)　　e.Item.Attributes.Add(onclick,window.open(Default.aspx?id= + e.Item.Cells[0].Text + ););}双击表格连接到另一页　　在itemDataBind事件中Code:if(e.Item.ItemType == ListItemType.Item || e.Item.ItemType == ListItemType.AlternatingItem){　　string orderItemID =e.item.cells[1].Text;　　e.item.Attributes.Add(ondblclick, location.href=../ShippedGrid.aspx?id= + orderItemID + );}双击表格打开新一页Code:if(e.Item.ItemType == ListItemType.Item || e.Item.ItemType == ListItemType.AlternatingItem){　　string orderItemID =e.item.cells[1].Text;　　e.item.Attributes.Add(ondblclick, open(../ShippedGrid.aspx?id= + orderItemID + ));}16.表格超连接列传递参数Code:asp:HyperLinkColumn Target=_blank headertext=ID号 DataTextField=id NavigateUrl=aaa.aspx?id=　　%# DataBinder.Eval(Container.DataItem, 数据字段1)%  name=%# DataBinder.Eval(Container.DataItem, 数据字段2)% /17.表格点击改变颜色Code:if (e.Item.ItemType == ListItemType.Item ||e.Item.ItemType == ListItemType.AlternatingItem){　　e.Item.Attributes.Add(onclick,this.style.backgroundColor=#99cc00;　　　 this.style.color=buttontext;this.style.cursor=default;);}写在DataGrid的_ItemDataBound里Code:if (e.Item.ItemType == ListItemType.Item ||e.Item.ItemType == ListItemType.AlternatingItem){e.Item.Attributes.Add(onmouseover,this.style.backgroundColor=#99cc00;　　this.style.color=buttontext;this.style.cursor=default;);e.Item.Attributes.Add(onmouseout,this.style.backgroundColor=;this.style.color=;);}18.关于日期格式　　日期格式设定Code:DataFormatString={0:yyyy-MM-dd}　　我觉得应该在itembound事件中e.items.cell[你的列].text=DateTime.Parse(e.items.cell[你的列].text.ToString(yyyy-MM-dd))Code:<span style="font-family: tahoma, arial, 宋体; font-size: 14px'>Asp.net开发常用的51个非常实用的代码</a>&nbsp;&nbsp;&nbsp;&nbsp;<span>15-12-8 上午 12:00:00</span></li><li><span>71</span>&nbsp;&nbsp;<a class='btn btn-link' style='color: blue' href='../../../../../Artlcle/vip/860F6022-3415-4251-8C43-D65DF08AEA19.html' title='理想化编程测例子还很多，我就拿做接口这个例子说事吧！   现在一般的接口都是给的json格式，Json是一种特殊的字符串（就像string是特殊的引用类型，至于怎样特殊问题留给你了）！XX提供一个接口是一个字符串，然后我问是怎么搞得，他说拼接，此时此刻，大家觉得有问题嘛？   你拼接Json串，总有一天你会感觉到日了狗。。。。（包括在js拼接json串也是一样，一定要拼json对象！一定要拼json对象！一定要拼json对象！重要的事情说三遍！然后再用JSON.parse()和JSON.stringfy()去操作。   XX提供的结构就是一串字符串，为什么不序列化！！！！出现占位符怎么样？XX曰：我们数据不会出现！这么肯定？这就是理想化编程的可怕！   我跟到底层原来写的这么鬼：publicstringToJson()  {returnstring.Format({{\para1\:{0},\para2\:{1},\para3\:{2}}},para1,para2,para3);  }   此时我已无力吐槽。。。。为什么不序列化(Serialization)成json?   下面还有关于反序列化成model。为什么用强转？强转为什么不加Try catch？   LModel codelist = (Model)JsonConvert.DeserializeObject(strJson, typeof(Model));   其实也没必要用Try catch，用as就行   关于强转和as的区别：强制类型转换：转换不成功会抛出异常，对引用类型和值类型都适用。as运算符：转换不成功得到一个null值，不会抛出异常；仅适用于引用类型，不能用于值类型。   LModel codelist = JsonConvert.DeserializeObject(strJson, typeof(Model)) as model;  这不就OK了。。。。 做接口要注意的地方（一家之言，欢迎拍砖）：  1，标准的接口文档和标准的接口数据；  2，性能；  a、SQL语句性能，查询更快  b、缓存，减少数据库压力  c、数据量，能不能一次把数据拿出来  d、生成压缩gz文件，减少网络传输  先以json为例吧，像编程理想化的例子还很多，比如不写后端验证，我们改怎么防御攻击。此恨绵绵无绝期，吾将上下而求索！我是不是有点较真了？？？？--相信不屈不饶的努力，相信战胜死亡的年轻！'>关于理想化的编程</a>&nbsp;&nbsp;&nbsp;&nbsp;<span>15-12-7 上午 12:00:00</span></li><li><span>72</span>&nbsp;&nbsp;<a class='btn btn-link' style='color: blue' href='../../../../../Artlcle/vip/EF094B73-2232-4030-ADCB-013A7BEDCA82.html' title='cookie：  1、cookie是存在客户端（浏览器）的进程内存中和客户端所在的机器硬盘上  2、cookie只能能够存储少量文本，大概4K大小  3、cookie是不能在不同浏览器之间共享1添加Cookie2//1.0在服务器端实例化cookie对象34HttpCookiecookie=newHttpCookie(name,name);56//2.0设置cookie在浏览器端有效时间为2分钟，注意：此时浏览器就会将cookie存入到其所在的硬盘（等待时间到期以后才消失）78cookie.Expires=DateTime.Now.AddSeconds(120);910//3.0Path=/表示当前浏览器请求此网站的任何页面都会将有效cookie传入给服务器1112cookie.Path=/01cookie/;//指定当前cookie只有在浏览器访问01cookie文件下下的所有页面才传入服务器1314//4.0设置Domain表示当前cookie只有在当前设置好的域名下才有效1516//注意：如果没有指定Domain的情况下，asp.net会智能的读取当前url中的主机1718//实现单点登录的简单方式可以设置cookie的Domain为顶级域名1920//顶级域名.baidu.com2122//二级域名:www.baidu.com,zhidao.baidu.commp3.baidu.com2324//三级域名:zhidao.s1.baidu.com,但是一般只是用到二级域名，三级域名对于网站的seo优化回不明显2526//单点登录:实现一次登录以后再当前域名下面的其他站点可以实现免登录2728cookie.Domain=.c12.com;//将cookie的Domain设置成顶级域名以后再其所有的二级域名下的网站都可以共享此cookie2930//5.0通过Response.Cookies将cookie对象发送给浏览器保存3132Response.Cookies.Add(cookie);//底层就是向相应报文头中添加指令set-cookie:name=admin;ExpiresUTC时间获取Cookie的值:if(Request.Cookies[name]==null)    {    Response.Write(scriptalert(登录状态已经失效，请重新登录);window.location=login.aspx/script);    }删除Cookie://清除cookie思路，一定是将cookie的过期时间设置为当前时间以前的某个时间点//清除path=/下的并且doamin曲子url主机的cookieHttpCookiecookie=newHttpCookie(name,);    cookie.Expires=DateTime.Now.AddYears(-1);//表示清除path=/01cookie/的cookiecookie.Path=/01cookie/;    Response.Cookies.Add(cookie);//set-cookie:Expires:2013-4-11Session:  1、存在服务器端，存在网站进程的内存中  2、在初次设置session的时候，会在session池中实例化一个session对象，以asp.net_sessionid 的值作为key，同时会将key以cookie的形式保存到客户端的内存中  3、session的作用域只存在当前浏览器的会话中，当浏览器关闭以后就会将sessionid丢失，但是服务器的session对象要20分钟以后才会回收  4、在web.config中的system.web节点下添加sessionState timeout=5 cookieless=true/sessionState手动修改session的相关设置注意点：aspx编译完成以后会自动实现接口IRequiresSessionState，所以能够直接使用session但是一般处理程序，需要程序员自己实现接口IRequiresSessionState ，才能够使用session对象如果浏览器禁用了cookie，则可以使用设置：sessionState cookieless=true/sessionState来开启url传入sessionid到服务器，但是不推荐使用添加Session：//将当前name的值存入session中context.Session[name]=name;获取Cookie:(string)Session[name]删除Cookie://负责清除sessioncontext.Session[name]=null;    context.Session.Abandon();取消当前会话'>Cookie和Session 简单介绍</a>&nbsp;&nbsp;&nbsp;&nbsp;<span>15-12-7 上午 12:00:00</span></li><li><span>73</span>&nbsp;&nbsp;<a class='btn btn-link' style='color: blue' href='../../../../../Artlcle/vip/070C16A8-C970-4054-9D81-14EC4E1C4B52.html' title='Cache缓存在计算机领域是一个被普遍使用的概念。硬件中CPU有一级缓存，二级缓存， 浏览器中有缓存，软件开发中也有分布式缓存memcache, redis。缓存无处不在的原因是它能够极大地提高硬件和软件的运行速度。在项目开发中，性能慢的地方常常是IO操作频繁的地方，读取数据库是我们常见的消耗性能的地方。这个时候，如果将使用频繁的数据缓存到能够高速读取的介质中，下次访问时，不用再去请求数据库，直接从缓存中获取所需的数据，就能够大大提高性能。这篇文章主要讨论的是在.Net开发中，如何使用CacheManager框架方便的管理项目中的缓存。一，CacheManager介绍以及优点CacheManager是开源的.Net缓存管理框架。它不是具体的缓存实现，而是在缓存之上，方便开发人员配置和管理各种不同的缓存，为上层应用程序提供统一的缓存接口的中间层。下面是CacheManager的一些优点:让开发人员的生活更容易处理和配资缓存，即使是非常复杂的缓存方案。CacheManager能够管理多种缓存，包含 内存, appfabric, redis, couchbase， windows azure cache, memorycache等。提供了额外的功能，如缓存同步、并发更新、事件、性能计数器等…二，CacheManager开始之旅CacheManager上手还是非常简单的。下面使用内存缓存结合CacheManager的一个实例，能够帮助我们快速的熟悉CacheManager如何使用。首先在Visual Studio中创建一个Console Application.使用Nuget为项目添加CacheManager包引用。CacheManager包含了很多的Package. 其中CacheManager.Core是必须的，其它的针对不同缓存平台上有不同的对应Package.这个Demo中，我们使用内存作为缓存，所以只是需要CacheManager.Core和CacheManager.SystemRuntimeCaching接着在Main函数中配置好我们的缓存:1usingSystem;2usingCacheManager.Core;3namespaceConsoleApplication4{5classProgram6{7staticvoidMain(string[]args)8{9varcache=CacheFactory.Build(getStartedCache,settings=10{11settings.WithSystemRuntimeCacheHandle(handleName);12});13}14}15}上面代码中使用CacheFactory创建了一个名称为getStartedCache的缓存实例，这个缓存实例使用的是SystemRunTime Cache, 内存缓存。一个缓存实例是可以配置多个Handle的，我们可以使用内存来作为存储介质，也可以使用Redis分布式缓存作为存储介质，并且可以同时在一个缓存实例中使用，后面我们再介绍多级缓存的配置和使用。接下来，我们添加一些测试缓存的代码1staticvoidMain(string[]args)2{34varcache=CacheFactory.Build(getStartedCache,settings=5{6settings.WithSystemRuntimeCacheHandle(handleName);7});89cache.Add(keyA,valueA);10cache.Put(keyB,23);11cache.Update(keyB,v=42);12Console.WriteLine(KeyAis+cache.Get(keyA));//shouldbevalueA13Console.WriteLine(KeyBis+cache.Get(keyB));//shouldbe4214cache.Remove(keyA);15Console.WriteLine(KeyAremoved?+(cache.Get(keyA)==null).ToString());16Console.WriteLine(Wearedone...);17Console.ReadKey();18}三，CacheManager多级缓存配置实际开发中，我们常常会需要使用多级缓存。一种常见的情况是，你有一个分布式式缓存服务器，例如redis，独立的缓存服务器能够让我们的多个系统应用程序都能够共享这些缓存的数据，因为这些缓存项的创建是昂贵的。和访问数据库相比，分布式缓存速度较快，但是和内存相比，还是不够快。因为分布式缓存使用还需要序列化和网络传输的时间消耗。这个时候里，做个分级缓存是个好的解决方案，将内存缓存结合分布式缓存使用，使用频率高的数据直接从内存中读取，这将大大提高应用程序的整体?阅堋?/p>使用内存缓存的读取速度能够达到分布式缓存的100倍，甚至更高。使用CacheManager, 配置多级缓存是一件非常容易的事情1varcache=CacheFactory.Buildint(myCache,settings=2{3settings4.WithSystemRuntimeCacheHandle(inProcessCache)//内存缓存Handle5.And6.WithRedisConfiguration(redis,config=//Redis缓存配置7{8config.WithAllowAdmin()9.WithDatabase(0)10.WithEndpoint(localhost,6379);11})12.WithMaxRetries(1000)//尝试次数13.WithRetryTimeout(100)//尝试超时时间14.WithRedisBackPlate(redis)//redis使用BackPlate15.WithRedisCacheHandle(redis,true);//redis缓存handle16});上面代码中，内存缓存和Redis缓存配置部分很容易看明白。但是BackPlate是什么作用? 接下来，我们看看CacheManager中的BackPlate挡板机制。四， BackPlate解决分布式缓存中的同步问题对于大型的软件系统，常常都是分为很多独立的子项目，各个子项目为了节约成本或者是方便数据共享，常常会共用同一个分布缓存服务器。这样在使用多级缓存的时候，就有可能出现数据不一致的情况。假设在系统A中的更新了缓存中的一个数据项，这个时候CacheManager会在A设置的所有的缓存handle中更新改数据，这里也包括了分布式缓存上的数据。但是在系统B中的内存缓存中，还是会存在着旧的未更新的数据。当系统B从缓存中取这条记录的时候，就会出现内存缓存和分布式缓存中的数据不一致的情况。为了防止这一点，缓存管理器有一个功能叫做cachebackplate将尝试同步多个系统中的缓存。上面设置的多级缓存中，我们就将redis作为BackPlate的源. 也就是说所有的数据都需要以redis中缓存的数据为蓝本。在设置redis作为BackPlate之后，同样发生上面的数据不一致的情况的时候，只要redis中的数据被修改了，就会触发CacheManager更新所有系统中的内存缓存中的数据，和redis中的数据保持一致。同步的工作是如何完成的？每次一条缓存记录被删除或更新的时候，Cache Manager会发送一个消息，让BackPlate存储这次的数据变化信息。所有其它的系统将异步接收这些消息，并将相应地作出更新和删除操作，保证数据的一致性。五，ExpirationMode和CacheUpdateMode涉及到缓存，就必然有缓存过期的问题。CacheManager中提供了一些简单的缓存过期方式设置。1publicenumExpirationMode2{3None=0,4Sliding=1,5Absolute=2,6}同时CacheManager还为多级缓存之间设置不同的数据更新策略1publicenumCacheUpdateMode2{3None=0,4Full=1,5Up=2,6}使用Sliding和Up, 我们我可以为多级缓存设置不同的缓存过期时间，这样使用频率高的数据就能够保存在访问速度更快的内存中，访问频率次高的放到分布式缓存中。当CacheManager在内存中找不到缓存数据的时候，就会尝试在分布式缓存中找。找到后，根据Up设置，会再将该缓存数据保存到内存缓存中。具体的配置方式如下:1varcache=CacheFactory.Buildint(myCache,settings=2{3settings.WithUpdateMode(CacheUpdateMode.Up)4.WithSystemRuntimeCacheHandle(inProcessCache)//内存缓存Handle5.WithExpiration(ExpirationMode.Sliding,TimeSpan.FromSeconds(60)))6.And7.WithRedisConfiguration(redis,config=//Redis缓存配置8{9config.WithAllowAdmin()10.WithDatabase(0)11.WithEndpoint(localhost,6379);12}).13.WithExpiration(ExpirationMode.Sliding,TimeSpan.FromHours(24)))14.WithMaxRetries(1000)//尝试次数15.WithRetryTimeout(100)//尝试超时时间16.WithRedisBackPlate(redis)//redis使用BackPlate17.WithRedisCacheHandle(redis,true);//redis缓存handle1819});六，缓存使用分析在缓存使用中，对于缓存hit和miss数据态比较关系，这些数据能够帮助我们分析和调整缓存的设置，帮助缓存使用地更加合理。1varcache=CacheFactory.Build(cacheName,settings=settings2.WithSystemRuntimeCacheHandle(handleName)3.EnableStatistics()4.EnablePerformanceCounters());在配置好缓存的Statistic功能后，我们就能够跟踪到缓存的使用情况了, 下面就是分别打印各个缓存handle中的分析数据。1foreach(varhandleincache.CacheHandles)2{3varstats=handle.Stats;4Console.WriteLine(string.Format(5Items:{0},Hits:{1},Miss:{2},Remove:{3},ClearRegion:{4},Clear:{5},Adds:{6},Puts:{7},Gets:{8},6stats.GetStatistic(CacheStatsCounterType.Items),7stats.GetStatistic(CacheStatsCounterType.Hits),8stats.GetStatistic(CacheStatsCounterType.Misses),9stats.GetStatistic(CacheStatsCounterType.RemoveCalls),10stats.GetStatistic(CacheStatsCounterType.ClearRegionCalls),11stats.GetStatistic(CacheStatsCounterType.ClearCalls),12stats.GetStatistic(CacheStatsCounterType.AddCalls),13stats.GetStatistic(CacheStatsCounterType.PutCalls),14stats.GetStatistic(CacheStatsCounterType.GetCalls)15));16}七，结尾缓存是个好东西，用好了能够极大的提高性能。缓存的使用本身是个很大的话题，这边文章只是从缓存管理这个角度介绍了CachManager的使用。下面是CacheManager相关的资料和链接:官方主页http://cachemanager.net/源代码https://github.com/MichaCo/CacheManager官方MVC项目的Samplehttps://github.com/MichaCo/CacheManager/tree/master/samples/CacheManager.Samples.Mvc最近在思考不同情况下缓?媸褂玫那鹞侍狻６杂诨チ钅坷此担莸囊恢滦砸蟪３２惶撸捍婀芾碇校刈⒌憧赡茉诨捍娴拿新噬稀６杂谟τ孟低常梦是肭蟛淮螅嵌杂谑莸囊恢滦砸蠼细撸捍嬷械氖莞虏呗钥赡芨又匾?/p>怎样才是好的适合应用系统的缓存设计呢? 如果大家有兴趣，欢迎探讨指教。'>.Net缓存管理框架CacheManager</a>&nbsp;&nbsp;&nbsp;&nbsp;<span>15-12-7 上午 12:00:00</span></li><li><span>74</span>&nbsp;&nbsp;<a class='btn btn-link' style='color: blue' href='../../../../../Artlcle/vip/5CA10D59-1E34-40CA-99A2-13880BF1C716.html' title='KeleyiPager分页类，可以于对列表页进行分页浏览，代码是从HoverTreeCMS项目中COPY的，感觉很不错，使用简单方便，但是功能强大。在线体验效果：http://cms.hovertree.com/源代码如下：/*  HoverTreeCMS  *by何问起*/namespaceHoverTree.HoverTreeFrame.WebUI  {publicclassKeleyiPager  {//代码是从开源项目HoverTreeCMS中获取的//更多信息请参考：http://hovertree.com/menu/hovertreecms/  publicstaticstringBuildPageIndex(intpageIndex,inttotalPageCount)  {returnBuildPageIndex(pageIndex,totalPageCount,string.Empty);  }publicstaticstringBuildPageIndex(intpageIndex,inttotalPageCount,stringmoreParams)  {returnBuildPageIndex(pageIndex,totalPageCount,moreParams,string.Empty);}publicstaticstringBuildPageIndex(intpageIndex,inttotalPageCount,stringmoreParams,stringabsoluteAddress)  {if(pageIndextotalPageCount)pageIndex=totalPageCount;if(pageIndex1)pageIndex=1;stringm_pageIndexInfo=pageIndex.ToString()+/+totalPageCount.ToString();if(moreParams!=string.Empty)  moreParams=+moreParams;if(pageIndex2)  m_pageIndexInfo=ahref=\+absoluteAddress+?pi=1+moreParams+\第一页/aahref=\+absoluteAddress+?pi=+(pageIndex-1).ToString()++moreParams+\上一页/a+m_pageIndexInfo;elseif(pageIndex==2)  m_pageIndexInfo=ahref=\+absoluteAddress+?pi=1+moreParams+\第一页/a+m_pageIndexInfo;if(pageIndex==totalPageCount-1)  m_pageIndexInfo=m_pageIndexInfo+ahref=\+absoluteAddress+?pi=+totalPageCount.ToString()+moreParams+\末页/a;elseif(pageIndextotalPageCount-1)  m_pageIndexInfo=m_pageIndexInfo+ahref=\+absoluteAddress+?pi=+(pageIndex+1).ToString()+moreParams+\下一页/a+ahref=\+absoluteAddress+?pi=+totalPageCount.ToString()+moreParams+\末页/a;returnm_pageIndexInfo;  }  }  }调用的比较简单方便，使用方法可参考HoverTreeCMS项目，下载地址：http://hovertree.com/down/转载自：http://hovertree.com/hvtart/bjae/6w09m1b2.htm'>asp.net的快捷实用分页类</a>&nbsp;&nbsp;&nbsp;&nbsp;<span>15-12-7 上午 12:00:00</span></li><li><span>75</span>&nbsp;&nbsp;<a class='btn btn-link' style='color: blue' href='../../../../../Artlcle/vip/1AC55C2E-3DC8-4F1D-861D-1E4B130F63D4.html' title='使用 TestServer 启动 WebApi 站点就可以了，因为整个解决方案的对象都是用 ASP.NET 5 “自带”的依赖注入进行管理，所以，在对 ASP.NET 5 类库进行单元测试的时候，我都是手动进行 new 创建的对象，比如针对 Application 的单元测试，贴一段 AdImageServiceTest 中的代码：namespaceCNBlogs.Ad.Application.Tests{publicclassAdTextServiceTest:BaseTest  {privateIAdTextService_adTextService;publicAdTextServiceTest(ITestOutputHelperoutput)  :base(output)  {  Bootstrapper.Startup.ConfigureMapper();    IUnitOfWorkunitOfWork=newUnitOfWork(dbContext);  IMemcachedmemcached=newEnyimMemcached(null);  _adTextService=newAdTextService(newAdTextRepository(dbContext),newAdTextCreativeRepository(dbContext),newUserService(memcached),  unitOfWork,  memcached);  }    [Fact]publicasyncTaskGetByAdTextsTest()  {varadTexts=await_adTextService.GetAdTexts();  Assert.NotNull(adTexts);  adTexts.ForEach(x=Console.WriteLine(${x.Title}({x.Link})));  }  }  }AdImageServiceTest 构造函数中的代码，是不是看起来很别扭呢？我当时这样写，也是没有办法的，因为依赖注入的配置是写在 Startup 中，比如下面代码：namespaceCNBlogs.Ad.WebApi{publicclassStartup  {publicStartup(IHostingEnvironmentenv,IApplicationEnvironmentappEnv)  {//Setupconfigurationsources.  varbuilder=newConfigurationBuilder()  .AddJsonFile(appsettings.json)  .AddEnvironmentVariables();  Configuration=builder.Build();  }publicIConfigurationRootConfiguration{get;set;}//Thismethodgetscalledbytheruntime.Usethismethodtoaddservicestothecontainer.  publicvoidConfigureServices(IServiceCollectionservices)  {//Addframeworkservices.  services.AddMvc();    services.AddSingletonIUnitOfWork,UnitOfWork();  services.AddScopedIDbContext,EFDbContext();  services.AddSingletonIAdTextRepository,AdTextRepository();  services.AddSingletonIAdTextService,AdTextService();  }  }  }这样设计导致的结果是，针对类库项目的单元测试，就没办法使用依赖注入获取对象了，我后来想使用针对 WebApi 单元测试的方式，来对类库进行单元测试，比如用 TestServer 来启动，但类库中没有办法获取所注入的对象，构成函数注入会报错，[FromServices]属性注入是 MVC Controller 中的东西，并不支持，所以针对类库的单元测试，和 WebApi 的单元测试并不是一样。IServiceCollection 的程序包是Microsoft.Extensions.DependencyInjection.Abstractions，我原来以为它和 ASP.NET 5 Web 应用程序相关，其实它们也没啥关系，你可以脱离 ASP.NET 5 Web 应用程序，独立使用它，比如在类库的单元测试中，但如果这样设计使用，我们首先需要做一个工作，把 Startup.cs 中的 ConfigureServices 配置，独立出来，比如放在CNBlogs.Ad.Bootstrapper中，这样 Web 应用程序和单元测试项目，都可以使用它，减少代码的重复，比如我们可以进行下面设计：namespaceCNBlogs.Ad.Bootstrapper{publicstaticclassStartup  {publicstaticvoidConfigure(thisIServiceCollectionservices,stringconnectionString)  {  services.AddEntityFramework()  .AddSqlServer()  .AddDbContextEFDbContext(options=options.UseSqlServer(connectionString));    services.AddEnyimMemcached();ConfigureMapper();    services.AddSingletonIUnitOfWork,UnitOfWork();  services.AddScopedIDbContext,EFDbContext();  services.AddSingletonIAdTextRepository,AdTextRepository();  services.AddSingletonIAdTextService,AdTextService();  }publicstaticvoidConfigureMapper()  {  Mapper.CreateMapCNBlogs.Ad.Domain.Entities.AdText,AdTextDTO();  }  }  }ASP.NET 5 WebApi 项目中的 Startup.cs 配置会非常简单，只需要下面代码：publicvoidConfigureServices(IServiceCollectionservices){  services.Configure(Configuration[data:ConnectionString]);//addusingCNBlogs.Ad.Bootstrapper;}好了，做好上面工作后，单元测试中使用依赖注入就非常简单了，为了减少重复代码，我们可以先抽离出一个 BaseTest：namespaceCNBlogs.Ad.BaseTests{publicclassBaseTest  {protectedreadonlyITestOutputHelperoutput;protectedIServiceProviderprovider;publicBaseTest(ITestOutputHelperoutput)  {varconnectionString=;varservices=newServiceCollection();this.output=output;  services.Configure(connectionString);////addusingCNBlogs.Ad.Bootstrapper;  provider=services.BuildServiceProvider();  }  }  }可以看到，我们并没有使用 TestServer，而是手动创建一个 ServiceCollection，它有点类似于我们之前写依赖注入的 Unity Container，不过它们有很大不同，ServiceCollection 的功能更加强大，从 Bootstrapper.Startup 中可以看到，它可以注入 EF、MVC、Memcache 等等服务对象，BuildServiceProvider 的作用就是获取注入的服务对象，我们下面会用到：namespaceCNBlogs.Ad.Repository.Tests{publicclassAdTextServiceTest:BaseTest  {privateIAdTextService_adTextService;publicAdTextServiceTest(ITestOutputHelperoutput)  :base(output)  {  _adTextService=provider.GetServiceIAdTextService();  }    [Fact]publicasyncTaskGetByAdTextsTest()  {varadTexts=await_adTextService.GetAdTexts();  Assert.NotNull(adTexts);  adTexts.ForEach(x=Console.WriteLine(${x.Title}({x.Link})));  }  }  }这段代码和一开始的那段代码，形成了鲜明对比，这就是代码设计的魅力所在！！！'>ASP.NET 5 单元测试中使用依赖注入</a>&nbsp;&nbsp;&nbsp;&nbsp;<span>15-12-7 上午 12:00:00</span></li><li><span>76</span>&nbsp;&nbsp;<a class='btn btn-link' style='color: blue' href='../../../../../Artlcle/vip/AE09F952-5C11-427F-968A-1F3CAA8D9017.html' title='protected void sgvList_RowDataBound(object sender, GridViewRowEventArgs e)    {      if (e.Row.RowIndex  -1)      {        DataRowView row = e.Row.DataItem as DataRowView;        if (row != null)        {          string status = row[TestResult].ToString();          if (!string.IsNullOrEmpty(status))          {            switch (status)            {              case 正常:                e.Row.Cells[4].BackColor = Color.Green;                e.Row.Cells[4].ForeColor = Color.White;                break;              case 异常:                e.Row.Cells[4].BackColor = Color.Red;                e.Row.Cells[4].ForeColor = Color.White;                break;            }          }        }      }    }'>GridView?对其中列进行操作</a>&nbsp;&nbsp;&nbsp;&nbsp;<span>15-12-7 上午 12:00:00</span></li><li><span>77</span>&nbsp;&nbsp;<a class='btn btn-link' style='color: blue' href='../../../../../Artlcle/vip/4C2E99FD-D5C6-4CFD-8837-3383B666613F.html' title='有固定好的Json数据格式，你还在手动敲对应的实体吗？有点low了！步入正题，这是一个json字符串，先去验证JSON数据格式（http://www.bejson.com/）如下：{items_custom_get_response:{items:{item:[  {num_iid:1,product_id:0,skus:[  {created:null,modified:null,outer_id:null,price:null,properties:null,properties_name:黑色,quantity:2,sku_id:null  }  ]  }  ]  }  }  }   如果需要拿来用，肯定要反序列化，序列化成实体，结构如下（一般情况下你会手写的，大神除外）：publicclassRootobject  {publicItems_Custom_Get_Responseitems_custom_get_response{get;set;}  }  publicclassItems_Custom_Get_Response  {publicItemsitems{get;set;}  }  publicclassItems  {publicListItemitem{get;set;}  }  publicclassItem  {publicintnum_iid{get;set;}publicintproduct_id{get;set;}publicListSkuskus{get;set;}  }  publicclassSku  {publicobjectcreated{get;set;}publicobjectmodified{get;set;}publicobjectouter_id{get;set;}publicobjectprice{get;set;}publicobjectproperties{get;set;}publicstringproperties_name{get;set;}publicstringquantity{get;set;}publicobjectsku_id{get;set;}  }   写完这些你是不是觉得自己蒙蒙哒？？   楼主给你推荐一个快速生成的方法，使用VS2013或者2015，好像VS2012 这个不支持！怎样快速生成对应的实体呢？复制json字符串，然后选择将JSON粘贴为类。   然后就在类文件中生成下面文件：publicclassRootobject  {publicItems_Custom_Get_Responseitems_custom_get_response{get;set;}  }  publicclassItems_Custom_Get_Response  {publicItemsitems{get;set;}  }  publicclassItems  {publicItem[]item{get;set;}  }  publicclassItem  {publicintnum_iid{get;set;}publicintproduct_id{get;set;}publicSku[]skus{get;set;}  }  publicclassSku  {publicobjectcreated{get;set;}publicobjectmodified{get;set;}publicobjectouter_id{get;set;}publicobjectprice{get;set;}publicobjectproperties{get;set;}publicstringproperties_name{get;set;}publicstringquantity{get;set;}publicobjectsku_id{get;set;}  }  它里面可能和自己定义的有点不一样，那对象数组和泛型list有什么区别呢？   数组有很多的优点，比如说数组在内存中是连续存储的，所以它的索引速度是非常的快，而且赋值与修改元素也很简单；ArrayList是.Net Framework提供的用于数据存储和检索的专用类，它是命名空间System.Collections下的一部分。它的大小是按照其中存储的数据来动态扩充与收缩的。所以，我们在声明ArrayList对象时并不需要指定它的长度。ArrayList继承了IList接口，所以它可以很方便的进行数据的添加，插入和移除；正是因为ArrayList存在不安全类型与装箱拆箱的缺点，所以在C#2.0后出现了泛型的概念。而List类是ArrayList类的泛型等效类。它的大部分用法都与ArrayList相似，因为List类也继承了IList接口。最关键的区别在于，在声明List集合时，我们同时需要为其声明List集合内数据的对象类型。   机器上装了的有12、13、15，VS2015的强大功能还在探索中。。。。。 --相信不屈不饶的努力，相信战胜死亡的年轻！'>VS快速生成JSON数据格式对应的实体</a>&nbsp;&nbsp;&nbsp;&nbsp;<span>15-12-7 上午 12:00:00</span></li><li><span>78</span>&nbsp;&nbsp;<a class='btn btn-link' style='color: blue' href='../../../../../Artlcle/vip/28488C51-1A7C-4F40-BEE8-44E962B5BD60.html' title='CMS这里指内容管理系统。是Content Management System的缩写。产生随着网络应用的丰富和发展，很多网站往往不能迅速跟进大量信息衍生及业务模式变革的脚步，常常需要花费许多时间、人力和物力来处理信息更新和维护工作；遇到网站扩充的时候，整合内外网及分支网站的工作就变得更加复杂，甚至还需重新建设网站；如此下去，用户始终在一个高成本、低效率的循环中升级、整合……于是，我们听到许多用户这样的反馈：页面制作无序，网站风格不统一，大量信息堆积，发布显得异常沉重；内容繁杂，手工管理效率低下，手工链接视音频信息经常无法实现；应用难度较高，许多工作需要技术人员配合才能完成，角色分工不明确；改版工作量大，系统扩展能力差，集成其它应用时更是降低了灵活性；对于网站建设和信息发布人员来说，他们最关注的系统的易用性和功能的完善性，因此，这对网站建设和信息发布工具提出了一个很高的要求。首先，角色定位明确，以充分保证工作人员的工作效率；其次，功能完整，满足各门道把关人应用所需，使信息发布准确无误。比如，为编辑、美工、主编及运维人员设置权限和实时管理功能。此外，保障网站架构的安全性也是用户关注的焦点。能有效管理网站访问者的登陆权限，使内网数据库不受攻击，从而时刻保证网站的安全稳定，免于用户的后顾之忧。根据以上需求，一套专业的内容管理系统CMS应运而生，来有效解决用户网站建设与信息发布中?＜奈侍夂托枨蟆６酝灸谌莨芾硎歉萌砑淖畲笥攀疲鞒掏晟啤⒐δ芊岣唬砂迅寮置疟鹄嗖⑹谌ǜ戏ㄓ没П嗉芾恚恍枰没ダ砘崮切┠讯腟QL语法。举例HoverTreeCMS是一个开源的ASP.NET CMS。使用C#语言，数据库目前使用SQL Server 2008.使用Visual Studio 2015开发。VS+C#+SQL Server高效率的组合。更多信息请访问http://hovertree.com/menu/hovertreecms/ASP.NET 是.NET FrameWork的一部分，是一项微软公司的技术，是一种可由因特网服务器执行的服务器端脚本技术，它可以在通过HTTP请求文档时再在Web服务器上动态创建它们。ASP .NET的前身ASP技术， 指 Active Server Pages（动态服务器页面） ，运行于 IIS（Internet Information Server 服务，是Windows开发的Web服务器）之中的程序 。自.NET 1.0之后的每次.NET Framework的新版本发布，都会给ASP .NET带来新的特性。本文网址：http://www.cnblogs.com/sosoft/p/cms.html本文将会不断更新，关注HoverTreeCMS的动态。HoverTreeCMS已经发布v1.1增加图集图片管理功能，在线查看效果：http://cms.hovertree.com/使用开源CMS的原因降低风险在当前动荡的市场环境下，组织不应该过度依赖软件公司，因为他们可能正面临生存的困境，每天都有无数的软件公司倒闭，因此选择软件公司的产品，无异于将自己的命运交给了别人。同时，软件公司的产品一向是封闭源代码的，试想一下，如果软件公司在一夜之间突然人间蒸发，你运行的系统就无人维护，随时可能面临更换系统的境地，如果选择开源软件，可以将这种风险降到最低，活跃的开源软件通常会有源源不断的贡献者维护和更新，而且自己可以获取源代码，完全可以按照自己的意愿进行修改，无需担心某一天突然找不到依靠。产品质量更可靠闭源软件的质量通常与软件公司的开发人员水平息息相关，开发人员的水平通常参差不齐，因此闭源软件的质量通常也是参差不齐，而开源软件通常是由社区中的技术高手在维护，有时用户自身也可以参与维护，并且开源软件的用户较多，软件存在的bug一般都会被及时发现和修补，产品质量更加可靠。付出少，回报多削减成本是商业成功至关重要的的因素，bug修复，开发功能和编写文档都会消耗大量的人力、物力和财力，如果选择开源软件，这些事情都有人在默默奉献，不需要你付出什么，但你却可以享用别人的劳动成果，当然你愿意的话，也可以为开源软件做贡献。不花冤枉钱使用开源软件开发一个产品是值得投资的，可以降低开发成本，并可以快速推出自己的产品，然而，许多组织都希望投放到生产环境中的产品能得到支持，于是诞生了许多提供企业级开源产品支持服务的专业型公司，组织可以根据自身的情况，有选择性地购买需要的服务。如果选择闭源产品，通常会多花钱，买到自己可能用不上的产品和服务。招揽优秀人才开源社区中充满了大量的优秀人才，他们富有激情，才华横溢，乐意为开源软件奉献，如果你的组织选择了开源软件，在他们眼中，你的组织充满了魅力，因此要想招揽到优秀的人才一点问题也没有，试想一下，对开源软件有浓厚兴趣的人加入到你的组织，想不提高生产力都难。行业适应能力更强因为开源软件大多免费的缘故，在中小型组织中迅速得到了广泛使用，这些使用开源软件的组织可能来自各行各业，经过这么多组织的长时间使用，开源软件的适应能力更强，因此无论你的组织属于何种类型，都可以放心使用，相比之下，闭源的软件产品通常用户数量较少，行业适应能力不强，即使软件公司承诺可以定制开发，也会是一个痛苦的合作过程。产品更透明由于开源软件是由社区在推动，其透明度很好，bug的发现，新功能的提出都是在一个公开的论坛中进行的，你可以随时获取到最新信息，还可以参与进去，开源软件会根据使用者需求不断演变，而不是受限于一家公司的意愿，因此你可以了解开源软件的未来发展规划和方向，其透明度比闭源软件高出许多，组织可以做到心中有数。开发技术文章：http://www.cnblogs.com/sosoft/p/kaifajishu.html'>ASP.NET开源CMS</a>&nbsp;&nbsp;&nbsp;&nbsp;<span>15-12-7 上午 12:00:00</span></li><li><span>79</span>&nbsp;&nbsp;<a class='btn btn-link' style='color: blue' href='../../../../../Artlcle/vip/7744C30F-D62D-4F95-84CA-817DD90FF54E.html' title='生成缩略图是一个十分常用功能，找到了一个方法，重写部分代码，实用又好用，.net又一个生成缩略图的方法，不变形1///summary2///为图片生成缩略图by何问起3////summary4///paramname=phyPath原图片的路径/param5///paramname=width缩略图宽/param6///paramname=height缩略图高/param7///returns/returns8publicSystem.Drawing.ImageGetHvtThumbnail(System.Drawing.Imageimage,intwidth,intheight)9{10//代码是从开源项目HoverTreeCMS中获取的11//更多信息请参考：http://hovertree.com/menu/hovertreecms/12Bitmapm_hovertreeBmp=newBitmap(width,height);13//从Bitmap创建一个System.Drawing.Graphics14Graphicsm_HvtGr=Graphics.FromImage(m_hovertreeBmp);15//设置16m_HvtGr.SmoothingMode=System.Drawing.Drawing2D.SmoothingMode.HighQuality;17//下面这个也设成高质量18m_HvtGr.CompositingQuality=System.Drawing.Drawing2D.CompositingQuality.HighQuality;19//下面这个设成High20m_HvtGr.InterpolationMode=System.Drawing.Drawing2D.InterpolationMode.HighQualityBicubic;21//把原始图像绘制成上面所设置宽高的缩小图22RectanglerectDestination=newRectangle(0,0,width,height);2324intm_width,m_height;25if(image.Width*heightimage.Height*width)26{27m_height=image.Height;28m_width=(image.Height*width)/height;29}30else31{32m_width=image.Width;33m_height=(image.Width*height)/width;34}3536m_HvtGr.DrawImage(image,rectDestination,0,0,m_width,m_height,GraphicsUnit.Pixel);3738returnm_hovertreeBmp;39}'>.net一个生成缩略图的方法，不变形,非常好用</a>&nbsp;&nbsp;&nbsp;&nbsp;<span>15-12-7 上午 12:00:00</span></li><li><span>80</span>&nbsp;&nbsp;<a class='btn btn-link' style='color: blue' href='../../../../../Artlcle/vip/6715AE0E-082A-41C3-9CD3-821DFD262682.html' title='阅读目录引言Lunece是什么？Solr是什么JAVA环境搭建JAVA环境搭建之变量配置Tomcat简单配置结尾引言君子生非异也，善假于物也。Java和.Net哪个好，我们也不需要打口水战，我认为语言只是我们达到目的的工具而已，某个业务场景哪个顺手用哪个(包括除此两种以外的所有语言)，当然要精通一门语言是很难的事情，需要我们持之以恒。回到顶部Lunece是什么？Lucene是当前以及最近几年最受欢迎的免费Java信息检索程序库。Lunece也是有.Net版本的---Lucene.Net，为什么我没有使用.Net版本的呢？你怎么知道我没有用.....当前Lucene.Net版本到3.03，传说这个项目已经被停掉了，所以后面Lucene所具有的新功能都不会再有跟进了(比如Join、分组等等...)。所以我没得选择，最终还是选择了原生态的Lunece回到顶部Solr是什么一开始我也是发下大宏愿要基于Lunece去写一个搜索引擎(认真看了百科的就知道Lunece不是搜索引擎，只是信息检索程序库)，索引初始化、索引同步?⑺饕檠⑷ㄖ厣柚玫鹊龋乙丫渴鸷肊clipse、TomCat、并去官网下载了最新的Lunece5.3经过几天的摸索之后我偶然的发现了Solr这个好东西，这是基于Lucene的全文搜索服务器。非常好使回到顶部环境搭建废话不多说，我们开始我们Solr之旅的第一步：环境搭建1.Eclipse 下载：http://www.eclipse.org/downloads/download.php?file=/oomph/epp/mars/R1a/eclipse-inst-win64.exe(我的环境是Win7-64位)2.Java-JDK8.0下载http://download.oracle.com/otn-pub/java/jdk/8u65-b17/jdk-8u65-windows-x64.exe?AuthParam=1446687554_926c8d0bd88689df9fd551dd67501a8a同样的Win7-64位环境3.Tomcat8 (相当于.Net的IIS)http://mirrors.cnnic.cn/apache/tomcat/tomcat-8/v8.0.28/bin/apache-tomcat-8.0.28-windows-x64.zip以上工具都下载安装之后，需要配置环境变量，如何配置的文章网上很多，乏善可陈由于我也是Java的新手，多年.Net的经验对于我这样的Java新手来说作用不大，所以我下载的版本都是最新的版本，后来才知道由于开源的问题，版本太多，各种插件的更新速度根本跟不上Java的更新版本所以很多人、企业都还是用的很低的版本，这一点上.Net程序员们倒是省心了很多，全部都是.Net制定的规则......回到顶部环境搭建之变量配置Tomcat的安装跟网上其他的资料都差不多，乏善可陈，Windows版本就是配置一些环境变量。由于我的是最新版本，所以网上找的许多的环境变量配置方法有些许出入，下面是我的配置,其中的值中的路径你需要按照你自己的路径配置1.变量名:JAVA_HOME值：C:\Program Files\Java\jdk1.8.0_652.变量名:CATALINA_HOME值：C:\apache-tomcat-8.0.282.变量名:TOMCAT_HOME值：C:\apache-tomcat-8.0.28\bin3.变量名:CLASS_PATH值：.;%JAVA_HOME%\lib;%TOMCAT_HOME%\BIN;%CATALINA_HOME%\common\lib\servlet.jar4.变量名:Path 值：;%JAVA_HOME%\bin;%JAVA_HOME%\jre\bin;其中%%之间的值就是引用已经有的变量名的地址PS：CATALINA_HOME和TOMCAT_HOME 应该就是版本不同步的原因吧，很多应用还是引用的TOMCAT_HOME而最新的TOMCAT8却是用的CATALINA_HOME回到顶部Tomcat简单配置1.为了不让Tomcat默认访问端口8080、80...占用我常用的端口，于是我修改了apache-tomcat-8.0.28\conf\server.xml下的所有端口以90开头，如9080打开http://localhost:9080/,当然以你自己的配置端口为准。可以看到如下界面2.点击Manager App管理App发现需要输入密码，这个是在apache-tomcat-8.0.28\conf\tomcat-users.xml文件中配置,然后输入tomcat 密码tomcat就可以登录后端管理界面了。XML贴出来方便复制：回到顶部结尾这篇博文就先介绍这么多，Solr的配置，我们下篇再讲，一篇博文太长可能会让你感觉很累，学习也需要节奏（高手直接无视此句）。'>.Net程序员 Solr-5.3之旅 (一)Solr入门</a>&nbsp;&nbsp;&nbsp;&nbsp;<span>15-12-7 上午 12:00:00</span></li><li><span>81</span>&nbsp;&nbsp;<a class='btn btn-link' style='color: blue' href='../../../../../Artlcle/vip/EC2E161F-D98F-4F50-BE96-636E20005139.html' title='首先在Global.asax.cs里增加：protected void Application_PreSendRequestContent(object sender, EventArgs e){HttpContext.Current.Response.Headers.Set(“Server”, “w3cnet.com”);HttpContext.Current.Response.Headers.Remove(“X-AspNet-Version”);HttpContext.Current.Response.Cookies.Remove(“.ASPXAUTH”);}然后web.config的system.webServer节点下增加：httpProtocolcustomHeadersremove name=”X-Powered-By” //customHeaders/httpProtocol再看看响应头，或用站长工具查看，完美隐藏。转自：http://fenglongsheng.com/post/7566.html'>Asp.Net完美隐藏服务器信息</a>&nbsp;&nbsp;&nbsp;&nbsp;<span>15-12-7 上午 12:00:00</span></li><li><span>82</span>&nbsp;&nbsp;<a class='btn btn-link' style='color: blue' href='../../../../../Artlcle/vip/6F41CA42-C1B2-4ABC-BDAB-6D31D9FE2535.html' title='前言：单元测试的时候经常出现一个对象依耐另一个你无法控制的对象，所以这个时候你必须去替代成一个你自己可以控制的对象来摆脱依耐。1：为什么要破除依赖1.1：运行速度慢比喻我们要通过用户Id判断用户是否存在，那么我们这个方法就会依赖数据库。这样就成了集成测试，如果大量的测试就会出现速度慢。1.2：需要配置由于依赖数据库，就会配置和数据库相关的文件。1.3：一次性测试很多内容，无法定位错误信息比喻这个方法错误可能是由于传入的用户Id为空，也可能传入的用户Id不存在，还可能是数据库连接断开等，这样我们就起不到我们单元测试的目的。2：存根一个外部依赖项：指的是系统中的一个对象，被测试的代码与这个对象发生交互，但是你不能控制这个对象。比喻前端工程师和后台工程师合作，前端工程师要等待后台返回的数据来处理，那么后台就是他的一个外部依赖项。因为他无法控制后台的代码定义：一个存根（stub）是对系统中存在的一个依赖项（或协作者）的可控制的替代物（就是你找一个对象来替换你无法控制的对象）。通过使用存根，你在测试代码时无需直接处理这个依赖项。（说白了就是一个你自己定义来对象来取代你无法控制的对象）3：重构代码设计来提高代码的可测试性3.1：抽取接口使底层可替换其实底层我们就应该使用接口，这样上层代码依赖的是接口而不是具体的对象，使项目具有更好的扩展性，当然这里做事为了更好的测试。从底层方法中抽出一个接口publicinterfaceIUser  {///summary  ///检验用户是否存在////summary  ///paramname=userId用户名/param  ///returns/returns  boolIsExist(stringuserId);  }底层访问数据库的类publicclassUser:IUser  {publicboolIsExist(stringuserId)  {//从数据库查询//如果有返回true}  }待测试的工作单元publicboolIsExistUser(stringuserId)  {  varuser=newUser();returnuser.IsExist(userId);  }一个可控制的存根publicclassFackUser:IUser  {publicboolWillBevalid=false;  publicboolIsExist(stringuserId)  {returnWillBevalid;  }  }下面开始注入存根了。4：依赖注入（在被测试的单元中注入一个伪实现）4.1：构造参数注入顾名思义就是实例化的时候在构造参数的时候把伪对象注入此时我们就要修改我们上面的类了如下被测试类._user=IsExistUser(测试代码[Test]publicvoidIsExistUser_ExistUser_ReturnsTrue()  {varfackUser=newFackUser{WillBevalid=true};varuser=newUserBll(fackUser);//注入伪对象boolresult=user.IsExistUser(1);  Assert.IsTrue(result);  }关于构造函数注入的总结：使用构造函数注入比较简单直观可读性和理解方面也很不错。但是也有问题就是当你依赖越来越多的时候，加入构造函数的参数越来越多这样就会变得难以维护。使用场景：比喻api的设计就是某些使用者本身就是带有参数的构造函数那么就可以这么做。4.2：使用属性（get；set）注入伪对象被测试类IUserUser{;=IsExistUser(代码测试[Test]publicvoidIsGetName_NormalGetName_ReturnsTrue(){varfackUser=newFackUser{WillBevalid=true};varuser=newUserBll{User=fackUser};//属性注入boolresult=user.IsExistUser(1);  Assert.IsTrue(result);  }关于属性注入总结：和构造函数注入相似不过更易读，更易编写。什么时候使用属性注入：想表明哪个被测试类的某个依赖项是可选的，或者测试可以放心使用默认创建的这个依赖项，就可以属性注入4.3：在工厂中伪造一个成员（伪对象）我们先看工厂类publicclassUserFactory  {privateIUser_user=null;publicIUserCreate()  {if(_user!=null)return_user;returnnewUser();  }    [Conditional(DEBUG)]publicvoidSetUser(IUsermuser)  {  _user=muser;  }  }被测试类IsExistUser(userFactory=UserFactory();测试代码[Test]publicvoidIsGetName_NormalGetName_ReturnsTrue(){varfackUser=newFackUser{WillBevalid=true};varuserFactory=newUserFactory();  userFactory.SetUser(fackUser);//设置自己要注入的伪对象boolresult=newUserBll().IsExistUser(1);  Assert.IsTrue(result);  }关于伪造方法的总结： 这种方法很简单，对工厂添加一个你要控制的伪依赖项。对被测试代码没什么改变一切还是原样。这种方式明显比前两种好。相当于加入了一个工厂的缓冲区。在这里可以做一些逻辑上的处理。4.4：抽取和重新使用这种方法的步骤：在被测试类：添加一个返回真真实实的虚工厂的方法；在正常的代码中使用工厂方法在测试项目中：创建一个新类声明这个新类继承被测试类创建一个你要替换的接口类型的公共字段（不需要属性）重写虚方法返回公共字段在测试代码中：创建一个存根类的实例。此存根实现所要求的接口创建新派生类而非测试类的实例伪造一个工厂方法publicclassUserBll  {  publicboolIsExistUser(stringuserId)  {varuser=UserManager();returnuser.IsExist(userId);  }protectedvirtualIUserUserManager()  {  returnnewUser();  }创建新类并集成被测试类publicclassTestUser:UserBll  {publicTestUser(IUseruser){  _muser=user;  }privatereadonlyIUser_muser;protectedoverrideIUserUserManager(){return_muser;  }  }测试代码：[Test]publicvoidIsGetName_NormalGetName_ReturnsTrue(){varfackUser=newFackUser{WillBevalid=true};//存根实例vartestUser=newTestUser(fackUser);//注入伪对象（新派生的类）  boolresult=testUser.IsExistUser(1);  Assert.IsTrue(result);  }关于抽取和重写注入的总结：写更少的接口，代码更容易替换。我觉得这种方法最好，就是留了一条路，不光对于测试，如果哪天发现这代码不好了，直接可以在底层新添加一个替换即可，不会影响原来的代码什么时候使用：当你调用外部依赖项时候想模拟自己想要的值的时候就特别受用。4.5：重构技术变种注入先看被测试类publicclassUserBll  {  publicboolIsExistUser(stringuserId)  {returnUserManager(userId);  }protectedvirtualboolUserManager(stringuserId)  {  IUseruser=newUser();returnuser.IsExist(userId);  }  }创建新类并集成被测试类publicclassTestUser:UserBll  {  publicboolIsSupported;protectedboolIsGetUserName(stringuserId){returnIsSupported;  }  }测试类publicvoidIsGetName_NormalGetName_ReturnsTrue(){vartestUser=newTestUser{IsSupported=true};boolresult=testUser.IsExistUser(1);  Assert.IsTrue(result);  }总结：这和上一种方式其实是很像的，只不过这种更彻底。这种方式更加简单。不在添加很多的构造函数，设置方法或者工厂类。不过确实不符合面向对象中的封装原则。暴露了用户不改看到的东西。各种依赖注入灵活使用。个人觉得后三种都不错。'>破除依赖</a>&nbsp;&nbsp;&nbsp;&nbsp;<span>15-12-7 上午 12:00:00</span></li><li><span>83</span>&nbsp;&nbsp;<a class='btn btn-link' style='color: blue' href='../../../../../Artlcle/vip/EAF6752D-5CA2-4990-AE15-73D95580ACB7.html' title='获取本机公网IPpublicstaticstringGetIP(){using(varwebClient =newWebClient()){try{vartemp = webClient.DownloadString(http://iframe.ip138.com/ic.asp);returnRegex.Match(temp,@\[(?ip\d+\.\d+\.\d+\.\d+)]).Groups[ip].Value;}catch(Exception ex){returnex.Message;}}}'>获取本机公网IP</a>&nbsp;&nbsp;&nbsp;&nbsp;<span>15-12-7 上午 12:00:00</span></li><li><span>84</span>&nbsp;&nbsp;<a class='btn btn-link' style='color: blue' href='../../../../../Artlcle/vip/195336EA-8C9A-44DC-8F27-76CF2AEF8C27.html' title='前台代码  asp:GridView ID=GridView1 runat=server             /asp:GridView后台代码   protected void BindGridView()    {      #region 方法一      //DataTable dt = new DataTable();      //dt.Columns.Add(Colu1);      //dt.Columns.Add(Colu2);      //dt.Columns.Add(Colu3);      //dt.Columns.Add(Colu4);      //dt.Rows.Add(new Object[] { 第一列, 第二列, 第三列, 第四列 });      //dt.Rows.Add(new Object[] { 第一列, 第二列, 第三列, 第四列 });      //dt.Rows.Add(new Object[] { 第一列, 第二列, 第三列, 第四列 });      //dt.Rows.Add(new Object[] { 第一列, 第二列, 第三列, 第四列 });      //dt.Rows.Add(new Object[] { 第一列, 第二列, 第三列, 第四列 });      //GridView1.DataSource = dt;      //GridView1.DataBind();      #endregion      #region 方法二      ListTest t = new ListTest();      Test ts = new Test();      ts.MyProperty1 = T1;      ts.MyProperty2 = T2;      ts.MyProperty3 = T3;      ts.MyProperty4 = T4;      t.Add(ts);      GridView1.DataSource = t;      GridView1.DataBind();       #endregion    }  public class Test  {    public string MyProperty1 { get; set; }    public string MyProperty2 { get; set; }    public string MyProperty3 { get; set; }    public string MyProperty4 { get; set; }    public Test() { }    public Test(string MyProperty1, string MyProperty2, string MyProperty3, string MyProperty4)    {      this.MyProperty1 = MyProperty1;      this.MyProperty2 = MyProperty2;      this.MyProperty3 = MyProperty3;      this.MyProperty4 = MyProperty4;    }  }'>GridView数据源（DataTable & List）绑定</a>&nbsp;&nbsp;&nbsp;&nbsp;<span>15-12-7 上午 12:00:00</span></li><li><span>85</span>&nbsp;&nbsp;<a class='btn btn-link' style='color: blue' href='../../../../../Artlcle/vip/7EE67F52-8B0D-4B11-B330-78FD0102ABA1.html' title='1!DOCTYPEhtml2htmlxmlns=http://www.w3.org/1999/xhtml3head4metahttp-equiv=Content-Typecontent=text/html;charset=utf-8/5title网页布局练习/title67linkhref=../EX_Asp_Net/css/div.cssrel=stylesheet/8/head9body10h1align=center利用div和css对页面的布局进行调整/h1hr/11divclass=d112h3窗口1/h313/div14divclass=d2h3窗口2/h3/div15divclass=d3h3窗口3/h3/div16/body17/htmlcss代码：1bod{2margin:100%;3padding:100%;45}6.d1{7width:200px;8height:600px;9background-color:red;10margin-left:20px;11margin-top:20px;12position:absolute;13}14.d2{15width:800px;16height:150px;17background-color:greenyellow;18position:absolute;19left:235px;20margin-top:20px;2122}23.d3{24width:800px;25height:420px;26position:absolute;27left:235px;28background-color:#19a1f8;29margin-top:200px;3031}'>用div和css样式控制页面布局</a>&nbsp;&nbsp;&nbsp;&nbsp;<span>15-12-7 上午 12:00:00</span></li><li><span>86</span>&nbsp;&nbsp;<a class='btn btn-link' style='color: blue' href='../../../../../Artlcle/vip/92457843-C847-44B7-A3AD-8D797CF04002.html' title='在线预览效果：http://tool.hovertree.com/info/client/其中aspx页面的控件代码:asp:ListBoxrunat=serverID=lbHoverTreeInfoClientIDMode=Static/asp:ListBox以下是实现代码：1usingSystem;2usingSystem.Web;3usingSystem.Web.UI;45namespaceHoverTreeTool.HvtInfo.KeleyiClient6{7publicpartialclassIndex:System.Web.UI.Page8{9protectedvoidPage_Load(objectsender,EventArgse)10{11stringuserAgent=Request.UserAgent==null?无:Request.UserAgent;12if(!IsPostBack)13{lbHoverTreeInfo.Items.Add(您的系统信息为：);14lbHoverTreeInfo.Items.Add(客户端IP[Page.Request.UserHostAddress]：+Page.Request.UserHostAddress);15lbHoverTreeInfo.Items.Add(浏览器类型[Request.Browser.Browser]：+Request.Browser.Browser);16lbHoverTreeInfo.Items.Add(浏览器标识[Request.Browser.Id]：+Request.Browser.Id);17lbHoverTreeInfo.Items.Add(浏览器版本号[Request.Browser.Version]：+Request.Browser.Version);18lbHoverTreeInfo.Items.Add(浏览器是不是测试版本[Request.Browser.Beta]：+Request.Browser.Beta);19lbHoverTreeInfo.Items.Add(浏览器类型[Request.Browser.Type]：+Request.Browser.Type);20lbHoverTreeInfo.Items.Add(是否支持框架网页[Request.Browser.Frames]：+Request.Browser.Frames);21lbHoverTreeInfo.Items.Add(是否支持Cookie[Request.Browser.Cookies]：+Request.Browser.Cookies);22lbHoverTreeInfo.Items.Add(浏览器JScript版本[Request.Browser.JScriptVersion]：+Request.Browser.JScriptVersion);23lbHoverTreeInfo.Items.Add(屏幕分辨率宽[System.Windows.Forms.Screen.PrimaryScreen.Bounds.Width]]：+System.Windows.Forms.Screen.PrimaryScreen.Bounds.Width);24lbHoverTreeInfo.Items.Add(屏幕分辨率高[System.Windows.Forms.Screen.PrimaryScreen.Bounds.Height]]：+System.Windows.Forms.Screen.PrimaryScreen.Bounds.Height);25lbHoverTreeInfo.Items.Add(浏览器类型[Request.Browser.Type]：+Request.Browser.Type);26lbHoverTreeInfo.Items.Add(客户端IP[GetHoverTreeIp()]：+GetHoverTreeIp());27lbHoverTreeInfo.Items.Add(客户端的操作系统[Request.Browser.Platform]：+Request.Browser.Platform);28lbHoverTreeInfo.Items.Add(客户端的操作系统[GetHoverTreeOSName(userAgent)]：+GetHoverTreeOSName(userAgent));29lbHoverTreeInfo.Items.Add(是不是win16系统[Request.Browser.Win16]：+Request.Browser.Win16);30lbHoverTreeInfo.Items.Add(是不是win32系统[Request.Browser.Win32]：+Request.Browser.Win32);31lbHoverTreeInfo.Items.Add(客户端.NETFramework版本：Request.Browser.ClrVersion]：+Request.Browser.ClrVersion);32lbHoverTreeInfo.Items.Add(是否支持Java[Request.Browser.JavaApplets]：+Request.Browser.JavaApplets);3334if(Request.ServerVariables[HTTP_UA_CPU]==null)35lbHoverTreeInfo.Items.Add(CPU类型[Request.ServerVariables[\HTTP_UA_CPU\]]:未知);36else37lbHoverTreeInfo.Items.Add(CPU类型[Request.ServerVariables[\HTTP_UA_CPU\]]:+Request.ServerVariables[HTTP_UA_CPU]);3839lbHoverTreeInfo.Items.Add(UserAgent信息[Request.UserAgent]：+userAgent);40lbHoverTreeInfo.Items.Add(By何问起工具http://tool.hovertree.com/info/client/);4142}43}4445///summary46///获取真实IP47////summary48///returns/returns49publicstringGetHoverTreeIp()50{51stringresult=HttpContext.Current.Request.ServerVariables[HTTP_X_FORWARDED_FOR];52if(null==result||result==String.Empty)53{54result=HttpContext.Current.Request.ServerVariables[REMOTE_ADDR];55}56if(null==result||result==String.Empty)57{58result=HttpContext.Current.Request.UserHostAddress;59}60returnresult;61}6263///summary64///根据UserAgent获取操作系统名称65////summary66privatestringGetHoverTreeOSName(stringuserAgent)67{68stringm_hvtOsVersion=未知;69if(userAgent.Contains(NT6.4))70{71m_hvtOsVersion=Windows10;72}73else74if(userAgent.Contains(NT6.3))75{76m_hvtOsVersion=Windows8.1;77}78else79if(userAgent.Contains(NT6.2))80{81m_hvtOsVersion=Windows8;82}83else84if(userAgent.Contains(NT6.1))85{86m_hvtOsVersion=Windows7;87}else88if(userAgent.Contains(NT6.0))89{90m_hvtOsVersion=WindowsVista/Server2008;91}92elseif(userAgent.Contains(NT5.2))93{94m_hvtOsVersion=WindowsServer2003;95}96elseif(userAgent.Contains(NT5.1))97{98m_hvtOsVersion=WindowsXP;99}100elseif(userAgent.Contains(NT5))101{102m_hvtOsVersion=Windows2000;103}104elseif(userAgent.Contains(NT4))105{106m_hvtOsVersion=WindowsNT4;107}108elseif(userAgent.Contains(Me))109{110m_hvtOsVersion=WindowsMe;111}112elseif(userAgent.Contains(98))113{114m_hvtOsVersion=Windows98;115}116elseif(userAgent.Contains(95))117{118m_hvtOsVersion=Windows95;119}120elseif(userAgent.Contains(Mac))121{122m_hvtOsVersion=Mac;123}124elseif(userAgent.Contains(Unix))125{126m_hvtOsVersion=UNIX;127}128elseif(userAgent.Contains(Linux))129{130m_hvtOsVersion=Linux;131}132elseif(userAgent.Contains(SunOS))133{134m_hvtOsVersion=SunOS;135}136returnm_hvtOsVersion;137}138139}140}'>asp.net获取客户端浏览器及主机信息</a>&nbsp;&nbsp;&nbsp;&nbsp;<span>15-12-7 上午 12:00:00</span></li><li><span>87</span>&nbsp;&nbsp;<a class='btn btn-link' style='color: blue' href='../../../../../Artlcle/vip/D2B4AD6A-2DBB-4F15-8B6D-AE10EB2AFEAC.html' title='前台代码asp:SGridView ID=sgvList AllowSorting=true UseOtherPager=true runat=server SkinID=skin_grid_b            AutoGenerateColumns=False EmptyDataText=%$Resources:Message,SearchNoData %            OnRowDataBound=sgvList_RowDataBound OnRowCommand=sgvList_RowCommand            Columns              asp:BoundField DataField=TestDate HeaderText=异常日期 HtmlEncode=false                ItemStyle Wrap=true /              /asp:BoundField              asp:BoundField DataField=TestName HeaderText=异常来源 HtmlEncode=false                ItemStyle Wrap=true /              /asp:BoundField              asp:BoundField DataField=FactoryName HeaderText=电厂 HtmlEncode=false                ItemStyle Wrap=true /              /asp:BoundField              asp:BoundField DataField=ObjectName HeaderText=名称 HtmlEncode=false                ItemStyle Wrap=true /              /asp:BoundField              asp:BoundField DataField=TestResult HeaderText=异常情况 HtmlEncode=false                HeaderStyle Wrap=False/HeaderStyle                ItemStyle Wrap=true /              /asp:BoundField              asp:BoundField DataField=IsFinished HeaderText=是否已处理 HtmlEncode=false                HeaderStyle Wrap=False/HeaderStyle                ItemStyle Wrap=true /              /asp:BoundField              asp:TemplateField HeaderText=%$Resources:Message,Operation % HeaderStyle-Width=200px                ItemTemplate                  asp:LinkButton ID=lnkView runat=server CommandName=DataView Text=查看/asp:LinkButtonnbsp;                  asp:LinkButton ID=lnkEdit runat=server CommandName=DataEdit Text=编辑/asp:LinkButtonnbsp;                  asp:LinkButton ID=lnkDelete runat=server CommandName=DataDelete Text=删除/asp:LinkButtonnbsp;                /ItemTemplate                ItemStyle HorizontalAlign=Center/ItemStyle              /asp:TemplateField            /Columns          /asp:SGridView后台代码protected void sgvList_RowCommand(object sender, GridViewCommandEventArgs e)    {      if (e.CommandName == DataView)      {        ShowDialog(RS_RuningExceptionEdit.aspx?opt=view, 查看, 850, 650);      }      if (e.CommandName == DataEdit)      {        ShowDialog(RS_RuningExceptionEdit.aspx?opt=edit, 编辑, 850, 650);      }    }'>GridView列链接操作</a>&nbsp;&nbsp;&nbsp;&nbsp;<span>15-12-7 上午 12:00:00</span></li><li><span>88</span>&nbsp;&nbsp;<a class='btn btn-link' style='color: blue' href='../../../../../Artlcle/vip/086A793B-1387-427F-B477-999D3B1BC907.html' title='cookie登录后同域名下的网站保持相同的登录状态。登录ticket=FormsAuthenticationTicket(,userId,DateTime.Now,DateTime.Now.AddDays(),,ticketEncrypted======　　　　　　Domain=====　　　　　　Domain=这样登录后，在同域名下的任何页面都可以得到用户状态判断用户是否登录publicboolIsAuthenticated  {　　get　　{　　　　boolisPass=System.Web.HttpContext.Current.User.Identity.IsAuthenticated;　　　　if(!isPass)  　　　　　　SignOut();　　　　returnisPass;  　　}  }得到当前的用户名publicstringGetCurrentUserId()  {return_httpContext.User.Identity.Name;  }'>网站用户登录认证</a>&nbsp;&nbsp;&nbsp;&nbsp;<span>15-12-7 上午 12:00:00</span></li><li><span>89</span>&nbsp;&nbsp;<a class='btn btn-link' style='color: blue' href='../../../../../Artlcle/vip/5835787C-2566-4C22-9032-9AC954451B8D.html' title='    首先，创建一个值类型：1publicstructMajorColor:IComparableMajorColor2{3internalintColor;//颜色值4internalintAmount;//颜色总数5publicMajorColor(intColor,intAmount)6{7this.Color=Color;8this.Amount=Amount;9}10publicintCompareTo(MajorColorobj)11{12returnthis.Amount.CompareTo(obj.Amount);13}14}接下来是主要算法：1///summary2///识别主色调3////summary4///paramname=BmpBmp位图/param5///paramname=PCAAmount主色调数目/param6///paramname=Delta阈值/param7///returns/returns8publicunsafestaticListMajorColorPrincipalColorAnalysis(BitmapBmp,intPCAAmount,intDelta=24)9{10ListMajorColorMC=newListMajorColor();1112intX,Y,Width,Height,Stride,Index,TotalColorAmount=0;13intHalfDelta;14byte*Pointer,Scan0;//定义指针所以需要unsafe关键字15BitmapDataBmpData=Bmp.LockBits(newRectangle(0,0,Bmp.Width,Bmp.Height),ImageLockMode.ReadWrite,PixelFormat.Format24bppRgb);//将位图锁定到系统内存中16Height=Bmp.Height;17Width=Bmp.Width;18Stride=BmpData.Stride;//Bitmap对象的跨距宽度（也称扫描宽度）19Scan0=(byte*)BmpData.Scan0;//位图中第一个像素数据的地址2021int[]Table=newint[256*256*256];22int[]NonZero=newint[Width*Height];23int[]Map=newint[256];2425if(Delta2)26{27HalfDelta=Delta/2-1;28}29else30{31HalfDelta=0;32}33for(Y=0;Y256;Y++)34{35Map[Y]=((Y+HalfDelta)/Delta)*Delta;36if(Map[Y]255)Map[Y]=255;37}38for(Y=0;YHeight;Y++)39{40Pointer=Scan0+Stride*Y;41for(X=0;XWidth;X++)42{43Index=(Map[*Pointer]16)+(Map[*(Pointer+1)]8)+Map[*(Pointer+2)];44if(Table[Index]==0)//颜色未出现45{46NonZero[TotalColorAmount]=Index;//记录颜色47TotalColorAmount++;//总数加148}49Table[Index]++;//对应的颜色数目加150Pointer+=3;//遍历下个像素51}52}53MajorColor[]Result=newMajorColor[TotalColorAmount];54for(Y=0;YTotalColorAmount;Y++)55{56Result[Y].Amount=Table[NonZero[Y]];57Result[Y].Color=NonZero[Y];58}59Array.Sort(Result);//排序60Array.Reverse(Result);//反转6162for(Y=0;Y(Result.LengthPCAAmount?PCAAmount:Result.Length);Y++)63{64MC.Add(newMajorColor(Result[Y].Color,Result[Y].Amount));65}66Bmp.UnlockBits(BmpData);//从系统内存中解锁此位图67GC.Collect();//释放内存68returnMC;69}unsafe关键字编译报错解决方案：项目属性-生成-勾选允许不安全代码即可。最后获取到的List MajorColor  就是我们要获取的主色调了。接下来遍历循环获取所有色调1if(MC!=null)2{3for(inti=0;iMC.Count;i++)4{5IntToColor(MC[i].Color)));6}7}8//颜色值转换成RGB9publicstaticstringIntToColor(intcolor)10{11intR=color255;12intG=(color65280)/256;13intB=(color16711680)/65536;14returnColorTranslator.ToHtml(System.Drawing.Color.FromArgb(R,G,B));15}这块小功能也算初步完成了，至于图片怎么传到后台这个应该不用说明了。友情提示：B/S可将图片转成Base64数字编码。'>.NET 传图识色</a>&nbsp;&nbsp;&nbsp;&nbsp;<span>15-12-7 上午 12:00:00</span></li><li><span>90</span>&nbsp;&nbsp;<a class='btn btn-link' style='color: blue' href='../../../../../Artlcle/vip/0A5406A7-945F-4EEB-9D6C-ADEB8CB941E1.html' title='之前如果对 ASP.NET WebAPI 进行单元测试（HttpClient 发起请求，并且可调试 WebAPI），一般采用 Owin 的方式，具体参考：《开发笔记：用 Owin Host 实现脱离 IIS 跑 Web API 单元测试》示例代码：publicclassValuesWebApiTest:IDisposable{privateconststringHOST_ADDRESS=http://localhost:8001;privateIDisposable_webApp;privateHttpClient_httClient;publicAdTextUnitWebApiTest()  {  _webApp=WebApp.StartStartup(HOST_ADDRESS);  Console.WriteLine(WebAPIstarted!);  _httClient=newHttpClient();  _httClient.BaseAddress=newUri(HOST_ADDRESS);  Console.WriteLine(HttpClientstarted!);  }    [Fact]publicasyncTaskGet()  {varresponse=await_httClient.GetAsync(/api/values);if(response.StatusCode!=HttpStatusCode.OK)  {  Console.WriteLine(response.StatusCode);  Console.WriteLine((awaitresponse.Content.ReadAsAsyncHttpError()).ExceptionMessage);  }  Assert.Equal(HttpStatusCode.OK,response.StatusCode);vartest=awaitresponse.Content.ReadAsStringAsync();  Console.WriteLine(awaitresponse.Content.ReadAsStringAsync());  }publicvoidDispose()  {  _httClient.Dispose();  _webApp.Dispose();  }  }本来想在 ASP.NET 5 WebAPI 项目中，也用这一套测试代码，但发现并不适用，因为 ASP.NET WebAPI 2 和 ASP.NET 5 WebAPI 并不是特别一样，比如 Startup.cs 的配置等等，之前使用WebApp.StartStartup(HOST_ADDRESS)的方式启动 WebAPI 项目，而 ASP.NET 5 WebAPI 变成了这样的：publicstaticvoidMain(string[]args)=WebApplication.RunStartup(args);想用WebApplication.Run的方式替换掉WebApp.Start，但发现并不可行，比如 args 的参数问题，自己想的有点简单了，后来 Google 搜索了一些资料，发现 ASP.NET 5 增加了 TestServer，自己找资料配置了很久，看别人的示例代码很简单，但我运行的时候就是各种报错，主要原因是程序包的版本不对，因为我是按照 project.json 的提示安装的，比如Microsoft.AspNet.TestHost这个程序包，提示最新版本为1.0.0-rc2-15960，并且没有1.0.0-rc1-final版本，然后我就安装提示安装的 rc2，就报下面的异常：异常信息：Could not load type Microsoft.AspNet.Builder.RequestDelegate from assembly Microsoft.AspNet.Http.Abstractions, Version=1.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60.根据提示，我以为异常原因是没有加载Microsoft.AspNet.Http.Abstractions程序集，然后又添加此程序集，重新运行发现还是报错。。。后面具体的过程就不记录了，反正坑很大，根本原因是Microsoft.AspNet.TestHost程序包的版本不对，应该安装1.0.0-rc1-final版本，我是后来无意间重启 VS2015 发现的。下面贴一下 ASP.NET 5 进行单元测试的一些代码。首先 ASP.NET 5 WebAPI 项目 Startup.cs 配置代码：usingMicrosoft.AspNet.Builder;usingMicrosoft.AspNet.Hosting;usingMicrosoft.Extensions.Configuration;usingMicrosoft.Extensions.DependencyInjection;usingMicrosoft.Extensions.Logging;namespaceDemo.WebApi{publicclassStartup  {publicStartup(IHostingEnvironmentenv)  {//Setupconfigurationsources.  varbuilder=newConfigurationBuilder()  .AddJsonFile(appsettings.json)  .AddEnvironmentVariables();  Configuration=builder.Build();  }publicIConfigurationRootConfiguration{get;set;}//Thismethodgetscalledbytheruntime.Usethismethodtoaddservicestothecontainer.  publicvoidConfigureServices(IServiceCollectionservices)  {//Addframeworkservices.  services.AddMvc();  }//Thismethodgetscalledbytheruntime.UsethismethodtoconfiguretheHTTPrequestpipeline.  publicvoidConfigure(IApplicationBuilderapp,IHostingEnvironmentenv,ILoggerFactoryloggerFactory)  {  loggerFactory.AddConsole(Configuration.GetSection(Logging));  loggerFactory.AddDebug();    app.UseIISPlatformHandler();    app.UseStaticFiles();    app.UseMvc();  }//Entrypointfortheapplication.  publicstaticvoidMain(string[]args)=WebApplication.RunStartup(args);  }  }ValuesWebApiTest 测试代码：usingMicrosoft.AspNet.Hosting;usingMicrosoft.AspNet.TestHost;usingMicrosoft.Extensions.DependencyInjection;usingMicrosoft.Extensions.Logging;namespaceDemo.WebApiTests{publicclassValuesWebApiTest  {publicTestServer_server;publicValuesWebApiTest()  {  _server=TestServer.Create(app=  {varenv=app.ApplicationServices.GetRequiredServiceIHostingEnvironment();varloggerFactory=app.ApplicationServices.GetRequiredServiceILoggerFactory();newCNBlogs.Ad.WebApi.Startup(env).Configure(app,env,loggerFactory);  },services=  {  services.AddMvc();  services.Configure();  });  }  }    [Fact]publicasyncTaskGet()  {varresponse=await_server.CreateClient().GetAsync(/api/values);if(response.StatusCode!=HttpStatusCode.OK)  {  Console.WriteLine(response.StatusCode);  Console.WriteLine((awaitresponse.Content.ReadAsAsyncHttpError()).ExceptionMessage);  }  Assert.Equal(HttpStatusCode.OK,response.StatusCode);vartest=awaitresponse.Content.ReadAsStringAsync();  Console.WriteLine(awaitresponse.Content.ReadAsStringAsync());  }  }project.json 配置代码：{  frameworks:{  dnx451:{}},  dependencies:{  Microsoft.AspNet.Mvc.WebApiCompatShim:6.0.0-rc1-final,  Microsoft.Net.Http:2.2.29,  Microsoft.AspNet.TestHost:1.0.0-rc1-final,  xunit:2.1.0,  xunit.runner.dnx:2.1.0-rc1-build204  },  commands:{  test:xunit.runner.dnx  }}运行测试成功，并且可以 Debug 调试，需要注意 using 引用（没用的我都去掉了），还有程序包的版本号。'>ASP.NET 5 使用 TestServer 进行单元测试</a>&nbsp;&nbsp;&nbsp;&nbsp;<span>15-12-7 上午 12:00:00</span></li><li><span>91</span>&nbsp;&nbsp;<a class='btn btn-link' style='color: blue' href='../../../../../Artlcle/vip/D8D4C15F-2961-4904-B22F-BB2B53BF55AC.html' title='1.BeginRequestASP.NET开始处理对的第一个事件，表示处理的开始。2.AuthenticateRequest验证请求，一般用来去请求的用户信息3.PostAuthenticateRequest已经获取请求的用户信息4.AuthorizeRequest授权，一般用来检查用户的请求是否获取权限5.PostAuthorizeRequest用户请求已经得到授权7.PostResolveRequestCache已经完成缓存的获取工作8.PostMappRequestHandler已经根据用户的请求，创建了处理请求处理器的对象。9.AcquireRequestState取得请求的状态，一般用户Session10.PostAcquireRequestState已经取得了Session11.PreRequestHandlerExecute准备执行处理程序。11、12管道事件之间开始进入页面生命周期(Page类)①执行一般处理程序或者是页面的PR方法②创建控件树：_BuilderControlTree 内部就是将整个页面控件树的结构创建好，如果是普通的C#代码，将被编译到一个方法体里。③决定是否IsPostBack，确定当前请求是否是回发，通过ViewState实现，如果ViewState④PreInit()初始化执勤啊的一个事件  Init()实际输出化：就是将控件树上的控件都new一个实例，并赋默认值。Init方法内部是执行一个递归初始化。  InitComplete⑤加载ViewState加载页面的状态，解析隐藏域中的ViewState⑥ProcessPostData处理回发数据  1.比较表单提交过来的数据和控件上原来的状态做对比，然后将需要触发改变的控件放到一个集合里面去。  2.将表单里面的值赋值到控件上。⑦页面加载PreLoad (这是在事件响应之前最后改变事件的地方) Load(PageLoad)⑧ProcessPostData:第二次处理回发数据。再次将要触发改变事件的控件又一次的放到集合里面去。⑨触发改变的事件LoadComplete⑩触发PostBack回来的控件的事件?PreRend(渲染之前)  渲染：就是将服务器端的控件转换成html代码，这也是最后一次能改变即将发送给客户端的响应内容?页面渲染。12.PostRequestHandler已经执行了处理程序13.ReleaseRequestState释放请求的状态14.PostReleaseRequestState已经释放了请求的状态15.UpdateRequestCache更新缓存16.PostUpdateRequestCache已经更新了缓存17.LogRequest请求的日志操作18.PostLogRequest已经完成了请求的日志操作19.EndRequest本次请求处理完成'>请求管道与19个标准事件</a>&nbsp;&nbsp;&nbsp;&nbsp;<span>15-12-7 上午 12:00:00</span></li><li><span>92</span>&nbsp;&nbsp;<a class='btn btn-link' style='color: blue' href='../../../../../Artlcle/vip/8184A19A-C2C6-40D6-98FE-9D616D059334.html' title='序言最近公司要整理公司内部oa系统，需要使用到工作流，所以就开始了开源工作流挑选，使用，到集成到公司内部系统的工作。首先在网上搜了文档，自己也有补充，整理啦国内几款工作流的比较，由于没有个个击破式的研究所以不足之处还望海涵。送上比较内容图：鉴于这个表的内容，与公司技术与需求的结合，我们选择啦RoadFlow工作流引擎。下面踏上RoadFlow的征程。RoadFlow的下载、部署、及使用官方网址：http://cqroad.cn/官方文档：http://cqroad.cn/Doc/Default.aspx官方源码下载链接：http://cqroad.cn/Download项目下载完成后，1、自带有数据库脚本，执行到本地数据库，就行啦。2、打开项目，由于我们公司绝大多说项目都是用mvc，所以我选用webmvc项目，移除webform项目，也可以保留去看看哈。3、配置webconfig中的数据库链接字符串，注意这里一般会有一个版本问题或者模式问题，爆红页面顺手就能解决没多大难度。4、然后就是打开/login/index页面，按照提示登录进去。5、根据文档，自己一点点摸索前进啦。我摸索的差不多啦，感觉公司一般的流程需求这里是可以满足的，并且考虑啦一下集成的成本与技术实现，也感觉没有什么问题，毕竟代码都在手里吗，哈哈。然后搞起。Roadflow开源工作流集成到公司内部OA系统首先弄懂一个陌生的项目，我是从数据库进行操刀的，因为我看啦一下他的项目结构，没有非常特别的东西,就是一般的mvc项目。数据结构如下：1、基础平台：日志表，数据库配置表，数据字典表。这些表在roadflow中几乎都是单表操作，比较独立，不用做过多的分析就一目了然。2、组织结构，工作组，人员信息3、角色，权限，人员信息4、表单，流程，按钮，步骤等工作流相关核心表需要注意的就是自己建自己的表单字段存储表，然后在绑定表单的时候可以选择数据自己的数据表进行绑定映射。分析完表结构之后，就是自己的登录权限集成与Js解压分析，集成到适合自己的内部系统中。经过千辛万苦之后，就是轻松的页面集成。哦，中间绑定自定义事件的时候，遇到啦反射程序集路径问题，这里给大家做个简单的分享。修改下路径就可以啦。///summary  ///执行自定义方法////summary  ///paramname=eventName/param  ///returns/returns  publicobjectExecuteFlowCustomEvent(stringeventName,objecteventParams,stringdllName=)  {if(dllName.IsNullOrEmpty())  {  dllName=eventName.Substring(0,eventName.LastIndexOf(.));  dllName=dllName.Substring(0,dllName.LastIndexOf(.));  }  System.Reflection.Assemblyassembly=System.Reflection.Assembly.Load(dllName);stringtypeName=System.IO.Path.GetFileNameWithoutExtension(eventName);stringmethodName=eventName.Substring(typeName.Length+1);  Typetype=assembly.GetType(typeName,true);objectobj=System.Activator.CreateInstance(type,false);varmethod=type.GetMethod(methodName);if(method!=null)  {returnmethod.Invoke(obj,newobject[]{eventParams});  }else  {thrownewMissingMethodException(typeName,methodName);  }  }小结由于工作流不是一个工作量小的项目，别且过于繁杂，所以如果没有特殊的需求，建议使用开源框架。还有，如果你也用到啦工作流，那么咱们可以一起交流学习，左上方是我的群，欢迎加入。下面给大家展示下我的成果。流程设计集成表单设计集成待办事项集成好啦，好事说三遍，我再次说明下，如果你对本篇内容有什么批评指教或者想一起交流学习，欢迎加入左上角我的技术交流群。今晚陪媳妇逛超市啦，时间有点紧，就整理啦一篇图比较多的博文，耽误啦我的redis，明天坚持继续我的redis系列。'>.Net开源工作流Roadflow的使用?爰?</a>&nbsp;&nbsp;&nbsp;&nbsp;<span>15-12-7 上午 12:00:00</span></li><li><span>93</span>&nbsp;&nbsp;<a class='btn btn-link' style='color: blue' href='../../../../../Artlcle/vip/84361AA7-82AF-4630-B4E9-BFFC4CE75A26.html' title='生成缩略图是一个十分常用功能，找到了一个方法，重写部分代码，实用又好用，.net又一个生成缩略图的方/// summary    /// 为图片生成缩略图 by 何问起    /// /summary    /// param name=phyPath原图片的路径/param    /// param name=width缩略图宽/param    /// param name=height缩略图高/param    /// returns/returns    public System.Drawing.Image GetHvtThumbnail(System.Drawing.Image image, int width, int height)    {     //代码是从开源项目HoverTreeCMS中获取的     //更多信息请参考：http://hovertree.com/menu/hovertreecms/      Bitmap m_hovertreeBmp = new Bitmap(width, height);      //从Bitmap创建一个System.Drawing.Graphics      Graphics m_HvtGr = Graphics.FromImage(m_hovertreeBmp);      //设置       m_HvtGr.SmoothingMode = System.Drawing.Drawing2D.SmoothingMode.HighQuality;      //下面这个也设成高质量      m_HvtGr.CompositingQuality = System.Drawing.Drawing2D.CompositingQuality.HighQuality;      //下面这个设成High      m_HvtGr.InterpolationMode = System.Drawing.Drawing2D.InterpolationMode.HighQualityBicubic;      //把原始图像绘制成上面所设置宽高的缩小图      Rectangle rectDestination = new Rectangle(0, 0, width, height);      int m_width, m_height;      if (image.Width * height  image.Height * width)      {        m_height = image.Height;        m_width = (image.Height * width) / height;      }      else      {        m_width = image.Width;        m_height = (image.Width * height) / width;      }      m_HvtGr.DrawImage(image, rectDestination, 0, 0, m_width, m_height, GraphicsUnit.Pixel);      return m_hovertreeBmp;    }'>net又一个生成缩略图的方法，不变形</a>&nbsp;&nbsp;&nbsp;&nbsp;<span>15-12-7 上午 12:00:00</span></li>
                        </ul>
                        <br /><hr />
                    </div>
                </div>
                <div id="footerInnerSeparator"></div>
            </div>
        </div>
        <div id="footerOuterSeparator"></div>
    </div>
    <br /><br /><br />
    <script src="../../js/jquery-1.9.1.js"></script>
</body>
</html>