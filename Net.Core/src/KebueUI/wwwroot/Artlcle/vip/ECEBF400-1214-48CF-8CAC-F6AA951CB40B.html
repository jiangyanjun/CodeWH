<!DOCTYPE HTML>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="Language" content="zh-CN">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="shortcut icon" href="../../images/kebue.ico">
    <link rel="icon" href="../../images/kebue.ico">
    <meta name="description" content=DBHelper>
    <meta name="keywords" content=using System;using System.Collections.Generic;using System.Linq;using System.Text;using System.Data.SqlClient;using System.Data;using System.Data.Common;namespace DAL{  public class DBHelper  {    ///>
    <title>DBHelper</title>

    <link href="../../template/scripts/bootstrap/css/bootstrap.min.css" rel="stylesheet" />
    <link href="../../template/styles/custom.css" rel="stylesheet" />
</head>
<body id="pageBody">
    <div id="divBoxed" class="container">
        <div class="transparent-bg" style="position: absolute;top: 0;left: 0;width: 100%;height: 100%;z-index: -1;zoom: 1;"></div>
        <div class="divPanel notop nobottom">
            <div class="row-fluid">
                <div class="span12">
                    <div id="divLogo">
                        <a href="../../../Home/Index" id="divSiteTitle">科布尔 kebue</a><br />
                        <a href="../../../Home/Index" id="divTagLine">开发者用代码改变世界从科布尔开始</a>
                    </div>
                </div>
            </div>
            <div class="row-fluid">
                <div class="span12">
                    <div id="divMenuRight" class="pull-right">
                        <div class="navbar">
                            <button type="button" class="btn btn-navbar-highlight btn-large btn-primary" data-toggle="collapse" data-target=".nav-collapse">
                                NAVIGATION <span class="icon-chevron-down icon-white"></span>
                            </button>
                            <div class="nav-collapse collapse">
                                <ul class="nav nav-pills ddmenu">
                                    <li class="dropdown glyphicon glyphicon-arrow-left"><a href='javascript:window.history.back()'>后退</a></li>
                                    <li class="dropdown active"><a href="http://www.kebue.com/">Home</a></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row-fluid">
                <div class="span12">
                    <div id="contentInnerSeparator"></div>
                </div>
            </div>
        </div>
        <div class="contentArea">
            <div class="divPanel notop page-content">
                <div class="breadcrumbs">
                    <a href="../../../Home/Index">Home</a> &nbsp;/&nbsp; <span><a href='../../../../../Artlcle/ArticleType/B8C0509A-82D4-4BD7-A1BB-5BAF70ED1C60.html' title='.NET'>.NET</a></span>
                </div>
                <div class="row-fluid">
                    <div class="span12" id="divMain">
                        <h1>DBHelper</h1>
                        <pre>
                        <code>
                            <p><span style="line-height: 0px;"></span>using System;</p><p>using System.Collections.Generic;</p><p>using System.Linq;</p><p>using System.Text;</p><p>using System.Data.SqlClient;</p><p>using System.Data;</p><p>using System.Data.Common;</p><p><br/></p><p>namespace DAL</p><p>{</p><p>&nbsp; &nbsp; public class DBHelper</p><p>&nbsp; &nbsp; {</p><p>&nbsp; &nbsp; &nbsp; &nbsp; /// &lt;summary&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; /// 根据SQL从数据库中读取对象集合</p><p>&nbsp; &nbsp; &nbsp; &nbsp; /// &lt;/summary&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; /// &lt;typeparam name=&quot;T&quot;&gt;&lt;/typeparam&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; /// &lt;param name=&quot;sql&quot;&gt;SQL语句&lt;/param&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; /// &lt;param name=&quot;p&quot;&gt;参数集合&lt;/param&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; /// &lt;returns&gt;对象集合&lt;/returns&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; public static List&lt;T&gt; ReadCollection&lt;T&gt;(string sql, DynamicParameters p) where T : class</p><p>&nbsp; &nbsp; &nbsp; &nbsp; {</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; using (ConnService connService = new ConnService())</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return connService.SqlConnection.Query&lt;T&gt;(sql, p).ToList&lt;T&gt;();</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</p><p>&nbsp; &nbsp; &nbsp; &nbsp; }</p><p>&nbsp; &nbsp; &nbsp; &nbsp; /// &lt;summary&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; /// DataSet插入SAP数据库</p><p>&nbsp; &nbsp; &nbsp; &nbsp; /// &lt;/summary&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; /// &lt;param name=&quot;ds&quot;&gt;&lt;/param&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; /// &lt;returns&gt;&lt;/returns&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; public static int InsertDataSet(DataSet ds)</p><p>&nbsp; &nbsp; &nbsp; &nbsp; {</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; string sqlconnectionString = System.Configuration.ConfigurationManager.AppSettings[&quot;ConnString&quot;];</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SqlConnection conn = new SqlConnection(sqlconnectionString);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; string sql = &quot; &nbsp;SELECT * FROM SAP&quot;;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DbCommand dbCommand = new SqlCommand(sql, conn);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DbDataAdapter adapter = new SqlDataAdapter((SqlCommand)dbCommand);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DbCommandBuilder cmbuilder = new SqlCommandBuilder((SqlDataAdapter)adapter);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return adapter.Update(ds, &quot;SAP&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; }</p><p>&nbsp; &nbsp; &nbsp; &nbsp; public static void InsertDataDataTableSqlBulkCopy_SAP(DataTable dt)</p><p>&nbsp; &nbsp; &nbsp; &nbsp; {</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; string sqlconnectionString = System.Configuration.ConfigurationManager.AppSettings[&quot;ConnString&quot;];</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; using (SqlBulkCopy bulk = new SqlBulkCopy(sqlconnectionString))</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.BatchSize = 100000;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.DestinationTableName = &quot;SAP&quot;;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;MaterialCode&quot;, &quot;MaterialCode&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;Plant&quot;, &quot;Plant&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;BatchNumber&quot;, &quot;BatchNumber&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;Quantity&quot;, &quot;Quantity&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;ScrapReason&quot;, &quot;ScrapReason&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.WriteToServer(dt);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</p><p>&nbsp; &nbsp; &nbsp; &nbsp; }</p><p>&nbsp; &nbsp; &nbsp; &nbsp; public static void InsertDataDataTableSqlBulkCopy_NPI(DataTable dt)</p><p>&nbsp; &nbsp; &nbsp; &nbsp; {</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dt.Columns.Add(&quot;UnitPrice&quot;, typeof(string));</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; foreach (DataRow item in dt.Rows)</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; var Stock = item[&quot;54&quot;];</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; var CurrStockBUOM = item[&quot;23&quot;];</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; var UnitPrice = Convert.ToString(Math.Round(Convert.ToDecimal(Stock) / Convert.ToDecimal(CurrStockBUOM), 4));</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; item[&quot;UnitPrice&quot;] = UnitPrice.ToString();</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; string sqlconnectionString = System.Configuration.ConfigurationManager.AppSettings[&quot;ConnString&quot;];</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; using (SqlBulkCopy bulk = new SqlBulkCopy(sqlconnectionString))</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.BatchSize = 100000;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.DestinationTableName = &quot;NPI&quot;;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;1&quot;, &quot;Plant&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;2&quot;, &quot;SupplyPlant&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;3&quot;, &quot;Material&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;4&quot;, &quot;MaterialDesc&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;5&quot;, &quot;BatchNumber&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;6&quot;, &quot;TargetMDO&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;7&quot;, &quot;NPIBucket&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;8&quot;, &quot;Subsector&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;9&quot;, &quot;Category&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;10&quot;, &quot;TDCVal&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;11&quot;, &quot;Currentlyworkedbygroup&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;12&quot;, &quot;PreviousOwner&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;13&quot;, &quot;Previouslyworkedbygroup&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;14&quot;, &quot;Currentaction&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;15&quot;, &quot;NextAction&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;16&quot;, &quot;NPIClassification&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;17&quot;, &quot;Rootcause&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;18&quot;, &quot;BlockClass1&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;19&quot;, &quot;BlockClass2&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;20&quot;, &quot;STOPSHIPDate&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;21&quot;, &quot;FirstApperanceDate&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;22&quot;, &quot;Endofshipmentdate&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;23&quot;, &quot;CurrStockBUOM&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;24&quot;, &quot;BUOMUnit&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;25&quot;, &quot;CurrStockLCUR&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;26&quot;, &quot;SellingCurrency&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;27&quot;, &quot;CaseSellingPrice_LCur_buom&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;28&quot;, &quot;SecondaryMarketDiscount&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;29&quot;, &quot;CaseListPrice_LCURR&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;30&quot;, &quot;NetListPrice_LCur_BUOM&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;31&quot;, &quot;ReworkCost&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;32&quot;, &quot;Fcast&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;33&quot;, &quot;Country&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;34&quot;, &quot;GeoGroup&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;35&quot;, &quot;AuthSellCtry&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;36&quot;, &quot;WEAcc&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;37&quot;, &quot;GlMatStatus&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;38&quot;, &quot;LocMatStatus&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;39&quot;, &quot;CaseGTIN&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;40&quot;, &quot;Sector&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;41&quot;, &quot;Brand&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;42&quot;, &quot;MRPDRPContr&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;43&quot;, &quot;GlForm&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;44&quot;, &quot;MatGroup&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;45&quot;, &quot;CSUIndicator&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;46&quot;, &quot;CustType&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;47&quot;, &quot;PTOProduct&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;48&quot;, &quot;CustPurpose&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;49&quot;, &quot;Currentlyworkedby&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;50&quot;, &quot;PublicNotes&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;51&quot;, &quot;PrivateNotes&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;52&quot;, &quot;ActionNote&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;53&quot;, &quot;BatchExpDate&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;54&quot;, &quot;Stock&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;55&quot;, &quot;TotalMaterialPlantFPC&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;56&quot;, &quot;TotalMaterialCountryFPC&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;57&quot;, &quot;Su&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;58&quot;, &quot;Vendor&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;59&quot;, &quot;Productversion&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;60&quot;, &quot;ProdSiteContr&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;61&quot;, &quot;PlantDescription&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;62&quot;, &quot;InboxCounter&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;63&quot;, &quot;InBucketCounter&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;64&quot;, &quot;RemnantDiscount&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;65&quot;, &quot;RTCIS&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;66&quot;, &quot;Steam&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;67&quot;, &quot;SteamDocSubmitted&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;68&quot;, &quot;APOLogNA&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;69&quot;, &quot;APOLogLA&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;70&quot;, &quot;APOLogEMEA&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;71&quot;, &quot;APOLogAS&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;72&quot;, &quot;ofBUOMCase&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;73&quot;, &quot;ofITCase&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;74&quot;, &quot;ofCases&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;75&quot;, &quot;ExtendedCaseSellingPrice&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;76&quot;, &quot;ErrorinRecord&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (dt.Columns.Count &gt; 77)</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;77&quot;, &quot;Ship_To_MDO&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;78&quot;, &quot;Sub_brand&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;79&quot;, &quot;Item_GTIN&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;80&quot;, &quot;Stop_ShipIndicator&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;81&quot;, &quot;Stop_Ship_Date_Source&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;82&quot;, &quot;Stop_Ship_Date_Final&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;83&quot;, &quot;Stop_Ship_Date_Manual&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;84&quot;, &quot;Stop_Ship_Extension&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;85&quot;, &quot;Confirmed_Stop_Ship_Extension&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;86&quot;, &quot;Steam_Approved&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;87&quot;, &quot;Std_Pallets&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;88&quot;, &quot;Disposal_Type&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;89&quot;, &quot;MOQ&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;90&quot;, &quot;Storage_Location&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;91&quot;, &quot;id&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;92&quot;, &quot;Error_in_Record&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;UnitPrice&quot;, &quot;UnitPrice&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.WriteToServer(dt);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</p><p>&nbsp; &nbsp; &nbsp; &nbsp; }</p><p>&nbsp; &nbsp; &nbsp; &nbsp; public static void InsertDataDataTableSqlBulkCopy_ScrapForm(DataTable dt)</p><p>&nbsp; &nbsp; &nbsp; &nbsp; {</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; string sqlconnectionString = System.Configuration.ConfigurationManager.AppSettings[&quot;ConnString&quot;];</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; using (SqlBulkCopy bulk = new SqlBulkCopy(sqlconnectionString))</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.BatchSize = 1000;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.DestinationTableName = &quot;DCSCRAPSOURCE&quot;;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;ID&quot;, &quot;ID&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;Materialcode&quot;, &quot;Materialcode&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;ChineseDescription&quot;, &quot;ChineseDescription&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;PartLotnumber&quot;, &quot;PartLotnumber&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;Location_DCOnly&quot;, &quot;Location_DCOnly&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;Location_Sorting&quot;, &quot;Location_Sorting&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;Quantity&quot;, &quot;Quantity&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;Uom&quot;, &quot;Uom&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;Unitprice_RMB&quot;, &quot;Unitprice_RMB&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;BookValue_RMB&quot;, &quot;BookValue_RMB&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;BookValue_USD&quot;, &quot;BookValue_USD&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;Scrappingreason&quot;, &quot;Scrappingreason&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;SupportingDocoument&quot;, &quot;SupportingDocoument&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;Remarks&quot;, &quot;Remarks&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;Plant&quot;, &quot;Plant&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;ApplicationNo&quot;, &quot;ApplicationNo&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;Note1_GBUConfirm&quot;, &quot;Note1_GBUConfirm&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;Note2&quot;, &quot;Note2&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;Note3&quot;, &quot;Note3&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.WriteToServer(dt);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</p><p>&nbsp; &nbsp; &nbsp; &nbsp; }</p><p>&nbsp; &nbsp; &nbsp; &nbsp; public static void InsertDataDataTableSqlBulkCopy_CompareScrap(DataTable dt)</p><p>&nbsp; &nbsp; &nbsp; &nbsp; {</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dt.Columns.Add(&quot;VERSION&quot;,typeof(string));</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; string VERSION=DAL_History.GetNewVersion(DateTime.Now.ToString(&quot;yyyyMMdd&quot;));</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; foreach (DataRow item in dt.Rows)</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; item[&quot;VERSION&quot;] = VERSION;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; string sqlconnectionString = System.Configuration.ConfigurationManager.AppSettings[&quot;ConnString&quot;];</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; using (SqlBulkCopy bulk = new SqlBulkCopy(sqlconnectionString))</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.BatchSize = 1000;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.DestinationTableName = &quot;CompareScrap&quot;;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;ID&quot;, &quot;ID&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;Materialcode&quot;, &quot;Materialcode&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;ChineseDescription&quot;, &quot;ChineseDescription&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;PartLotnumber&quot;, &quot;PartLotnumber&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;Location_DCOnly&quot;, &quot;Location_DCOnly&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;Location_Sorting&quot;, &quot;Location_Sorting&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;Quantity&quot;, &quot;Quantity&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;Uom&quot;, &quot;Uom&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;Unitprice_RMB&quot;, &quot;Unitprice_RMB&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;BookValue_RMB&quot;, &quot;BookValue_RMB&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;BookValue_USD&quot;, &quot;BookValue_USD&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;Scrappingreason&quot;, &quot;Scrappingreason&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;SupportingDocoument&quot;, &quot;SupportingDocoument&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;Remarks&quot;, &quot;Remarks&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;Plant&quot;, &quot;Plant&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;ApplicationNo&quot;, &quot;ApplicationNo&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;Note1_GBUConfirm&quot;, &quot;Note1_GBUConfirm&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;Note2&quot;, &quot;Note2&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;Note3&quot;, &quot;Note3&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;VERSION&quot;, &quot;VERSION&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;Value&quot;, &quot;Value&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.ColumnMappings.Add(&quot;ISAdded&quot;, &quot;ISAdded&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bulk.WriteToServer(dt);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</p><p>&nbsp; &nbsp; &nbsp; &nbsp; }</p><p>&nbsp; &nbsp; &nbsp; &nbsp; /// &lt;summary&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; /// 根据存储过程从数据库中读取对象集合</p><p>&nbsp; &nbsp; &nbsp; &nbsp; /// &lt;/summary&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; /// &lt;typeparam name=&quot;T&quot;&gt;对象类型&lt;/typeparam&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; /// &lt;param name=&quot;procName&quot;&gt;存储过程名称&lt;/param&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; /// &lt;param name=&quot;p&quot;&gt;参数集合&lt;/param&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; /// &lt;returns&gt;对象集合&lt;/returns&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; public static List&lt;T&gt; ReadCollectionBySP&lt;T&gt;(string procName, DynamicParameters p) where T : class</p><p>&nbsp; &nbsp; &nbsp; &nbsp; {</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; using (ConnService connService = new ConnService())</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return connService.SqlConnection.Query&lt;T&gt;(procName, p, commandType: CommandType.StoredProcedure).ToList&lt;T&gt;();</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</p><p>&nbsp; &nbsp; &nbsp; &nbsp; }</p><p>&nbsp; &nbsp; &nbsp; &nbsp; /// &lt;summary&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; /// 根据存储过程从数据库中读取对象集合</p><p>&nbsp; &nbsp; &nbsp; &nbsp; /// &lt;/summary&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; /// &lt;typeparam name=&quot;T&quot;&gt;对象类型&lt;/typeparam&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; /// &lt;param name=&quot;procName&quot;&gt;存储过程名称&lt;/param&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; /// &lt;param name=&quot;p&quot;&gt;参数集合&lt;/param&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; /// &lt;returns&gt;对象集合&lt;/returns&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; public static List&lt;T&gt; ReadCollectionBySP&lt;T&gt;(string procName, ref DynamicParameters p) where T : class</p><p>&nbsp; &nbsp; &nbsp; &nbsp; {</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; using (ConnService connService = new ConnService())</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return connService.SqlConnection.Query&lt;T&gt;(procName, p, commandType: CommandType.StoredProcedure).ToList&lt;T&gt;();</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</p><p>&nbsp; &nbsp; &nbsp; &nbsp; }</p><p>&nbsp; &nbsp; &nbsp; &nbsp; /// &lt;summary&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; /// 根据SQL从数据库中读取对象</p><p>&nbsp; &nbsp; &nbsp; &nbsp; /// &lt;/summary&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; /// &lt;typeparam name=&quot;T&quot;&gt;对象类型&lt;/typeparam&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; /// &lt;param name=&quot;sql&quot;&gt;SQL语句&lt;/param&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; /// &lt;param name=&quot;p&quot;&gt;参数集合&lt;/param&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; /// &lt;returns&gt;查询出的对象&lt;/returns&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; public static T ReadObject&lt;T&gt;(string sql, DynamicParameters p) where T : class</p><p>&nbsp; &nbsp; &nbsp; &nbsp; {</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; using (ConnService connService = new ConnService())</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return connService.SqlConnection.Query&lt;T&gt;(sql, p).SingleOrDefault&lt;T&gt;();</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</p><p>&nbsp; &nbsp; &nbsp; &nbsp; }</p><p>&nbsp; &nbsp; &nbsp; &nbsp; /// &lt;summary&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; /// 根据存储过程从数据库中读取对象</p><p>&nbsp; &nbsp; &nbsp; &nbsp; /// &lt;/summary&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; /// &lt;typeparam name=&quot;T&quot;&gt;对象类型&lt;/typeparam&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; /// &lt;param name=&quot;procName&quot;&gt;存储过程名称&lt;/param&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; /// &lt;param name=&quot;p&quot;&gt;参数集合&lt;/param&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; /// &lt;returns&gt;查询出的对象&lt;/returns&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; public static T ReadObjectBySP&lt;T&gt;(string procName, DynamicParameters p) where T : class</p><p>&nbsp; &nbsp; &nbsp; &nbsp; {</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; using (ConnService connService = new ConnService())</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return connService.SqlConnection.Query&lt;T&gt;(procName, p, commandType: CommandType.StoredProcedure).SingleOrDefault&lt;T&gt;();</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</p><p>&nbsp; &nbsp; &nbsp; &nbsp; }</p><p>&nbsp; &nbsp; &nbsp; &nbsp; /// &lt;summary&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; /// 执行SQL语句</p><p>&nbsp; &nbsp; &nbsp; &nbsp; /// &lt;/summary&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; /// &lt;param name=&quot;sql&quot;&gt;sql语句&lt;/param&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; /// &lt;param name=&quot;p&quot;&gt;参数集合&lt;/param&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; public static void ExcuteSQL(string sql, DynamicParameters p)</p><p>&nbsp; &nbsp; &nbsp; &nbsp; {</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; using (ConnService connService = new ConnService())</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; connService.SqlConnection.Execute(sql, p);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</p><p>&nbsp; &nbsp; &nbsp; &nbsp; }</p><p>&nbsp; &nbsp; &nbsp; &nbsp; /// &lt;summary&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; /// 执行SQL语句</p><p>&nbsp; &nbsp; &nbsp; &nbsp; /// &lt;/summary&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; /// &lt;param name=&quot;sql&quot;&gt;sql语句&lt;/param&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; /// &lt;param name=&quot;p&quot;&gt;参数集合&lt;/param&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; public static void CreateDataBase(string sql, DynamicParameters p)</p><p>&nbsp; &nbsp; &nbsp; &nbsp; {</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; using (Conn connService = new Conn())</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; connService.SqlConnection.Execute(sql, p);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</p><p>&nbsp; &nbsp; &nbsp; &nbsp; }</p><p>&nbsp; &nbsp; &nbsp; &nbsp; public static int CreateDataBaseOrTable(string sql, DynamicParameters p, bool IsTable)</p><p>&nbsp; &nbsp; &nbsp; &nbsp; {</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (IsTable)</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; using (ConnService connService = new ConnService())</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return connService.SqlConnection.Execute(sql, p);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; else</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; using (Conn connService = new Conn())</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return connService.SqlConnection.Execute(sql, p);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</p><p>&nbsp; &nbsp; &nbsp; &nbsp; }</p><p>&nbsp; &nbsp; &nbsp; &nbsp; /// &lt;summary&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; /// 执行SQL语句</p><p>&nbsp; &nbsp; &nbsp; &nbsp; /// &lt;/summary&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; /// &lt;param name=&quot;sql&quot;&gt;sql语句&lt;/param&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; /// &lt;param name=&quot;p&quot;&gt;参数集合&lt;/param&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; public static void ExcuteSQL(string sql, DynamicParameters p, ConnService connService, IDbTransaction transaction)</p><p>&nbsp; &nbsp; &nbsp; &nbsp; {</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; connService.SqlConnection.Execute(sql, p, transaction);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; }</p><p>&nbsp; &nbsp; &nbsp; &nbsp; /// &lt;summary&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; /// 执行存储过程</p><p>&nbsp; &nbsp; &nbsp; &nbsp; /// &lt;/summary&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; /// &lt;param name=&quot;procName&quot;&gt;存储过程名称&lt;/param&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; /// &lt;param name=&quot;p&quot;&gt;参数集合&lt;/param&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; public static void ExcuteSP(string procName, DynamicParameters p)</p><p>&nbsp; &nbsp; &nbsp; &nbsp; {</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; using (ConnService connService = new ConnService())</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; connService.SqlConnection.Execute(procName, p, commandTimeout: 1800, commandType: CommandType.StoredProcedure);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</p><p>&nbsp; &nbsp; &nbsp; &nbsp; }</p><p>&nbsp; &nbsp; &nbsp; &nbsp; /// &lt;summary&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; /// 查询单个返回值</p><p>&nbsp; &nbsp; &nbsp; &nbsp; /// &lt;/summary&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; /// &lt;param name=&quot;sql&quot;&gt;sql语句&lt;/param&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; /// &lt;param name=&quot;p&quot;&gt;参数集合&lt;/param&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; /// &lt;returns&gt;int型返回值&lt;/returns&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; public static int ExecuteScalar(string sql, DynamicParameters p)</p><p>&nbsp; &nbsp; &nbsp; &nbsp; {</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; using (ConnService connService = new ConnService())</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return connService.SqlConnection.Query&lt;int&gt;(sql, p).First();</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</p><p>&nbsp; &nbsp; &nbsp; &nbsp; }</p><p>&nbsp; &nbsp; &nbsp; &nbsp; /// &lt;summary&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; /// 查询单个返回值</p><p>&nbsp; &nbsp; &nbsp; &nbsp; /// &lt;/summary&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; /// &lt;param name=&quot;sql&quot;&gt;sql语句&lt;/param&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; /// &lt;param name=&quot;p&quot;&gt;参数集合&lt;/param&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; /// &lt;returns&gt;decimal型返回值&lt;/returns&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; public static decimal ExecuteScalarDecimal(string sql, DynamicParameters p)</p><p>&nbsp; &nbsp; &nbsp; &nbsp; {</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; using (ConnService connService = new ConnService())</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return connService.SqlConnection.Query&lt;decimal&gt;(sql, p).First();</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</p><p>&nbsp; &nbsp; &nbsp; &nbsp; }</p><p>&nbsp; &nbsp; &nbsp; &nbsp; /// &lt;summary&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; /// 查询单个返回值</p><p>&nbsp; &nbsp; &nbsp; &nbsp; /// &lt;/summary&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; /// &lt;param name=&quot;sql&quot;&gt;sql语句&lt;/param&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; /// &lt;param name=&quot;p&quot;&gt;参数集合&lt;/param&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; /// &lt;returns&gt;float型返回值&lt;/returns&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; public static float ExecuteScalarfloat(string sql, DynamicParameters p)</p><p>&nbsp; &nbsp; &nbsp; &nbsp; {</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; using (ConnService connService = new ConnService())</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return connService.SqlConnection.Query&lt;float&gt;(sql, p).First();</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</p><p>&nbsp; &nbsp; &nbsp; &nbsp; }</p><p>&nbsp; &nbsp; &nbsp; &nbsp; /// &lt;summary&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; /// 查询字符串类型的单个返回值</p><p>&nbsp; &nbsp; &nbsp; &nbsp; /// &lt;/summary&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; /// &lt;param name=&quot;sql&quot;&gt;sql语句&lt;/param&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; /// &lt;param name=&quot;p&quot;&gt;参数集合&lt;/param&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; /// &lt;returns&gt;string型返回值&lt;/returns&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; public static string ExecuteScalarString(string sql, DynamicParameters p)</p><p>&nbsp; &nbsp; &nbsp; &nbsp; {</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; using (ConnService connService = new ConnService())</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return connService.SqlConnection.Query&lt;string&gt;(sql, p).First();</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</p><p>&nbsp; &nbsp; &nbsp; &nbsp; }</p><p>&nbsp; &nbsp; &nbsp; &nbsp; /// &lt;summary&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; /// 查询单个返回值</p><p>&nbsp; &nbsp; &nbsp; &nbsp; /// &lt;/summary&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; /// &lt;param name=&quot;procName&quot;&gt;存储过程名称&lt;/param&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; /// &lt;param name=&quot;p&quot;&gt;参数集合&lt;/param&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; /// &lt;returns&gt;int型返回值&lt;/returns&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; public static int ExecuteScalarBySP(string procName, DynamicParameters p)</p><p>&nbsp; &nbsp; &nbsp; &nbsp; {</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; using (ConnService connService = new ConnService())</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return connService.SqlConnection.Query&lt;int&gt;(procName, p).First();</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</p><p>&nbsp; &nbsp; &nbsp; &nbsp; }</p><p>&nbsp; &nbsp; &nbsp; &nbsp; /// &lt;summary&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; /// 将一个集合保存到数据库</p><p>&nbsp; &nbsp; &nbsp; &nbsp; /// &lt;/summary&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; /// &lt;typeparam name=&quot;T&quot;&gt;集合类型&lt;/typeparam&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; /// &lt;param name=&quot;sql&quot;&gt;sql语句,示例 insert AUT_User (Name,Age) values(@Name, @Age)&lt;/param&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; /// &lt;param name=&quot;collection&quot;&gt;集合对象&lt;/param&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; public static void SaveCollection&lt;T&gt;(string sql, IList&lt;T&gt; collection)</p><p>&nbsp; &nbsp; &nbsp; &nbsp; {</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; using (ConnService connService = new ConnService())</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; connService.SqlConnection.Execute(sql, collection, null, 1800);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</p><p>&nbsp; &nbsp; &nbsp; &nbsp; }</p><p>&nbsp; &nbsp; &nbsp; &nbsp; /// &lt;summary&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; /// 将一个集合保存到数据库</p><p>&nbsp; &nbsp; &nbsp; &nbsp; /// &lt;/summary&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; /// &lt;typeparam name=&quot;T&quot;&gt;集合类型&lt;/typeparam&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; /// &lt;param name=&quot;sql&quot;&gt;sql语句,示例 insert AUT_User (Name,Age) values(@Name, @Age)&lt;/param&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; /// &lt;param name=&quot;collection&quot;&gt;集合对象&lt;/param&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; public static void SaveCollection&lt;T&gt;(string sql, IList&lt;T&gt; collection, ConnService connService, IDbTransaction transaction)</p><p>&nbsp; &nbsp; &nbsp; &nbsp; {</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; connService.SqlConnection.Execute(sql, collection, transaction);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; }</p><p>&nbsp; &nbsp; &nbsp; &nbsp; /// &lt;summary&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; /// 判断数据库中是否存在该数据</p><p>&nbsp; &nbsp; &nbsp; &nbsp; /// &lt;/summary&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; /// &lt;param name=&quot;sql&quot;&gt;sql语句&lt;/param&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; /// &lt;param name=&quot;p&quot;&gt;参数集合&lt;/param&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; /// &lt;returns&gt;存在返回 True&lt;/returns&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; public static bool Exists(string sql, DynamicParameters p)</p><p>&nbsp; &nbsp; &nbsp; &nbsp; {</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; int recordCount = 0;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; using (ConnService connService = new ConnService())</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; recordCount = connService.SqlConnection.Query&lt;int&gt;(sql, p).First();</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return (recordCount &gt; 0) ? true : false;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; }</p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; /// &lt;summary&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; /// 根据SQL返回DataTable</p><p>&nbsp; &nbsp; &nbsp; &nbsp; /// &lt;/summary&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; /// &lt;param name=&quot;strSQL&quot;&gt;&lt;/param&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; /// &lt;param name=&quot;paras&quot;&gt;&lt;/param&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; /// &lt;param name=&quot;strTableName&quot;&gt;&lt;/param&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; /// &lt;returns&gt;&lt;/returns&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; public static DataTable GetDataTableFromSQL(string strSQL, List&lt;SqlParameter&gt; paras = null, string strTableName = null)</p><p>&nbsp; &nbsp; &nbsp; &nbsp; {</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; using (ConnService objConn = new ConnService())</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DataTable dt = new DataTable();</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SqlDataAdapter da = new SqlDataAdapter();</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SqlCommand cmd = new SqlCommand();</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SqlConne
                        </code>
                        </pre>
                        <div class="bdsharebuttonbox"><a href="#" class="bds_more" data-cmd="more"></a><a href="#" class="bds_qzone" data-cmd="qzone"></a><a href="#" class="bds_tsina" data-cmd="tsina"></a><a href="#" class="bds_tqq" data-cmd="tqq"></a><a href="#" class="bds_renren" data-cmd="renren"></a><a href="#" class="bds_weixin" data-cmd="weixin"></a></div>
                        <!-- UY BEGIN -->
                        <div id="uyan_frame"></div>
                        <script type="text/javascript" src="http://v2.uyan.cc/code/uyan.js?uid=2113268"></script>
                        <!-- UY END -->
                    </div>
                </div>
                <div id="footerInnerSeparator"></div>
            </div>
        </div>
        <div id="footerOuterSeparator"></div>
    </div>
    <br /><br /><br />
    <script src="../../js/jquery-1.9.1.js"></script>
    <script>
        window._bd_share_config = { "common": { "bdSnsKey": {}, "bdText": $("#divMain pre code").text(), "bdMini": "2", "bdPic": "", "bdStyle": "0", "bdSize": "16" }, "share": {}, "image": { "viewList": ["qzone", "tsina", "tqq", "renren", "weixin"], "viewText": "分享到：", "viewSize": "16" }, "selectShare": { "bdContainerClass": null, "bdSelectMiniList": ["qzone", "tsina", "tqq", "renren", "weixin"] } }; with (document) 0[(getElementsByTagName('head')[0] || body).appendChild(createElement('script')).src = 'http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion=' + ~(-new Date() / 36e5)];
    </script>
</body>
</html>