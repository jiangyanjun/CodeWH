<!DOCTYPE HTML>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="Language" content="zh-CN">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="shortcut icon" href="../../images/kebue.ico">
    <link rel="icon" href="../../images/kebue.ico">
    <meta name="description" content=MERGE INTO>
    <meta name="keywords" content=MERGE INTOOracle9i引入了MERGE命令,你能够在一个SQL语句中对一个表同时执行inserts和updates操作. MERGE命令从一个或多个数据源中选择行来updating或inserting到一个或多个表.Oracle 10g中MERGE有如下一些改进：1、UPDATE或INSERT子句是可选的2、UPDATE和INSERT子句可以加WHERE子句3、ON条件中使用常量过滤>
    <title>MERGE INTO</title>

    <link href="../../template/scripts/bootstrap/css/bootstrap.min.css" rel="stylesheet" />
    <link href="../../template/styles/custom.css" rel="stylesheet" />
</head>
<body id="pageBody">
    <div id="divBoxed" class="container">
        <div class="transparent-bg" style="position: absolute;top: 0;left: 0;width: 100%;height: 100%;z-index: -1;zoom: 1;"></div>
        <div class="divPanel notop nobottom">
            <div class="row-fluid">
                <div class="span12">
                    <div id="divLogo">
                        <a href="../../../Home/Index" id="divSiteTitle">科布尔 kebue</a><br />
                        <a href="../../../Home/Index" id="divTagLine">开发者用代码改变世界从科布尔开始</a>
                    </div>
                </div>
            </div>
            <div class="row-fluid">
                <div class="span12">
                    <div id="divMenuRight" class="pull-right">
                        <div class="navbar">
                            <button type="button" class="btn btn-navbar-highlight btn-large btn-primary" data-toggle="collapse" data-target=".nav-collapse">
                                NAVIGATION <span class="icon-chevron-down icon-white"></span>
                            </button>
                            <div class="nav-collapse collapse">
                                <ul class="nav nav-pills ddmenu">
                                    <li class="dropdown glyphicon glyphicon-arrow-left"><a href='javascript:window.history.back()'>后退</a></li>
                                    <li class="dropdown active"><a href="http://www.kebue.com/">Home</a></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row-fluid">
                <div class="span12">
                    <div id="contentInnerSeparator"></div>
                </div>
            </div>
        </div>
        <div class="contentArea">
            <div class="divPanel notop page-content">
                <div class="breadcrumbs">
                    <a href="../../../Home/Index">Home</a> &nbsp;/&nbsp; <span><a href='../../../../../Artlcle/ArticleType/0D8667FF-B247-4368-A163-B9D7274FE236.html' title='Oracle'>Oracle</a></span>
                </div>
                <div class="row-fluid">
                    <div class="span12" id="divMain">
                        <h1>MERGE INTO</h1>
                        <pre>
                        <code>
                            <h1 style="background-color: inherit;">MERGE INTO</h1><p style="background-color: inherit;">Oracle9i引入了MERGE命令,你能够在一个SQL语句中对一个表同时执行inserts和updates操作. MERGE命令从一个或多个数据源中选择行来updating或inserting到一个或多个表.</p><p style="background-color: inherit;"><br style="background-color: inherit;"/></p><p style="background-color: inherit;">Oracle 10g中MERGE有如下一些改进：</p><p style="background-color: inherit;"><br style="background-color: inherit;"/></p><p style="background-color: inherit;"><br style="background-color: inherit;"/></p><p style="background-color: inherit;">1、UPDATE或INSERT子句是可选的</p><p style="background-color: inherit;"><br style="background-color: inherit;"/></p><p style="background-color: inherit;"><br style="background-color: inherit;"/></p><p style="background-color: inherit;">2、UPDATE和INSERT子句可以加WHERE子句</p><p style="background-color: inherit;"><br style="background-color: inherit;"/></p><p style="background-color: inherit;"><br style="background-color: inherit;"/></p><p style="background-color: inherit;">3、ON条件中使用常量过滤谓词来insert所有的行到目标表中,不需要连接源表和目标表</p><p style="background-color: inherit;"><br style="background-color: inherit;"/></p><p style="background-color: inherit;"><br style="background-color: inherit;"/></p><p style="background-color: inherit;">4、UPDATE子句后面可以跟DELETE子句来去除一些不需要的行</p><p style="background-color: inherit;"><br style="background-color: inherit;"/></p><p style="background-color: inherit;"><br style="background-color: inherit;"/></p><p style="background-color: inherit;"><br style="background-color: inherit;"/></p><p style="background-color: inherit;">首先创建示例表：</p><p style="background-color: inherit;"><br style="background-color: inherit;"/></p><p style="background-color: inherit;"><br style="background-color: inherit;"/></p><p style="background-color: inherit;">create table PRODUCTS</p><p style="background-color: inherit;">&nbsp; &nbsp; (</p><p style="background-color: inherit;">&nbsp; &nbsp; PRODUCT_ID INTEGER,</p><p style="background-color: inherit;">&nbsp; &nbsp; PRODUCT_NAME VARCHAR2(60),</p><p style="background-color: inherit;">&nbsp; &nbsp; CATEGORY VARCHAR2(60)</p><p style="background-color: inherit;">&nbsp; &nbsp; );</p><p style="background-color: inherit;"><br style="background-color: inherit;"/></p><p style="background-color: inherit;">&nbsp; &nbsp; insert into PRODUCTS values (1501, &#39;VIVITAR 35MM&#39;, &#39;ELECTRNCS&#39;);</p><p style="background-color: inherit;">&nbsp; &nbsp; insert into PRODUCTS values (1502, &#39;OLYMPUS IS50&#39;, &#39;ELECTRNCS&#39;);</p><p style="background-color: inherit;">&nbsp; &nbsp; insert into PRODUCTS values (1600, &#39;PLAY GYM&#39;, &#39;TOYS&#39;);</p><p style="background-color: inherit;">&nbsp; &nbsp; insert into PRODUCTS values (1601, &#39;LAMAZE&#39;, &#39;TOYS&#39;);</p><p style="background-color: inherit;">&nbsp; &nbsp; insert into PRODUCTS values (1666, &#39;HARRY POTTER&#39;, &#39;DVD&#39;);</p><p style="background-color: inherit;">&nbsp; &nbsp; commit;</p><p style="background-color: inherit;"><br style="background-color: inherit;"/></p><p style="background-color: inherit;">&nbsp; &nbsp; create table NEWPRODUCTS</p><p style="background-color: inherit;">&nbsp; &nbsp; (</p><p style="background-color: inherit;">&nbsp; &nbsp; PRODUCT_ID INTEGER,</p><p style="background-color: inherit;">&nbsp; &nbsp; PRODUCT_NAME VARCHAR2(60),</p><p style="background-color: inherit;">&nbsp; &nbsp; CATEGORY VARCHAR2(60)</p><p style="background-color: inherit;">&nbsp; &nbsp; );</p><p style="background-color: inherit;"><br style="background-color: inherit;"/></p><p style="background-color: inherit;">&nbsp; &nbsp; insert into NEWPRODUCTS values (1502, &#39;OLYMPUS CAMERA&#39;, &#39;ELECTRNCS&#39;);</p><p style="background-color: inherit;">&nbsp; &nbsp; insert into NEWPRODUCTS values (1601, &#39;LAMAZE&#39;, &#39;TOYS&#39;);</p><p style="background-color: inherit;">&nbsp; &nbsp; insert into NEWPRODUCTS values (1666, &#39;HARRY POTTER&#39;, &#39;TOYS&#39;);</p><p style="background-color: inherit;">&nbsp; &nbsp; insert into NEWPRODUCTS values (1700, &#39;WAIT INTERFACE&#39;, &#39;BOOKS&#39;);</p><p style="background-color: inherit;">&nbsp; &nbsp; commit;</p><p style="background-color: inherit;"><br style="background-color: inherit;"/></p><p style="background-color: inherit;"><br style="background-color: inherit;"/></p><p style="background-color: inherit;">1、可省略的UPDATE或INSERT子句</p><p style="background-color: inherit;"><br style="background-color: inherit;"/></p><p style="background-color: inherit;"><br style="background-color: inherit;"/></p><p style="background-color: inherit;">在Oracle 9i, MERGE语句要求你必须同时指定INSERT和UPDATE子句.而在Oracle 10g, 你可以省略UPDATE或INSERT子句中的一个. 下面的例子根据表NEWPRODUCTS的PRODUCT_ID字段是否匹配来updates表PRODUCTS的信息:</p><p style="background-color: inherit;"><br style="background-color: inherit;"/></p><p style="background-color: inherit;"><br style="background-color: inherit;"/></p><p style="background-color: inherit;">SQL&gt; MERGE INTO products p</p><p style="background-color: inherit;">&nbsp; &nbsp; 2 USING newproducts np</p><p style="background-color: inherit;">&nbsp; &nbsp; 3 ON (p.product_id = np.product_id)</p><p style="background-color: inherit;">&nbsp; &nbsp; 4 WHEN MATCHED THEN</p><p style="background-color: inherit;">&nbsp; &nbsp; 5 UPDATE</p><p style="background-color: inherit;">&nbsp; &nbsp; 6 SET p.product_name = np.product_name,</p><p style="background-color: inherit;">&nbsp; &nbsp; 7 p.category = np.category;</p><p style="background-color: inherit;"><br style="background-color: inherit;"/></p><p style="background-color: inherit;">&nbsp; &nbsp; 3 rows merged.</p><p style="background-color: inherit;"><br style="background-color: inherit;"/></p><p style="background-color: inherit;">&nbsp; &nbsp; SQL&gt; SELECT * FROM products;</p><p style="background-color: inherit;"><br style="background-color: inherit;"/></p><p style="background-color: inherit;">&nbsp; &nbsp; PRODUCT_ID PRODUCT_NAME CATEGORY</p><p style="background-color: inherit;">&nbsp; &nbsp; ---------- -------------------- ----------</p><p style="background-color: inherit;">&nbsp; &nbsp; 1501 VIVITAR 35MM ELECTRNCS</p><p style="background-color: inherit;">&nbsp; &nbsp; 1502 OLYMPUS CAMERA ELECTRNCS</p><p style="background-color: inherit;">&nbsp; &nbsp; 1600 PLAY GYM TOYS</p><p style="background-color: inherit;">&nbsp; &nbsp; 1601 LAMAZE TOYS</p><p style="background-color: inherit;">&nbsp; &nbsp; 1666 HARRY POTTER TOYS</p><p style="background-color: inherit;">&nbsp; &nbsp; SQL&gt;</p><p style="background-color: inherit;">&nbsp; &nbsp; SQL&gt; ROLLBACK;</p><p style="background-color: inherit;">&nbsp; &nbsp; Rollback complete.</p><p style="background-color: inherit;">&nbsp; &nbsp; SQL&gt;</p><p style="background-color: inherit;"><br style="background-color: inherit;"/></p><p style="background-color: inherit;"><br style="background-color: inherit;"/></p><p style="background-color: inherit;"><br style="background-color: inherit;"/></p><p style="background-color: inherit;">在上面例子中, MERGE语句影响到是产品id为1502, 1601和1666的行. 它们的产品名字和种 类被更新为表newproducts中的值. 下面例子省略UPDATE子句, 把表NEWPRODUCTS中新的PRODUCT_ID插入到表PRODUCTS中, 对于在两个表中能够匹配上PRODUCT_ID的数据不作任何处理. 从这个例子你能看到PRODUCT_ID=1700的行被插入到表PRODUCTS中.</p><p style="background-color: inherit;"><br style="background-color: inherit;"/></p><p style="background-color: inherit;"><br style="background-color: inherit;"/></p><p style="background-color: inherit;">SQL&gt; MERGE INTO products p</p><p style="background-color: inherit;">&nbsp; &nbsp; 2 USING newproducts np</p><p style="background-color: inherit;">&nbsp; &nbsp; 3 ON (p.product_id = np.product_id)</p><p style="background-color: inherit;">&nbsp; &nbsp; 4 WHEN NOT MATCHED THEN</p><p style="background-color: inherit;">&nbsp; &nbsp; 5 INSERT</p><p style="background-color: inherit;">&nbsp; &nbsp; 6 VALUES (np.product_id, np.product_name,</p><p style="background-color: inherit;">&nbsp; &nbsp; 7 np.category);</p><p style="background-color: inherit;"><br style="background-color: inherit;"/></p><p style="background-color: inherit;">&nbsp; &nbsp; 1 row merged.</p><p style="background-color: inherit;"><br style="background-color: inherit;"/></p><p style="background-color: inherit;">&nbsp; &nbsp; SQL&gt; SELECT * FROM products;</p><p style="background-color: inherit;"><br style="background-color: inherit;"/></p><p style="background-color: inherit;">&nbsp; &nbsp; PRODUCT_ID PRODUCT_NAME CATEGORY</p><p style="background-color: inherit;">&nbsp; &nbsp; ---------- -------------------- ----------</p><p style="background-color: inherit;">&nbsp; &nbsp; 1501 VIVITAR 35MM ELECTRNCS</p><p style="background-color: inherit;">&nbsp; &nbsp; 1502 OLYMPUS IS50 ELECTRNCS</p><p style="background-color: inherit;">&nbsp; &nbsp; 1600 PLAY GYM TOYS</p><p style="background-color: inherit;">&nbsp; &nbsp; 1601 LAMAZE TOYS</p><p style="background-color: inherit;">&nbsp; &nbsp; 1666 HARRY POTTER DVD</p><p style="background-color: inherit;">&nbsp; &nbsp; 1700 WAIT INTERFACE BOOKS</p><p style="background-color: inherit;"><br style="background-color: inherit;"/></p><p style="background-color: inherit;"><br style="background-color: inherit;"/></p><p style="background-color: inherit;">2、带条件的Updates和Inserts子句</p><p style="background-color: inherit;"><br style="background-color: inherit;"/></p><p style="background-color: inherit;"><br style="background-color: inherit;"/></p><p style="background-color: inherit;">你能够添加WHERE子句到UPDATE或INSERT子句中去, 来跳过update或insert操作对某些行的处理. 下面例子根据表NEWPRODUCTS来更新表PRODUCTS数据, 但必须字段CATEGORY也得同时匹配上:</p><p style="background-color: inherit;"><br style="background-color: inherit;"/></p><p style="background-color: inherit;"><br style="background-color: inherit;"/></p><p style="background-color: inherit;">SQL&gt; MERGE INTO products p</p><p style="background-color: inherit;">&nbsp; &nbsp; 2 USING newproducts np</p><p style="background-color: inherit;">&nbsp; &nbsp; 3 ON (p.product_id = np.product_id)</p><p style="background-color: inherit;">&nbsp; &nbsp; 4 WHEN MATCHED THEN</p><p style="background-color: inherit;">&nbsp; &nbsp; 5 UPDATE</p><p style="background-color: inherit;">&nbsp; &nbsp; 6 SET p.product_name = np.product_name</p><p style="background-color: inherit;">&nbsp; &nbsp; 7 WHERE p.category = np.category;</p><p style="background-color: inherit;"><br style="background-color: inherit;"/></p><p style="background-color: inherit;">&nbsp; &nbsp; 2 rows merged.</p><p style="background-color: inherit;"><br style="background-color: inherit;"/></p><p style="background-color: inherit;">&nbsp; &nbsp; SQL&gt; SELECT * FROM products;</p><p style="background-color: inherit;"><br style="background-color: inherit;"/></p><p style="background-color: inherit;">&nbsp; &nbsp; PRODUCT_ID PRODUCT_NAME CATEGORY</p><p style="background-color: inherit;">&nbsp; &nbsp; ---------- -------------------- ----------</p><p style="background-color: inherit;">&nbsp; &nbsp; 1501 VIVITAR 35MM ELECTRNCS</p><p style="background-color: inherit;">&nbsp; &nbsp; 1502 OLYMPUS CAMERA ELECTRNCS</p><p style="background-color: inherit;">&nbsp; &nbsp; 1600 PLAY GYM TOYS</p><p style="background-color: inherit;">&nbsp; &nbsp; 1601 LAMAZE TOYS</p><p style="background-color: inherit;">&nbsp; &nbsp; 1666 HARRY POTTER DVD</p><p style="background-color: inherit;">&nbsp; &nbsp; SQL&gt;</p><p style="background-color: inherit;">&nbsp; &nbsp; SQL&gt; rollback;</p><p style="background-color: inherit;"><br style="background-color: inherit;"/></p><p style="background-color: inherit;"><br style="background-color: inherit;"/></p><p style="background-color: inherit;"><br style="background-color: inherit;"/></p><p style="background-color: inherit;">在这个例子中, 产品ID为1502,1601和1666匹配ON条件但是1666的category不匹配. 因此MERGE命令只更新两行数据. 下面例子展示了在Updates和Inserts子句都使用WHERE子句:</p><p style="background-color: inherit;"><br style="background-color: inherit;"/></p><p style="background-color: inherit;"><br style="background-color: inherit;"/></p><p style="background-color: inherit;">SQL&gt; MERGE INTO products p</p><p style="background-color: inherit;">&nbsp; &nbsp; 2 USING newproducts np</p><p style="background-color: inherit;">&nbsp; &nbsp; 3 ON (p.product_id = np.product_id)</p><p style="background-color: inherit;">&nbsp; &nbsp; 4 WHEN MATCHED THEN</p><p style="background-color: inherit;">&nbsp; &nbsp; 5 UPDATE</p><p style="background-color: inherit;">&nbsp; &nbsp; 6 SET p.product_name = np.product_name,</p><p style="background-color: inherit;">&nbsp; &nbsp; 7 p.category = np.category</p><p style="background-color: inherit;">&nbsp; &nbsp; 8 WHERE p.category = &#39;DVD&#39;</p><p style="background-color: inherit;">&nbsp; &nbsp; 9 WHEN NOT MATCHED THEN</p><p style="background-color: inherit;">&nbsp; &nbsp; 10 INSERT</p><p style="background-color: inherit;">&nbsp; &nbsp; 11 VALUES (np.product_id, np.product_name, np.category)</p><p style="background-color: inherit;">&nbsp; &nbsp; 12 WHERE np.category != &#39;BOOKS&#39;</p><p style="background-color: inherit;">&nbsp; &nbsp; SQL&gt; /</p><p style="background-color: inherit;"><br style="background-color: inherit;"/></p><p style="background-color: inherit;">&nbsp; &nbsp; 1 row merged.</p><p style="background-color: inherit;"><br style="background-color: inherit;"/></p><p style="background-color: inherit;">&nbsp; &nbsp; SQL&gt; SELECT * FROM products;</p><p style="background-color: inherit;"><br style="background-color: inherit;"/></p><p style="background-color: inherit;">&nbsp; &nbsp; PRODUCT_ID PRODUCT_NAME CATEGORY</p><p style="background-color: inherit;">&nbsp; &nbsp; ---------- -------------------- ----------</p><p style="background-color: inherit;">&nbsp; &nbsp; 1501 VIVITAR 35MM ELECTRNCS</p><p style="background-color: inherit;">&nbsp; &nbsp; 1502 OLYMPUS IS50 ELECTRNCS</p><p style="background-color: inherit;">&nbsp; &nbsp; 1600 PLAY GYM TOYS</p><p style="background-color: inherit;">&nbsp; &nbsp; 1601 LAMAZE TOYS</p><p style="background-color: inherit;">&nbsp; &nbsp; 1666 HARRY POTTER TOYS</p><p style="background-color: inherit;"><br style="background-color: inherit;"/></p><p style="background-color: inherit;">&nbsp; &nbsp; SQL&gt;</p><p style="background-color: inherit;"><br style="background-color: inherit;"/></p><p style="background-color: inherit;"><br style="background-color: inherit;"/></p><p style="background-color: inherit;">注意由于有WHERE子句INSERT没有插入所有不匹配ON条件的行到表PRODUCTS.</p><p style="background-color: inherit;"><br style="background-color: inherit;"/></p><p style="background-color: inherit;"><br style="background-color: inherit;"/></p><p style="background-color: inherit;">3、无条件的Inserts</p><p style="background-color: inherit;"><br style="background-color: inherit;"/></p><p style="background-color: inherit;"><br style="background-color: inherit;"/></p><p style="background-color: inherit;">你能够不用连接源表和目标表就把源表的数据插入到目标表中. 这对于你想插入所有行到目标表时是非常有用的. Oracle 10g现在支持在ON条件中使用常量过滤谓词. 举个常量过滤谓词例子ON (1=0). 下面例子从源表插入行到表PRODUCTS, 不检查这些行是否在表PRODUCTS中存在:</p><p style="background-color: inherit;"><br style="background-color: inherit;"/></p><p style="background-color: inherit;">SQL&gt; MERGE INTO products p</p><p style="background-color: inherit;">&nbsp; &nbsp; 2 USING newproducts np</p><p style="background-color: inherit;">&nbsp; &nbsp; 3 ON (1=0)</p><p style="background-color: inherit;">&nbsp; &nbsp; 4 WHEN NOT MATCHED THEN</p><p style="background-color: inherit;">&nbsp; &nbsp; 5 INSERT</p><p style="background-color: inherit;">&nbsp; &nbsp; 6 VALUES (np.product_id, np.product_name, np.category)</p><p style="background-color: inherit;">&nbsp; &nbsp; 7 WHERE np.category = &#39;BOOKS&#39;</p><p style="background-color: inherit;">&nbsp; &nbsp; SQL&gt; /</p><p style="background-color: inherit;"><br style="background-color: inherit;"/></p><p style="background-color: inherit;">&nbsp; &nbsp; 1 row merged.</p><p style="background-color: inherit;"><br style="background-color: inherit;"/></p><p style="background-color: inherit;">&nbsp; &nbsp; SQL&gt; SELECT * FROM products;</p><p style="background-color: inherit;"><br style="background-color: inherit;"/></p><p style="background-color: inherit;">&nbsp; &nbsp; PRODUCT_ID PRODUCT_NAME CATEGORY</p><p style="background-color: inherit;">&nbsp; &nbsp; ---------- -------------------- ----------</p><p style="background-color: inherit;">&nbsp; &nbsp; 1501 VIVITAR 35MM ELECTRNCS</p><p style="background-color: inherit;">&nbsp; &nbsp; 1502 OLYMPUS IS50 ELECTRNCS</p><p style="background-color: inherit;">&nbsp; &nbsp; 1600 PLAY GYM TOYS</p><p style="background-color: inherit;">&nbsp; &nbsp; 1601 LAMAZE TOYS</p><p style="background-color: inherit;">&nbsp; &nbsp; 1666 HARRY POTTER DVD</p><p style="background-color: inherit;">&nbsp; &nbsp; 1700 WAIT INTERFACE BOOKS</p><p style="background-color: inherit;">&nbsp; &nbsp; 6 rows selected.</p><p style="background-color: inherit;">&nbsp; &nbsp; SQL&gt;</p><p style="background-color: inherit;"><br style="background-color: inherit;"/></p><p style="background-color: inherit;"><br style="background-color: inherit;"/></p><p style="background-color: inherit;"><br style="background-color: inherit;"/></p><p style="background-color: inherit;">4、新增加的DELETE子句</p><p style="background-color: inherit;"><br style="background-color: inherit;"/></p><p style="background-color: inherit;"><br style="background-color: inherit;"/></p><p style="background-color: inherit;">Oracle 10g中的MERGE提供了在执行数据操作时清除行的选项. 你能够在WHEN MATCHED THEN UPDATE子句中包含DELETE子句. DELETE子句必须有一个WHERE条件来删除匹配某些条件的行.匹配DELETE WHERE条件但不匹配ON条件的行不会被从表中删除.</p><p style="background-color: inherit;"><br style="background-color: inherit;"/></p><p style="background-color: inherit;"><br style="background-color: inherit;"/></p><p style="background-color: inherit;">下面例子验证DELETE子句. 我们从表NEWPRODUCTS中合并行到表PRODUCTS中, 但删除category为ELECTRNCS的行.</p><p style="background-color: inherit;"><br style="background-color: inherit;"/></p><p style="background-color: inherit;"><br style="background-color: inherit;"/></p><p style="background-color: inherit;">SQL&gt; MERGE INTO products p</p><p style="background-color: inherit;">&nbsp; &nbsp; 2 USING newproducts np</p><p style="background-color: inherit;">&nbsp; &nbsp; 3 ON (p.product_id = np.product_id)</p><p style="background-color: inherit;">&nbsp; &nbsp; 4 WHEN MATCHED THEN</p><p style="background-color: inherit;">&nbsp; &nbsp; 5 UPDATE</p><p style="background-color: inherit;">&nbsp; &nbsp; 6 SET p.product_name = np.product_name,</p><p style="background-color: inherit;">&nbsp; &nbsp; 7 p.category = np.category</p><p style="background-color: inherit;">&nbsp; &nbsp; 8 DELETE WHERE (p.category = &#39;ELECTRNCS&#39;)</p><p style="background-color: inherit;">&nbsp; &nbsp; 9 WHEN NOT MATCHED THEN</p><p style="background-color: inherit;">&nbsp; &nbsp; 10 INSERT</p><p style="background-color: inherit;">&nbsp; &nbsp; 11 VALUES (np.product_id, np.product_name, np.category)</p><p style="background-color: inherit;">&nbsp; &nbsp; SQL&gt; /</p><p style="background-color: inherit;"><br style="background-color: inherit;"/></p><p style="background-color: inherit;">&nbsp; &nbsp; 4 rows merged.</p><p style="background-color: inherit;"><br style="background-color: inherit;"/></p><p style="background-color: inherit;">&nbsp; &nbsp; SQL&gt; SELECT * FROM products;</p><p style="background-color: inherit;"><br style="background-color: inherit;"/></p><p style="background-color: inherit;">&nbsp; &nbsp; PRODUCT_ID PRODUCT_NAME CATEGORY</p><p style="background-color: inherit;">&nbsp; &nbsp; ---------- -------------------- ----------</p><p style="background-color: inherit;">&nbsp; &nbsp; 1501 VIVITAR 35MM ELECTRNCS</p><p style="background-color: inherit;">&nbsp; &nbsp; 1600 PLAY GYM TOYS</p><p style="background-color: inherit;">&nbsp; &nbsp; 1601 LAMAZE TOYS</p><p style="background-color: inherit;">&nbsp; &nbsp; 1666 HARRY POTTER TOYS</p><p style="background-color: inherit;">&nbsp; &nbsp; 1700 WAIT INTERFACE BOOKS</p><p style="background-color: inherit;">&nbsp; &nbsp; SQL&gt;</p><p style="background-color: inherit;"><br style="background-color: inherit;"/></p><p style="background-color: inherit;"><br style="background-color: inherit;"/></p><p style="background-color: inherit;"><br style="background-color: inherit;"/></p><p style="background-color: inherit;">产品ID为1502的行从表PRODUCTS中被删除, 因为它同时匹配ON条件和DELETE WHERE条件. 产品ID为1501的行匹配DELETE WHERE条件但不匹配ON条件, 所以它没有被删除. 产品ID为1700 的行不匹配ON条件, 所以被插入表PRODUCTS. 产品ID为1601和1666的行匹配ON条件但不匹配DELETE WHERE条件, 所以被更新为表NEWPRODUCTS中的值.</p><p><br/></p>
                        </code>
                        </pre>
                        <div class="bdsharebuttonbox"><a href="#" class="bds_more" data-cmd="more"></a><a href="#" class="bds_qzone" data-cmd="qzone"></a><a href="#" class="bds_tsina" data-cmd="tsina"></a><a href="#" class="bds_tqq" data-cmd="tqq"></a><a href="#" class="bds_renren" data-cmd="renren"></a><a href="#" class="bds_weixin" data-cmd="weixin"></a></div>
                        <!-- UY BEGIN -->
                        <div id="uyan_frame"></div>
                        <script type="text/javascript" src="http://v2.uyan.cc/code/uyan.js?uid=2113268"></script>
                        <!-- UY END -->
                    </div>
                </div>
                <div id="footerInnerSeparator"></div>
            </div>
        </div>
        <div id="footerOuterSeparator"></div>
    </div>
    <br /><br /><br />
    <script src="../../js/jquery-1.9.1.js"></script>
    <script>
        window._bd_share_config = { "common": { "bdSnsKey": {}, "bdText": $("#divMain pre code").text(), "bdMini": "2", "bdPic": "", "bdStyle": "0", "bdSize": "16" }, "share": {}, "image": { "viewList": ["qzone", "tsina", "tqq", "renren", "weixin"], "viewText": "分享到：", "viewSize": "16" }, "selectShare": { "bdContainerClass": null, "bdSelectMiniList": ["qzone", "tsina", "tqq", "renren", "weixin"] } }; with (document) 0[(getElementsByTagName('head')[0] || body).appendChild(createElement('script')).src = 'http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion=' + ~(-new Date() / 36e5)];
    </script>
</body>
</html>