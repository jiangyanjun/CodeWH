<!DOCTYPE HTML>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="Language" content="zh-CN">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="shortcut icon" href="../../images/kebue.ico">
    <link rel="icon" href="../../images/kebue.ico">
    <meta name="description" content=经典sql语句大全>
    <meta name="keywords" content=经典sql语句大全一、基础1、说明：创建数据库　　CREATE DATABASE database-name2、说明：删除数据库　　drop database dbname3、说明：备份sql server　　--- 创建 备份数据的 device　　USE master　　EXEC sp_addumpdevice disk, testBack, c:\mssql7backup\MyNwind_1>
    <title>经典sql语句大全</title>

    <link href="../../template/scripts/bootstrap/css/bootstrap.min.css" rel="stylesheet" />
    <link href="../../template/styles/custom.css" rel="stylesheet" />
</head>
<body id="pageBody">
    <div id="divBoxed" class="container">
        <div class="transparent-bg" style="position: absolute;top: 0;left: 0;width: 100%;height: 100%;z-index: -1;zoom: 1;"></div>
        <div class="divPanel notop nobottom">
            <div class="row-fluid">
                <div class="span12">
                    <div id="divLogo">
                        <a href="../../../Home/Index" id="divSiteTitle">科布尔 kebue</a><br />
                        <a href="../../../Home/Index" id="divTagLine">开发者用代码改变世界从科布尔开始</a>
                    </div>
                </div>
            </div>
            <div class="row-fluid">
                <div class="span12">
                    <div id="divMenuRight" class="pull-right">
                        <div class="navbar">
                            <button type="button" class="btn btn-navbar-highlight btn-large btn-primary" data-toggle="collapse" data-target=".nav-collapse">
                                NAVIGATION <span class="icon-chevron-down icon-white"></span>
                            </button>
                            <div class="nav-collapse collapse">
                                <ul class="nav nav-pills ddmenu">
                                    <li class="dropdown glyphicon glyphicon-arrow-left"><a href='javascript:window.history.back()'>后退</a></li>
                                    <li class="dropdown active"><a href="http://www.kebue.com/">Home</a></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row-fluid">
                <div class="span12">
                    <div id="contentInnerSeparator"></div>
                </div>
            </div>
        </div>
        <div class="contentArea">
            <div class="divPanel notop page-content">
                <div class="breadcrumbs">
                    <a href="../../../Home/Index">Home</a> &nbsp;/&nbsp; <span><a href='../../../../../Artlcle/ArticleType/A6B67D7C-1B75-4AF4-AF00-7D4EF126AFA9.html' title='SQLServer'>SQLServer</a></span>
                </div>
                <div class="row-fluid">
                    <div class="span12" id="divMain">
                        <h1>经典sql语句大全</h1>
                        <pre>
                        <code>
                            <h1 style="background-color: inherit;"><a href="http://www.cnblogs.com/aaaaq/p/4438995.html" style="background-color: inherit; cursor: pointer;">经典sql语句大全</a></h1><p style="background-color: inherit;"><strong style="background-color: inherit;">一、基础</strong></p><p style="background-color: inherit;"><strong style="background-color: inherit;">1、说明：创建数据库</strong></p><p style="background-color: inherit;">　　CREATE DATABASE database-name</p><p style="background-color: inherit;"><strong style="background-color: inherit;">2、说明：删除数据库</strong></p><p style="background-color: inherit;">　　drop database dbname</p><p style="background-color: inherit;"><strong style="background-color: inherit;">3、说明：备份sql server</strong></p><p style="background-color: inherit;">　　--- 创建 备份数据的 device</p><p style="background-color: inherit;">　　USE master</p><p style="background-color: inherit;">　　EXEC sp_addumpdevice &#39;disk&#39;, &#39;testBack&#39;, &#39;c:\mssql7backup\MyNwind_1.dat&#39;</p><p style="background-color: inherit;">　　--- 开始 备份</p><p style="background-color: inherit;">　　BACKUP DATABASE pubs TO testBack</p><p style="background-color: inherit;"><strong style="background-color: inherit;">4、说明：创建新表</strong></p><p style="background-color: inherit;">　　create table tabname(col1 type1 [not null] [primary key],col2 type2 [not null],..)</p><p style="background-color: inherit;">　　根据已有的表创建新表：</p><p style="background-color: inherit;">　　A：create table tab_new like tab_old (使用旧表创建新表)</p><p style="background-color: inherit;">　　B：create table tab_new as select col1,col2… from tab_old definition only</p><p style="background-color: inherit;"><strong style="background-color: inherit;">5、说明：删除新表</strong></p><p style="background-color: inherit;">　　drop table tabname</p><p style="background-color: inherit;"><strong style="background-color: inherit;">6、说明：增加一个列</strong></p><p style="background-color: inherit;">　　Alter table tabname add column col type</p><p style="background-color: inherit;">　　注：列增加后将不能删除。DB2中列加上后数据类型也不能改变，唯一能改变的是增加varchar类型的长度。</p><p style="background-color: inherit;"><strong style="background-color: inherit;">7、说明：添加主键：</strong>&nbsp;Alter table tabname add primary key(col)</p><p style="background-color: inherit;">　　说明：删除主键： Alter table tabname drop primary key(col)</p><p style="background-color: inherit;"><strong style="background-color: inherit;">8、说明：创建索引：</strong>create [unique] index idxname on tabname(col….)</p><p style="background-color: inherit;">　　删除索引：drop index idxname</p><p style="background-color: inherit;">　　注：索引是不可更改的，想更改必须删除重新建。</p><p style="background-color: inherit;"><strong style="background-color: inherit;">9、说明：创建视图：</strong>create view viewname as select statement</p><p style="background-color: inherit;">　　删除视图：drop view viewname</p><p style="background-color: inherit;"><strong style="background-color: inherit;">10、说明：几个简单的基本的sql语句</strong></p><p style="background-color: inherit;">　　选择：select * from table1 where 范围</p><p style="background-color: inherit;">　　插入：insert into table1(field1,field2) values(value1,value2)</p><p style="background-color: inherit;">　　删除：delete from table1 where 范围</p><p style="background-color: inherit;">　　更新：update table1 set field1=value1 where 范围</p><p style="background-color: inherit;">　　查找：select * from table1 where field1 like ’%value1%’ ---like的语法很精妙，查资料!</p><p style="background-color: inherit;">　　排序：select * from table1 order by field1,field2 [desc]</p><p style="background-color: inherit;">　　总数：select count as totalcount from table1</p><p style="background-color: inherit;">　　求和：select sum(field1) as sumvalue from table1</p><p style="background-color: inherit;">　　平均：select avg(field1) as avgvalue from table1</p><p style="background-color: inherit;">　　最大：select max(field1) as maxvalue from table1</p><p style="background-color: inherit;">　　最小：select min(field1) as minvalue from table1</p><p style="background-color: inherit;"><strong style="background-color: inherit;">11、说明：几个高级查询运算词</strong></p><p style="background-color: inherit;">　　A： UNION 运算符</p><p style="background-color: inherit;">　　UNION 运算符通过组合其他两个结果表（例如 TABLE1 和 TABLE2）并消去表中任何重复行而派生出一个结果表。当 ALL 随 UNION 一起使用时（即 UNION ALL），不消除重复行。两种情况下，派生表的每一行不是来自 TABLE1 就是来自 TABLE2。</p><p style="background-color: inherit;">　　B： EXCEPT 运算符</p><p style="background-color: inherit;">　　EXCEPT 运算符通过包括所有在 TABLE1 中但不在 TABLE2 中的行并消除所有重复行而派生出一个结果表。当 ALL 随 EXCEPT 一起使用时 (EXCEPT ALL)，不消除重复行。</p><p style="background-color: inherit;">　　C： INTERSECT 运算符</p><p style="background-color: inherit;">　　INTERSECT 运算符通过只包括 TABLE1 和 TABLE2 中都有的行并消除所有重复行而派生出一个结果表。当 ALL 随 INTERSECT 一起使用时 (INTERSECT ALL)，不消除重复行。</p><p style="background-color: inherit;">　　注：使用运算词的几个查询结果行必须是一致的。&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</p><p style="background-color: inherit;"><strong style="background-color: inherit;">12、说明：使用外连接</strong></p><p style="background-color: inherit;">　　A、left （outer） join：</p><p style="background-color: inherit;">　　左外连接（左连接）：结果集几包括连接表的匹配行，也包括左连接表的所有行。</p><p style="background-color: inherit;">　　SQL: select a.a, a.b, a.c, b.c, b.d, b.f from a LEFT OUT JOIN b ON a.a = b.c</p><p style="background-color: inherit;">　　B：right （outer） join:</p><p style="background-color: inherit;">　　右外连接(右连接)：结果集既包括连接表的匹配连接行，也包括右连接表的所有行。</p><p style="background-color: inherit;">　　C：full/cross （outer） join：</p><p style="background-color: inherit;">　　全外连接：不仅包括符号连接表的匹配行，还包括两个连接表中的所有记录。</p><p style="background-color: inherit;"><strong style="background-color: inherit;">13、分组:Group by:</strong></p><p style="background-color: inherit;">　　 一张表，一旦分组 完成后，查询后只能得到组相关的信息。</p><p style="background-color: inherit;">　　 组相关的信息：（统计信息） count,sum,max,min,avg 分组的标准)</p><p style="background-color: inherit;">　　 在SQLServer中分组时：不能以text,ntext,image类型的字段作为分组依据</p><p style="background-color: inherit;">　　 在selecte统计函数中的字段，不能和普通的字段放在一起；</p><p style="background-color: inherit;"><strong style="background-color: inherit;">14、对数据库进行操作：</strong></p><p style="background-color: inherit;">　　 分离数据库： sp_detach_db; 附加数据库：sp_attach_db 后接表明，附加需要完整的路径名</p><p style="background-color: inherit;"><strong style="background-color: inherit;">15.如何修改数据库的名称:</strong></p><p style="background-color: inherit;">　　sp_renamedb &#39;old_name&#39;, &#39;new_name&#39;</p><p style="background-color: inherit;"><strong style="background-color: inherit;">二、提升</strong></p><p style="background-color: inherit;"><strong style="background-color: inherit;">1、说明：复制表(只复制结构,源表名：a 新表名：b) (Access可用)</strong></p><p style="background-color: inherit;">　　法一：select * into b from a where 1&lt;&gt;1（仅用于SQlServer）</p><p style="background-color: inherit;">　　法二：select top 0 * into b from a</p><p style="background-color: inherit;"><strong style="background-color: inherit;">2、说明：拷贝表(拷贝数据,源表名：a 目标表名：b) (Access可用)</strong></p><p style="background-color: inherit;">　　insert into b(a, b, c) select d,e,f from b;</p><p style="background-color: inherit;"><strong style="background-color: inherit;">3、说明：跨数据库之间表的拷贝(具体数据使用绝对路径) (Access可用)</strong></p><p style="background-color: inherit;">　　insert into b(a, b, c) select d,e,f from b in ‘具体数据库’ where 条件</p><p style="background-color: inherit;">　　例子：..from b in &#39;&quot;&amp;Server.MapPath(&quot;.&quot;)&amp;&quot;\data.mdb&quot; &amp;&quot;&#39; where..</p><p style="background-color: inherit;"><strong style="background-color: inherit;">4、说明：子查询(表名1：a 表名2：b)</strong></p><p style="background-color: inherit;">　　select a,b,c from a where a IN (select d from b ) 或者: select a,b,c from a where a IN (1,2,3)</p><p style="background-color: inherit;"><strong style="background-color: inherit;">5、说明：显示文章、提交人和最后回复时间</strong></p><p style="background-color: inherit;">　　select a.title,a.username,b.adddate from table a,(select max(adddate) adddate from table where table.title=a.title) b</p><p style="background-color: inherit;"><strong style="background-color: inherit;">6、说明：外连接查询(表名1：a 表名2：b)</strong></p><p style="background-color: inherit;">　　select a.a, a.b, a.c, b.c, b.d, b.f from a LEFT OUT JOIN b ON a.a = b.c</p><p style="background-color: inherit;"><strong style="background-color: inherit;">7、说明：在线视图查询(表名1：a )</strong></p><p style="background-color: inherit;">　　select * from (SELECT a,b,c FROM a) T where t.a &gt; 1;</p><p style="background-color: inherit;"><strong style="background-color: inherit;">8、说明：between的用法,between限制查询数据范围时包括了边界值,not between不包括</strong></p><p style="background-color: inherit;">　　select * from table1 where time between time1 and time2</p><p style="background-color: inherit;">　　select a,b,c, from table1 where a not between 数值1 and 数值2</p><p style="background-color: inherit;"><strong style="background-color: inherit;">9、说明：in 的使用方法</strong></p><p style="background-color: inherit;">　　select * from table1 where a [not] in (‘值1’,’值2’,’值4’,’值6’)</p><p style="background-color: inherit;"><strong style="background-color: inherit;">10、说明：两张关联表，删除主表中已经在副表中没有的信息</strong></p><p style="background-color: inherit;">　　delete from table1 where not exists ( select * from table2 where table1.field1=table2.field1 )</p><p style="background-color: inherit;"><strong style="background-color: inherit;">11、说明：四表联查问题：</strong></p><p style="background-color: inherit;">　　select * from a left inner join b on a.a=b.b right inner join c on a.a=c.c inner join d on a.a=d.d where .....&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</p><p style="background-color: inherit;"><strong style="background-color: inherit;">12、说明：日程安排提前五分钟提醒</strong></p><p style="background-color: inherit;">　　SQL: select * from 日程安排 where datediff(&#39;minute&#39;,f开始时间,getdate())&gt;5</p><p style="background-color: inherit;"><strong style="background-color: inherit;">13、说明：一条sql 语句搞定数据库分页</strong></p><p style="background-color: inherit;">　　select top 10 b.* from (select top 20 主键字段,排序字段 from 表名 order by 排序字段 desc) a,表名 b where b.主键字段 = a.主键字段 order by a.排序字段</p><p style="background-color: inherit;">　　具体实现：</p><p style="background-color: inherit;">　　关于数据库分页：</p><p style="background-color: inherit;">　　declare @start int,@end int</p><p style="background-color: inherit;">　　@sql nvarchar(600)</p><p style="background-color: inherit;">　　set @sql=’select top’+str(@end-@start+1)+’+from T where rid not in(select top’+str(@str-1)+’Rid from T where Rid&gt;-1)’</p><p style="background-color: inherit;">　　exec sp_executesql @sql</p><p style="background-color: inherit;"><strong style="background-color: inherit;">注意：</strong>在top后不能直接跟一个变量，所以在实际应用中只有这样的进行特殊的处理。Rid为一个标识列，如果top后还有具体的字段，这样做是非常有好处的。因为这样可以避免 top的字段如果是逻辑索引的，查询的结果后实际表中的不一致（逻辑索引中的数据有可能和数据表中的不一致，而查询时如果处在索引则首先查询索引）</p><p style="background-color: inherit;"><strong style="background-color: inherit;">14、说明：前10条记录</strong></p><p style="background-color: inherit;">　　select top 10 * form table1 where 范围</p><p style="background-color: inherit;"><strong style="background-color: inherit;">15、说明：选择在每一组b值相同的数据中对应的a最大的记录的所有信息(类似这样的用法可以用于论坛每月排行榜,每月热销产品分析,按科目成绩排名,等等.)</strong></p><p style="background-color: inherit;">　　select a,b,c from tablename ta where a=(select max(a) from tablename tb where tb.b=ta.b)</p><p style="background-color: inherit;"><strong style="background-color: inherit;">16、说明：包括所有在 TableA 中但不在 TableB和TableC 中的行并消除所有重复行而派生出一个结果表</strong></p><p style="background-color: inherit;">　　(select a from tableA ) except (select a from tableB) except (select a from tableC)</p><p style="background-color: inherit;"><strong style="background-color: inherit;">17、说明：随机取出10条数据</strong></p><p style="background-color: inherit;">　　select top 10 * from tablename order by newid()</p><p style="background-color: inherit;"><strong style="background-color: inherit;">18、说明：随机选择记录</strong></p><p style="background-color: inherit;">　　select newid()</p><p style="background-color: inherit;"><strong style="background-color: inherit;">19、说明：删除重复记录</strong></p><p style="background-color: inherit;">　　1),delete from tablename where id not in (select max(id) from tablename group by col1,col2,...)</p><p style="background-color: inherit;">　　2),select distinct * into temp from tablename</p><p style="background-color: inherit;">　　delete from tablename</p><p style="background-color: inherit;">　　insert into tablename select * from temp</p><p style="background-color: inherit;">　　评价： 这种操作牵连大量的数据的移动，这种做法不适合大容量但数据操作</p><p style="background-color: inherit;">　　3),例如：在一个外部表中导入数据，由于某些原因第一次只导入了一部分，但很难判断具体位置，这样只有在下一次全部导入，这样也就产生好多重复的字段，怎样删除重复字段</p><p style="background-color: inherit;">　　alter table tablename</p><p style="background-color: inherit;">　　--添加一个自增列</p><p style="background-color: inherit;">　　add column_b int identity(1,1)</p><p style="background-color: inherit;">　　delete from tablename where column_b not in(</p><p style="background-color: inherit;">　　select max(column_b) from tablename group by column1,column2,...)</p><p style="background-color: inherit;">　　alter table tablename drop column column_b</p><p style="background-color: inherit;"><strong style="background-color: inherit;">20、说明：列出数据库里所有的表名</strong></p><p style="background-color: inherit;">　　select name from sysobjects where type=&#39;U&#39; // U代表用户</p><p style="background-color: inherit;"><strong style="background-color: inherit;">21、说明：列出表里的所有的列名</strong></p><p style="background-color: inherit;">　　select name from syscolumns where id=object_id(&#39;TableName&#39;)</p><p style="background-color: inherit;"><strong style="background-color: inherit;">22、说明：列示type、vender、pcs字段，以type字段排列，case可以方便地实现多重选择，类似select 中的case。</strong></p><p style="background-color: inherit;">　　select type,sum(case vender when &#39;A&#39; then pcs else 0 end),sum(case vender when &#39;C&#39; then pcs else 0 end),sum(case vender when &#39;B&#39; then pcs else 0 end) FROM tablename group by type</p><p style="background-color: inherit;">显示结果：</p><p style="background-color: inherit;">　　type vender pcs</p><p style="background-color: inherit;">　　电脑 A 1</p><p style="background-color: inherit;">　　电脑 A 1</p><p style="background-color: inherit;">　　光盘 B 2</p><p style="background-color: inherit;">　　光盘 A 2</p><p style="background-color: inherit;">　　手机 B 3</p><p style="background-color: inherit;">　　手机 C 3</p><p style="background-color: inherit;"><strong style="background-color: inherit;">23、说明：初始化表table1</strong></p><p style="background-color: inherit;">　　TRUNCATE TABLE table1</p><p style="background-color: inherit;"><strong style="background-color: inherit;">24、说明：选择从10到15的记录</strong></p><p style="background-color: inherit;">　　select top 5 * from (select top 15 * from table order by id asc) table_别名 order by id desc</p><p style="background-color: inherit;"><strong style="background-color: inherit;">三、技巧</strong></p><p style="background-color: inherit;"><strong style="background-color: inherit;">1、1=1，1=2的使用，在SQL语句组合时用的较多</strong></p><p style="background-color: inherit;">　　“where 1=1” 是表示选择全部 “where 1=2”全部不选，</p><p style="background-color: inherit;">　　如：</p><p style="background-color: inherit;">　　if @strWhere !=&#39;&#39;</p><p style="background-color: inherit;">　　begin</p><p style="background-color: inherit;">　　set @strSQL = &#39;select count(*) as Total from [&#39; + @tblName + &#39;] where &#39; + @strWhere</p><p style="background-color: inherit;">　　end</p><p style="background-color: inherit;">　　else</p><p style="background-color: inherit;">　　begin</p><p style="background-color: inherit;">　　set @strSQL = &#39;select count(*) as Total from [&#39; + @tblName + &#39;]&#39;</p><p style="background-color: inherit;">　　end</p><p style="background-color: inherit;">　　我们可以直接写成</p><p style="background-color: inherit;">　　set @strSQL = &#39;select count(*) as Total from [&#39; + @tblName + &#39;] where 1=1 安定 &#39;+ @strWhere 2、收缩数据库</p><p style="background-color: inherit;">　　--重建索引</p><p style="background-color: inherit;">　　DBCC REINDEX</p><p style="background-color: inherit;">　　DBCC INDEXDEFRAG</p><p style="background-color: inherit;">　　--收缩数据和日志</p><p style="background-color: inherit;">　　DBCC SHRINKDB</p><p style="background-color: inherit;">　　DBCC SHRINKFILE</p><p style="background-color: inherit;"><strong style="background-color: inherit;">3、压缩数据库</strong></p><p style="background-color: inherit;">　　dbcc shrinkdatabase(dbname)</p><p style="background-color: inherit;"><strong style="background-color: inherit;">4、转移数据库给新用户以已存在用户权限</strong></p><p style="background-color: inherit;">　　exec sp_change_users_login &#39;update_one&#39;,&#39;newname&#39;,&#39;oldname&#39;</p><p style="background-color: inherit;">　　go</p><p style="background-color: inherit;"><strong style="background-color: inherit;">5、检查备份集</strong></p><p style="background-color: inherit;">　　RESTORE VERIFYONLY from disk=&#39;E:\dvbbs.bak&#39;</p><p style="background-color: inherit;"><strong style="background-color: inherit;">6、修复数据库</strong></p><p style="background-color: inherit;">　　ALTER DATABASE [dvbbs] SET SINGLE_USER</p><p style="background-color: inherit;">　　GO</p><p style="background-color: inherit;">　　DBCC CHECKDB(&#39;dvbbs&#39;,repair_allow_data_loss) WITH TABLOCK</p><p style="background-color: inherit;">　　GO</p><p style="background-color: inherit;">　　ALTER DATABASE [dvbbs] SET MULTI_USER</p><p style="background-color: inherit;">　　GO</p><p style="background-color: inherit;"><strong style="background-color: inherit;">7、日志清除</strong></p><p style="background-color: inherit;">　　SET NOCOUNT ON</p><p style="background-color: inherit;">　　DECLARE @LogicalFileName sysname,</p><p style="background-color: inherit;">　　@MaxMinutes INT,</p><p style="background-color: inherit;">　　@NewSize INT</p><p style="background-color: inherit;"><br/></p><p style="background-color: inherit;">　　USE tablename -- 要操作的数据库名</p><p style="background-color: inherit;">　　SELECT @LogicalFileName = &#39;tablename_log&#39;, -- 日志文件名</p><p style="background-color: inherit;">　　@MaxMinutes = 10, -- Limit on time allowed to wrap log.</p><p style="background-color: inherit;">　　@NewSize = 1 -- 你想设定的日志文件的大小(M)</p><p style="background-color: inherit;">　　Setup / initialize</p><p style="background-color: inherit;">　　DECLARE @OriginalSize int</p><p style="background-color: inherit;">　　SELECT @OriginalSize = size</p><p style="background-color: inherit;">　　FROM sysfiles</p><p style="background-color: inherit;">　　WHERE name = @LogicalFileName</p><p style="background-color: inherit;">　　SELECT &#39;Original Size of &#39; + db_name() + &#39; LOG is &#39; +</p><p style="background-color: inherit;">　　CONVERT(VARCHAR(30),@OriginalSize) + &#39; 8K pages or &#39; +</p><p style="background-color: inherit;">　　CONVERT(VARCHAR(30),(@OriginalSize*8/1024)) + &#39;MB&#39;</p><p style="background-color: inherit;">　　FROM sysfiles</p><p style="background-color: inherit;">　　WHERE name = @LogicalFileName</p><p style="background-color: inherit;">　　CREATE TABLE DummyTrans</p><p style="background-color: inherit;">　　(DummyColumn char (8000) not null)</p><p style="background-color: inherit;"><br/></p><p style="background-color: inherit;">　　DECLARE @Counter INT,</p><p style="background-color: inherit;">　　@StartTime DATETIME,</p><p style="background-color: inherit;">　　@TruncLog VARCHAR(255)</p><p style="background-color: inherit;">　　SELECT @StartTime = GETDATE(),</p><p style="background-color: inherit;">　　@TruncLog = &#39;BACKUP LOG &#39; + db_name() + &#39; WITH TRUNCATE_ONLY&#39;</p><p style="background-color: inherit;">　　DBCC SHRINKFILE (@LogicalFileName, @NewSize)</p><p style="background-color: inherit;">　　EXEC (@TruncLog)</p><p style="background-color: inherit;">　　-- Wrap the log if necessary.</p><p style="background-color: inherit;">　　WHILE @MaxMinutes &gt; DATEDIFF (mi, @StartTime, GETDATE()) -- time has not expired</p><p style="background-color: inherit;">AND @OriginalSize = (SELECT size FROM sysfiles WHERE name = @LogicalFileName)</p><p style="background-color: inherit;">　　AND (@OriginalSize * 8 /1024) &gt; @NewSize</p><p style="background-color: inherit;">　　BEGIN -- Outer loop.</p><p style="background-color: inherit;">　　SELECT @Counter = 0</p><p style="background-color: inherit;">　　WHILE ((@Counter &lt; @OriginalSize / 16) AND (@Counter &lt; 50000))</p><p style="background-color: inherit;">　　BEGIN -- update</p><p style="background-color: inherit;">　　INSERT DummyTrans VALUES (&#39;Fill Log&#39;) DELETE DummyTrans</p><p style="background-color: inherit;">　　SELECT @Counter = @Counter + 1</p><p style="background-color: inherit;">　　END</p><p style="background-color: inherit;">　　EXEC (@TruncLog)</p><p style="background-color: inherit;">　　END</p><p style="background-color: inherit;">　　SELECT &#39;Final Size of &#39; + db_name() + &#39; LOG is &#39; +</p><p style="background-color: inherit;">　　CONVERT(VARCHAR(30),size) + &#39; 8K pages or &#39; +</p><p style="background-color: inherit;">　　CONVERT(VARCHAR(30),(size*8/1024)) + &#39;MB&#39;</p><p style="background-color: inherit;">　　FROM sysfiles</p><p style="background-color: inherit;">　　WHERE name = @LogicalFileName</p><p style="background-color: inherit;">　　DROP TABLE DummyTrans</p><p style="background-color: inherit;">　　SET NOCOUNT OFF</p><p style="background-color: inherit;"><strong style="background-color: inherit;">8、说明：更改某个表</strong></p><p style="background-color: inherit;">　　exec sp_changeobjectowner &#39;tablename&#39;,&#39;dbo&#39;</p><p style="background-color: inherit;"><strong style="background-color: inherit;">9、存储更改全部表</strong></p><p style="background-color: inherit;">　　CREATE PROCEDURE dbo.User_ChangeObjectOwnerBatch</p><p style="background-color: inherit;">　　@OldOwner as NVARCHAR(128),</p><p style="background-color: inherit;">　　@NewOwner as NVARCHAR(128)</p><p style="background-color: inherit;">　　AS</p><p style="background-color: inherit;">　　DECLARE @Name as NVARCHAR(128)</p><p style="background-color: inherit;">　　DECLARE @Owner as NVARCHAR(128)</p><p style="background-color: inherit;">　　DECLARE @OwnerName as NVARCHAR(128)</p><p style="background-color: inherit;">　　DECLARE curObject CURSOR FOR</p><p style="background-color: inherit;">　　select &#39;Name&#39; = name,</p><p style="background-color: inherit;">　　 &#39;Owner&#39; = user_name(uid)</p><p style="background-color: inherit;">　　from sysobjects</p><p style="background-color: inherit;">　　where user_name(uid)=@OldOwner</p><p style="background-color: inherit;">　　order by name</p><p style="background-color: inherit;">　　OPEN curObject</p><p style="background-color: inherit;">　　FETCH NEXT FROM curObject INTO @Name, @Owner</p><p style="background-color: inherit;">　　WHILE(@@FETCH_STATUS=0)</p><p style="background-color: inherit;">　　BEGIN</p><p style="background-color: inherit;">　　if @Owner=@OldOwner</p><p style="background-color: inherit;">　　begin</p><p style="background-color: inherit;">　　 set @OwnerName = @OldOwner + &#39;.&#39; + rtrim(@Name)</p><p style="background-color: inherit;">　　 exec sp_changeobjectowner @OwnerName, @NewOwner</p><p style="background-color: inherit;">　　end</p><p style="background-color: inherit;">　　-- select @name,@NewOwner,@OldOwner</p><p style="background-color: inherit;">　　FETCH NEXT FROM curObject INTO @Name, @Owner</p><p style="background-color: inherit;">　　END</p><p style="background-color: inherit;">　　close curObject</p><p style="background-color: inherit;">　　deallocate curObject</p><p style="background-color: inherit;">　　GO</p><p style="background-color: inherit;"><strong style="background-color: inherit;">10、SQL SERVER中直接循环写入数据</strong></p><p style="background-color: inherit;">　　declare @i int</p><p style="background-color: inherit;">　　set @i=1</p><p style="background-color: inherit;">　　while @i&lt;30</p><p style="background-color: inherit;">　　begin</p><p style="background-color: inherit;">　　 insert into test (userid) values(@i)</p><p style="background-color: inherit;">　　 set @i=@i+1</p><p style="background-color: inherit;">　　end</p><p style="background-color: inherit;"><strong style="background-color: inherit;">案例：</strong></p><p style="background-color: inherit;">　　有如下表，要求就裱中所有沒有及格的成績，在每次增長0.1的基礎上，使他們剛好及格:</p><p style="background-color: inherit;">　　 Name score</p><p style="background-color: inherit;">　　 Zhangshan 80</p><p style="background-color: inherit;">　　 Lishi 59</p><p style="background-color: inherit;">　　 Wangwu 50</p><p style="background-color: inherit;">　　 Songquan 69</p><p style="background-color: inherit;">　　while((select min(score) from tb_table)&lt;60)</p><p style="background-color: inherit;">　　begin</p><p style="background-color: inherit;">　　update tb_table set score =score*1.01</p><p style="background-color: inherit;">　　where score&lt;60</p><p style="background-color: inherit;">　　if (select min(score) from tb_table)&gt;60</p><p style="background-color: inherit;">　　 break</p><p style="background-color: inherit;">　　else</p><p style="background-color: inherit;">　　 continue</p><p style="background-color: inherit;">　　end</p><p style="background-color: inherit;"><strong style="background-color: inherit;">数据开发-经典</strong></p><p style="background-color: inherit;"><strong style="background-color: inherit;">1.按姓氏笔画排序:</strong></p><p style="background-color: inherit;">　　Select * From TableName Order By CustomerName Collate Chinese_PRC_Stroke_ci_as //从少到多</p><p style="background-color: inherit;"><strong style="background-color: inherit;">2.数据库加密:</strong></p><p style="background-color: inherit;">　　select encrypt(&#39;原始密码&#39;)</p><p style="background-color: inherit;">　　select pwdencrypt(&#39;原始密码&#39;)</p><p style="background-color: inherit;">　　select pwdcompare(&#39;原始密码&#39;,&#39;加密后密码&#39;) = 1--相同；否则不相同 encrypt(&#39;原始密码&#39;)</p><p style="background-color: inherit;">select pwdencrypt(&#39;原始密码&#39;)</p><p style="background-color: inherit;">　　select pwdcompare(&#39;原始密码&#39;,&#39;加密后密码&#39;) = 1--相同；否则不相同</p><p style="background-color: inherit;"><strong style="background-color: inherit;">3.取回表中字段:</strong></p><p style="background-color: inherit;">　　declare @list varchar(1000),</p><p style="background-color: inherit;">　　@sql nvarchar(1000)</p><p style="background-color: inherit;">　　select @list=@list+&#39;,&#39;+b.name from sysobjects a,syscolumns b where a.id=b.id and a.name=&#39;表A&#39;</p><p style="background-color: inherit;">　　set @sql=&#39;select &#39;+right(@list,len(@list)-1)+&#39; from 表A&#39;</p><p style="background-color: inherit;">　　exec (@sql)</p><p style="background-color: inherit;"><strong style="background-color: inherit;">4.查看硬盘分区:</strong></p><p style="background-color: inherit;">　　EXEC master..xp_fixeddrives</p><p style="background-color: inherit;"><strong style="background-color: inherit;">5.比较A,B表是否相等:</strong></p><p style="background-color: inherit;">　　if (select checksum_agg(binary_checksum(*)) from A)</p><p style="background-color: inherit;">　　 =</p><p style="background-color: inherit;">　　 (select checksum_agg(binary_checksum(*)) from B)</p><p style="background-color: inherit;">　　print &#39;相等&#39;</p><p style="background-color: inherit;">　　else</p><p style="background-color: inherit;">　　print &#39;不相等&#39;</p><p style="background-color: inherit;"><strong style="background-color: inherit;">6.杀掉所有的事件探察器进程:</strong></p><p style="background-color: inherit;">　　DECLARE hcforeach CURSOR GLOBAL FOR SELECT &#39;kill &#39;+RTRIM(spid) FROM master.dbo.sysprocesses</p><p style="background-color: inherit;">　　WHERE program_name IN(&#39;SQL profiler&#39;,N&#39;SQL 事件探查器&#39;)</p><p style="background-color: inherit;">　　EXEC sp_msforeach_worker &#39;?&#39;</p><p style="background-color: inherit;"><strong style="background-color: inherit;">7.记录搜索:</strong></p><p style="background-color: inherit;">　　开头到N条记录</p><p style="background-color: inherit;">　　Select Top N * From 表</p><p style="background-color: inherit;">　　-------------------------------</p><p style="background-color: inherit;">　　N到M条记录(要有主索引ID)</p><p style="background-color: inherit;">　　Select Top M-N * From 表 Where ID in (Select Top M ID From 表) Order by ID Desc</p><p style="background-color: inherit;">　　----------------------------------</p><p style="background-color: inherit;">　　N到结尾记录</p><p style="background-color: inherit;">　　Select Top N * From 表 Order by ID Desc</p><p style="background-color: inherit;"><strong style="background-color: inherit;">案例</strong></p><p style="background-color: inherit;">　　例如1：一张表有一万多条记录，表的第一个字段 RecID 是自增长字段， 写一个SQL语句， 找出表的第31到第40个记录。</p><p style="background-color: inherit;">　　select top 10 recid from A where recid not in(select top 30 recid from A)</p><p style="background-color: inherit;">　　分析：如果这样写会产生某些问题，如果recid在表中存在逻辑索引。</p><p style="background-color: inherit;">　　 select top 10 recid from A where……是从索引中查找，而后面的select top 30 recid from A则在数据表中查找，这样由于索引中的顺序有可能和数据表中的不一致，这样就导致查询到的不是本来的欲得到的数据。</p><p style="background-color: inherit;"><strong style="background-color: inherit;">解决方案</strong></p><p style="background-color: inherit;">　　1， 用order by select top 30 recid from A order by ricid 如果该字段不是自增长，就会出现问题</p><p style="background-color: inherit;">　　2， 在那个子查询中也加条件：select top 30 recid from A where recid&gt;-1</p><p style="background-color: inherit;">　　例2：查询表中的最后以条记录，并不知道这个表共有多少数据,以及表结构。</p><p style="background-color: inherit;">　　set @s = &#39;select top 1 * from T where pid not in (select top &#39; + str(@count-1) + &#39; pid from T)&#39;</p><p style="background-color: inherit;">　　print @s exec sp_executesql @s</p><p style="background-color: inherit;"><strong style="background-color: inherit;">8：获取当前数据库中的所有用户表</strong></p><p style="background-color: inherit;">　　select Name from sysobjects where xtype=&#39;u&#39; and status&gt;=0</p><p style="background-color: inherit;"><strong style="background-color: inherit;">9：获取某一个表的所有字段</strong></p><p style="background-color: inherit;">　　select name from syscolumns where id=object_id(&#39;表名&#39;)</p><p style="background-color: inherit;">　　select name from syscolumns where id in (select id from sysobjects where type = &#39;u&#39; and name = &#39;表名&#39;)</p><p style="background-color: inherit;">　　两种方式的效果相同</p><p style="background-color: inherit;"><strong style="background-color: inherit;">10：查看与某一个表相关的视图、存储过程、函数</strong></p><p style="background-color: inherit;">　　select a.* from sysobjects a, syscomments b where a.id = b.id and b.text like &#39;%表名%&#39;</p><p style="background-color: inherit;"><strong style="background-color: inherit;">11：查看当前数据库中所有存储过程</strong></p><p style="background-color: inherit;">　　select name as 存储过程名称 from sysobjects where xtype=&#39;P&#39;</p><p style="background-color: inherit;"><strong style="background-color: inherit;">12：查询用户创建的所有数据库</strong></p><p style="background-color: inherit;">　　select * from master..sysdatabases D where sid not in(select sid from master..syslogins where name=&#39;sa&#39;)</p><p style="background-color: inherit;">　　或者</p><p style="background-color: inherit;">　　select dbid, name AS DB_NAME from master..sysdatabases where sid &lt;&gt; 0x01</p><p style="background-color: inherit;"><strong style="background-color: inherit;">13：查询某一个表的字段和数据类型</strong></p><p style="background-color: inherit;">　　select column_name,data_type from information_schema.columns</p><p style="background-color: inherit;">　　where table_name = &#39;表名&#39;</p><p style="background-color: inherit;"><strong style="background-color: inherit;">14：不同服务器数据库之间的数据操作</strong></p><p style="background-color: inherit;">　　--创建链接服务器</p><p style="background-color: inherit;">　　exec sp_addlinkedserver &#39;ITSV &#39;, &#39; &#39;, &#39;SQLOLEDB &#39;, &#39;远程服务器名或ip地址 &#39;</p><p style="background-color: inherit;">　　exec sp_addlinkedsrvlogin &#39;ITSV &#39;, &#39;false &#39;,null, &#39;用户名 &#39;, &#39;密码 &#39;</p><p style="background-color: inherit;">　　--查询示例</p><p style="background-color: inherit;">　　select * from ITSV.数据库名.dbo.表名</p><p style="background-color: inherit;">　　--导入示例</p><p style="background-color: inherit;">　　select * into 表 from ITSV.数据库名.dbo.表名</p><p style="background-color: inherit;">　　--以后不再使用时删除链接服务器</p><p style="background-color: inherit;">　　exec sp_dropserver &#39;ITSV &#39;, &#39;droplogins &#39;</p><p style="background-color: inherit;">　　--连接远程/局域网数据(openrowset/openquery/opendatasource)</p><p style="background-color: inherit;">　　--1、openrowset</p><p style="background-color: inherit;">　　--查询示例</p><p style="background-color: inherit;">　　select * from openrowset( &#39;SQLOLEDB &#39;, &#39;sql服务器名 &#39;; &#39;用户名 &#39;; &#39;密码 &#39;,数据库名.dbo.表名)</p><p style="background-color: inherit;">　　--生成本地表</p><p style="background-color: inherit;">　　select * into 表 from openrowset( &#39;SQLOLEDB &#39;, &#39;sql服务器名 &#39;; &#39;用户名 &#39;; &#39;密码 &#39;,数据库名.dbo.表名)</p><p style="background-color: inherit;">　　--把本地表导入远程表</p><p style="background-color: inherit;">　　insert openrowset( &#39;SQLOLEDB &#39;, &#39;sql服务器名 &#39;; &#39;用户名 &#39;; &#39;密码 &#39;,数据库名.dbo.表名)</p><p style="background-color: inherit;">　　select *from 本地表</p><p style="background-color: inherit;">　　--更新本地表</p><p style="background-color: inherit;">　　update b</p><p style="background-color: inherit;">　　set b.列A=a.列A</p><p style="background-color: inherit;">　　from openrowset( &#39;SQLOLEDB &#39;, &#39;sql服务器名 &#39;; &#39;用户名 &#39;; &#39;密码 &#39;,数据库名.dbo.表名)as a inner join 本地表 b</p><p style="background-color: inherit;">　　on a.column1=b.column1</p><p style="background-color: inherit;">　　--openquery用法需要创建一个连接</p><p style="background-color: inherit;">　　--首先创建一个连接创建链接服务器</p><p style="background-color: inherit;">　　exec sp_addlinkedserver &#39;ITSV &#39;, &#39; &#39;, &#39;SQLOLEDB &#39;, &#39;远程服务器名或ip地址 &#39;</p><p style="background-color: inherit;">　　--查询</p><p style="background-color: inherit;">　　select *</p><p style="background-color: inherit;">　　FROM openquery(ITSV, &#39;SELECT * FROM 数据库.dbo.表名 &#39;)</p><p style="background-color: inherit;">　　--把本地表导入远程表</p><p style="background-color: inherit;">　　insert openquery(ITSV, &#39;SELECT * FROM 数据库.dbo.表名 &#39;)</p><p style="background-color: inherit;">　　select * from 本地表</p><p style="background-color: inherit;">　　--更新本地表</p><p style="background-color: inherit;">　　update b</p><p style="background-color: inherit;">　　set b.列B=a.列B</p><p style="background-color: inherit;">　　FROM openquery(ITSV, &#39;SELECT * FROM 数据库.dbo.表名 &#39;) as a</p><p style="background-color: inherit;">　　inner join 本地表 b on a.列A=b.列A</p><p style="background-color: inherit;">　　--3、opendatasource/openrowset</p><p style="background-color: inherit;">　　SELECT *</p><p style="background-color: inherit;">　　FROM opendatasource( &#39;SQLOLEDB &#39;, &#39;Data Source=ip/ServerName;User ID=登陆名;Password=密码 &#39; ).test.dbo.roy_ta</p><p style="background-color: inherit;">　　--把本地表导入远程表</p><p style="background-color: inherit;">　　insert opendatasource( &#39;SQLOLEDB &#39;, &#39;Data Source=ip/ServerName;User ID=登陆名;Password=密码 &#39;).数据库.dbo.表名</p><p style="background-color: inherit;">　　select * from 本地表</p><p style="background-color: inherit;">　　SQL Server基本函数</p><p style="background-color: inherit;">　　SQL Server基本函数</p><p style="background-color: inherit;">　　1.字符串函数 长度与分析用</p><p style="background-color: inherit;">　　1,datalength(Char_expr) 返回字符串包含字符数,但不包含后面的空格</p><p style="background-color: inherit;">　　2,substring(expression,start,length) 取子串，字符串的下标是从“1”，start为起始位置，length为字符串长度，实际应用中以len(expression)取得其长度</p><p style="background-color: inherit;">　　3,right(char_expr,int_expr) 返回字符串右边第int_expr个字符，还用left于之相反</p><p style="background-color: inherit;">4,isnull( check_expression , replacement_value )如果check_expression為空，則返回replacement_value的值，不為空，就返回check_expression字符操作类</p><p style="background-color: inherit;">　　5,Sp_addtype 自定義數據類型</p><p style="background-color: inherit;">　　例如：EXEC sp_addtype birthday, datetime, &#39;NULL&#39;</p><p style="background-color: inherit;">　　6,set nocount {on|off}使返回的结果中不包含有关受 Transact-SQL 语句影响的行数的信息。如果存储过程中包含的一些语句并不返回许多实际的数据，则该设置由于大量减少了网络流量，因此可显著提高性能。SET NOCOUNT 设置是在执行或运行时设置，而不是在分析时设置。SET NOCOUNT 为 ON 时，不返回计数（表示受 Transact-SQL 语句影响的行数）。</p><p style="background-color: inherit;">　　SET NOCOUNT 为 OFF 时，返回计数</p><p style="background-color: inherit;"><strong style="background-color: inherit;">一、基础</strong></p><p style="background-color: inherit;"><strong style="background-color: inherit;">1、说明：创建数据库</strong></p><p style="background-color: inherit;">　　CREATE DATABASE database-name</p><p style="background-color: inherit;"><strong style="background-color: inherit;">2、说明：删除数据库</strong></p><p style="background-color: inherit;">　　drop database dbname</p><p style="background-color: inherit;"><strong style="background-color: inherit;">3、说明：备份sql server</strong></p><p style="background-color: inherit;">　　--- 创建 备份数据的 device</p><p style="background-color: inherit;">　　USE master</p><p style="background-color: inherit;">　　EXEC sp_addumpdevice &#39;disk&#39;, &#39;testBack&#39;, &#39;c:\mssql7backup\MyNwind_1.dat&#39;</p><p style="background-color: inherit;">　　--- 开始 备份</p><p style="background-color: inherit;">　　BACKUP DATABASE pubs TO testBack</p><p style="background-color: inherit;"><strong style="background-color: inherit;">4、说明：创建新表</strong></p><p style="background-color: inherit;">　　create table tabname(col1 type1 [not null] [primary key],col2 type2 [not null],..)</p><p style="background-color: inherit;">　　根据已有的表创建新表：</p><p style="background-color: inherit;">　　A：create table tab_new like tab_old (使用旧表创建新表)</p><p style="background-color: inherit;">　　B：create table tab_new as select col1,col2… from tab_old definition only</p><p style="background-color: inherit;"><strong style="background-color: inherit;">5、说明：删除新表</strong></p><p style="background-color: inherit;">　　drop table tabname</p><p style="background-color: inherit;"><strong style="background-color: inherit;">6、说明：增加一个列</strong></p><p style="background-color: inherit;">　　Alter table tabname add column col type</p><p style="background-color: inherit;">　　注：列增加后将不能删除。DB2中列加上后数据类型也不能改变，唯一能改变的是增加varchar类型的长度。</p><p style="background-color: inherit;"><strong style="background-color: inherit;">7、说明：添加主键：</strong>&nbsp;Alter table tabname add primary key(col)</p><p style="background-color: inherit;">　　说明：删除主键： Alter table tabname drop primary key(col)</p><p style="background-color: inherit;"><strong style="background-color: inherit;">8、说明：创建索引：</strong>create [unique] index idxname on tabname(col….)</p><p style="background-color: inherit;">　　删除索引：drop index idxname</p><p style="background-color: inherit;">　　注：索引是不可更改的，想更改必须删除重新建。</p><p style="background-color: inherit;"><strong style="background-color: inherit;">9、说明：创建视图：</strong>create view viewname as select statement</p><p style="background-color: inherit;">　　删除视图：drop view viewname</p><p style="background-color: inherit;"><strong style="background-color: inherit;">10、说明：几个简单的基本的sql语句</strong></p><p style="background-color: inherit;">　　选择：select * from table1 where 范围</p><p style="background-color: inherit;">　　插入：insert into table1(field1,field2) values(value1,value2)</p><p style="background-color: inherit;">　　删除：delete from table1 where 范围</p><p style="background-color: inherit;">　　更新：update table1 set field1=value1 where 范围</p><p style="background-color: inherit;">　　查找：select * from table1 where field1 like ’%value1%’ ---like的语法很精妙，查资料!</p><p style="background-color: inherit;">　　排序：select * from table1 order by field1,field2 [desc]</p><p style="background-color: inherit;">　　总数：select count as totalcount from table1</p><p style="background-color: inherit;">　　求和：select sum(field1) as sumvalue from table1</p><p style="background-color: inherit;">　　平均：select avg(field1) as avgvalue from table1</p><p style="background-color: inherit;">　　最大：select max(field1) as maxvalue from table1</p><p style="background-color: inherit;">　　最小：select min(field1) as minvalue from table1</p><p style="background-color: inherit;"><strong style="background-color: inherit;">11、说明：几个高级查询运算词</strong></p><p style="background-color: inherit;">　　A： UNION 运算符</p><p style="background-color: inherit;">　　UNION 运算符通过组合其他两个结果表（例如 TABLE1 和 TABLE2）并消去表中任何重复行而派生出一个结果表。当 ALL 随 UNION 一起使用时（即 UNION ALL），不消除重复行。两种情况下，派生表的每一行不是来自 TABLE1 就是来自 TABLE2。</p><p style="background-color: inherit;">B： EXCEPT 运算符</p><p style="background-color: inherit;">　　EXCEPT 运算符通过包括所有在 TABLE1 中但不在 TABLE2 中的行并消除所有重复行而派生出一个结果表。当 ALL 随 EXCEPT 一起使用时 (EXCEPT ALL)，不消除重复行。</p><p style="background-color: inherit;">　　C： INTERSECT 运算符</p><p style="background-color: inherit;">　　INTERSECT 运算符通过只包括 TABLE1 和 TABLE2 中都有的行并消除所有重复行而派生出一个结果表。当 ALL 随 INTERSECT 一起使用时 (INTERSECT ALL)，不消除重复行。</p><p style="background-color: inherit;">　　注：使用运算词的几个查询结果行必须是一致的。</p><p style="background-color: inherit;"><strong style="background-color: inherit;">12、说明：使用外连接</strong></p><p style="background-color: inherit;">　　A、left （outer） join：</p><p style="background-color: inherit;">　　左外连接（左连接）：结果集几包括连接表的匹配行，也包括左连接表的所有行。</p><p style="background-color: inherit;">　　SQL: select a.a, a.b, a.c, b.c, b.d, b.f from a LEFT OUT JOIN b ON a.a = b.c</p><p style="background-color: inherit;">　　B：right （outer） join:</p><p style="background-color: inherit;">　　右外连接(右连接)：结果集既包括连接表的匹配连接行，也包括右连接表的所有行。</p><p style="background-color: inherit;">　　C：full/cross （outer） join：</p><p style="background-color: inherit;">　　全外连接：不仅包括符号连接表的匹配行，还包括两个连接表中的所有记录。</p><p style="background-color: inherit;"><strong style="background-color: inherit;">13、分组:Group by:</strong></p><p style="background-color: inherit;">　　 一张表，一旦分组 完成后，查询后只能得到组相关的信息。</p><p style="background-color: inherit;">　　 组相关的信息：（统计信息） count,sum,max,min,avg 分组的标准)</p><p style="background-color: inherit;">　　 在SQLServer中分组时：不能以text,ntext,image类型的字段作为分组依据</p><p style="background-color: inherit;">　　 在selecte统计函数中的字段，不能和普通的字段放在一起；</p><p style="background-color: inherit;"><strong style="background-color: inherit;">14、对数据库进行操作：</strong></p><p style="background-color: inherit;">　　 分离数据库： sp_detach_db; 附加数据库：sp_attach_db 后接表明，附加需要完整的路径名</p><p style="background-color: inherit;"><strong style="background-color: inherit;">15.如何修改数据库的名称:</strong></p><p style="background-color: inherit;">　　sp_renamedb &#39;old_name&#39;, &#39;new_name&#39;</p><p style="background-color: inherit;"><strong style="background-color: inherit;">二、提升</strong></p><p style="background-color: inherit;"><strong style="background-color: inherit;">1、说明：复制表(只复制结构,源表名：a 新表名：b) (Access可用)</strong></p><p style="background-color: inherit;">　　法一：select * into b from a where 1&lt;&gt;1（仅用于SQlServer）</p><p style="background-color: inherit;">　　法二：select top 0 * into b from a</p><p style="background-color: inherit;"><strong style="background-color: inherit;">2、说明：拷贝表(拷贝数据,源表名：a 目标表名：b) (Access可用)</strong></p><p style="background-color: inherit;">　　insert into b(a, b, c) select d,e,f from b;</p><p style="background-color: inherit;"><strong style="background-color: inherit;">3、说明：跨数据库之间表的拷贝(具体数据使用绝对路径) (Access可用)</strong></p><p style="background-color: inherit;">　　insert into b(a, b, c) select d,e,f from b in ‘具体数据库’ where 条件</p><p style="background-color: inherit;">　　例子：..from b in &#39;&quot;&amp;Server.MapPath(&quot;.&quot;)&amp;&quot;\data.mdb&quot; &amp;&quot;&#39; where..</p><p style="background-color: inherit;"><strong style="background-color: inherit;">4、说明：子查询(表名1：a 表名2：b)</strong></p><p style="background-color: inherit;">　　select a,b,c from a where a IN (select d from b ) 或者: select a,b,c from a where a IN (1,2,3)</p><p style="background-color: inherit;"><strong style="background-color: inherit;">5、说明：显示文章、提交人和最后回复时间</strong></p><p style="background-color: inherit;">　　select a.title,a.username,b.adddate from table a,(select max(adddate) adddate from table where table.title=a.title) b</p><p style="background-color: inherit;"><strong style="background-color: inherit;">6、说明：外连接查询(表名1：a 表名2：b)</strong></p><p style="background-color: inherit;">　　select a.a,
                        </code>
                        </pre>
                        <div class="bdsharebuttonbox"><a href="#" class="bds_more" data-cmd="more"></a><a href="#" class="bds_qzone" data-cmd="qzone"></a><a href="#" class="bds_tsina" data-cmd="tsina"></a><a href="#" class="bds_tqq" data-cmd="tqq"></a><a href="#" class="bds_renren" data-cmd="renren"></a><a href="#" class="bds_weixin" data-cmd="weixin"></a></div>
                        <!-- UY BEGIN -->
                        <div id="uyan_frame"></div>
                        <script type="text/javascript" src="http://v2.uyan.cc/code/uyan.js?uid=2113268"></script>
                        <!-- UY END -->
                    </div>
                </div>
                <div id="footerInnerSeparator"></div>
            </div>
        </div>
        <div id="footerOuterSeparator"></div>
    </div>
    <br /><br /><br />
    <script src="../../js/jquery-1.9.1.js"></script>
    <script>
        window._bd_share_config = { "common": { "bdSnsKey": {}, "bdText": $("#divMain pre code").text(), "bdMini": "2", "bdPic": "", "bdStyle": "0", "bdSize": "16" }, "share": {}, "image": { "viewList": ["qzone", "tsina", "tqq", "renren", "weixin"], "viewText": "分享到：", "viewSize": "16" }, "selectShare": { "bdContainerClass": null, "bdSelectMiniList": ["qzone", "tsina", "tqq", "renren", "weixin"] } }; with (document) 0[(getElementsByTagName('head')[0] || body).appendChild(createElement('script')).src = 'http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion=' + ~(-new Date() / 36e5)];
    </script>
</body>
</html>