<!DOCTYPE HTML>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="Language" content="zh-CN">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="shortcut icon" href="../../images/kebue.ico">
    <link rel="icon" href="../../images/kebue.ico">
    <meta name="description" content=数据库的高级应用>
    <meta name="keywords" content=数据库的高级应用数据库的高级应用数据库五大高级应用：视图（view）索引（index）存储过程（proc）触发器（trigger）事务（trans）●●●●●●●●●●●●下面将对这五大应用详细解●●●●●●●●●●●●一视图（view）：只是用来快速展示查询数据：主要内容：l视图的概念以及优缺点视图是一张虚拟表，他所展现的内容并没有存储在视图表中而是存储在他所引用的表中。优点;简化操作；根据不同>
    <title>数据库的高级应用</title>

    <link href="../../template/scripts/bootstrap/css/bootstrap.min.css" rel="stylesheet" />
    <link href="../../template/styles/custom.css" rel="stylesheet" />
</head>
<body id="pageBody">
    <div id="divBoxed" class="container">
        <div class="transparent-bg" style="position: absolute;top: 0;left: 0;width: 100%;height: 100%;z-index: -1;zoom: 1;"></div>
        <div class="divPanel notop nobottom">
            <div class="row-fluid">
                <div class="span12">
                    <div id="divLogo">
                        <a href="../../../Home/Index" id="divSiteTitle">科布尔 kebue</a><br />
                        <a href="../../../Home/Index" id="divTagLine">开发者用代码改变世界从科布尔开始</a>
                    </div>
                </div>
            </div>
            <div class="row-fluid">
                <div class="span12">
                    <div id="divMenuRight" class="pull-right">
                        <div class="navbar">
                            <button type="button" class="btn btn-navbar-highlight btn-large btn-primary" data-toggle="collapse" data-target=".nav-collapse">
                                NAVIGATION <span class="icon-chevron-down icon-white"></span>
                            </button>
                            <div class="nav-collapse collapse">
                                <ul class="nav nav-pills ddmenu">
                                    <li class="dropdown glyphicon glyphicon-arrow-left"><a href='javascript:window.history.back()'>后退</a></li>
                                    <li class="dropdown active"><a href="http://www.kebue.com/">Home</a></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row-fluid">
                <div class="span12">
                    <div id="contentInnerSeparator"></div>
                </div>
            </div>
        </div>
        <div class="contentArea">
            <div class="divPanel notop page-content">
                <div class="breadcrumbs">
                    <a href="../../../Home/Index">Home</a> &nbsp;/&nbsp; <span><a href='../../../../../Artlcle/ArticleType/A6B67D7C-1B75-4AF4-AF00-7D4EF126AFA9.html' title='SQLServer'>SQLServer</a></span>
                </div>
                <div class="row-fluid">
                    <div class="span12" id="divMain">
                        <h1>数据库的高级应用</h1>
                        <pre>
                        <code>
                            <h1 style="white-space: normal; widows: auto; color: rgb(51, 51, 51); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 28px; font-weight: 400; line-height: 1.8; background-color: rgb(255, 255, 255);"><a href="http://www.cnblogs.com/woniu-net/p/4679765.html" style="background-color: inherit; cursor: pointer; color: rgb(51, 51, 51);">数据库的高级应用</a></h1><p style="background-color: inherit;">数据库的高级应用</p><p style="background-color: inherit;">数据库五大高级应用：</p><p style="background-color: inherit;">视图（<span style="background-color: inherit; font-family: &#39;Times New Roman&#39;;">view</span><span style="background-color: inherit; font-family: 宋体;">）索引（</span><span style="background-color: inherit; font-family: &#39;Times New Roman&#39;;">index</span><span style="background-color: inherit; font-family: 宋体;">）存储过程（</span><span style="background-color: inherit; font-family: &#39;Times New Roman&#39;;">proc</span><span style="background-color: inherit; font-family: 宋体;">）触发器（</span><span style="background-color: inherit; font-family: &#39;Times New Roman&#39;;">trigger</span><span style="background-color: inherit; font-family: 宋体;">）事务（</span><span style="background-color: inherit; font-family: &#39;Times New Roman&#39;;">trans</span><span style="background-color: inherit; font-family: 宋体;">）</span></p><p style="background-color: inherit;">●●●●●●●●●●●●下面将对这五大应用详细解●●●●●●●●●●●●</p><p style="background-color: inherit;">一&nbsp;视图（<span style="background-color: inherit; font-family: &#39;Times New Roman&#39;;">view</span><span style="background-color: inherit; font-family: 宋体;">）：只是用来快速展示查询数据：</span></p><p style="background-color: inherit;">主要内容：</p><p style="background-color: inherit;">l&nbsp;视图的概念以及优缺点</p><p style="background-color: inherit;">&nbsp;&nbsp;&nbsp;视图是一张虚拟表，他所展现的内容并没有存储在视图表中而是存储在他所引用的表中。</p><p style="background-color: inherit;">&nbsp;&nbsp;优点<span style="background-color: inherit; font-family: &#39;Times New Roman&#39;;">;&nbsp;</span><span style="background-color: inherit; font-family: 宋体;">简化操作；根据不同用户定制不同数据；合并分割数据?话踩裕?/span></p><p style="background-color: inherit;">&nbsp;&nbsp;缺点：性能不高；数据修改受限；</p><p style="background-color: inherit;">l&nbsp;单表视图&nbsp;多表视图&nbsp;基于视图的视图</p><p style="background-color: inherit;">创建视图&nbsp;语法结构：</p><p style="background-color: inherit;">Create&nbsp;view&nbsp;<span style="background-color: inherit; font-family: 宋体;">视图名</span><span style="background-color: inherit; font-family: &#39;Times New Roman&#39;;">[(column&nbsp;,```````)]--column&nbsp;</span><span style="background-color: inherit; font-family: 宋体;">列名</span></p><p style="background-color: inherit;">[with&nbsp;encryption&nbsp;]</p><p style="background-color: inherit;">As</p><p style="background-color: inherit;">[With&nbsp;&nbsp;check&nbsp;&nbsp;option]--<span style="background-color: inherit; font-family: 宋体;">这条语句作用：</span><span style="background-color: inherit; font-family: &#39;Times New Roman&#39;;">1&nbsp;</span><span style="background-color: inherit; font-family: 宋体;">规定在视图上做过的修改必须符合引用表的要求；</span><span style="background-color: inherit; font-family: &#39;Times New Roman&#39;;">2</span><span style="background-color: inherit;">&nbsp;</span>通过视图修改的数据可以确保修改后的数据仍然可以通过视图看到。</p><p style="background-color: inherit;">注意点：视图中的查询语句中不能包含&nbsp;<span style="background-color: inherit; font-family: &#39;Times New Roman&#39;;">order&nbsp;by/&nbsp;compute&nbsp;/compute&nbsp;by&nbsp;</span><span style="background-color: inherit; font-family: 宋体;">或者是</span><span style="background-color: inherit; font-family: &#39;Times New Roman&#39;;">into</span><span style="background-color: inherit; font-family: 宋体;">关键字</span></p><p style="background-color: inherit;">例子：1<span style="background-color: inherit; font-family: 宋体;">单表视图</span></p><p style="background-color: inherit;">创建视图&nbsp;&nbsp;create&nbsp;view&nbsp;jiage&nbsp;</p><p style="background-color: inherit;">&nbsp;&nbsp;As&nbsp;&nbsp;&nbsp;&nbsp;select&nbsp;*from&nbsp;Car&nbsp;where&nbsp;Price&nbsp;between&nbsp;30&nbsp;and&nbsp;50</p><p style="background-color: inherit;">&nbsp;&nbsp;go</p><p style="background-color: inherit;">&nbsp;引用&nbsp;：select&nbsp;*from&nbsp;jiage</p><p style="background-color: inherit;">2<span style="background-color: inherit; font-family: 宋体;">带有</span><span style="background-color: inherit; font-family: &#39;Times New Roman&#39;;">where&nbsp;</span><span style="background-color: inherit; font-family: 宋体;">字段的视图</span></p><p style="background-color: inherit;">Create&nbsp;view&nbsp;view2</p><p style="background-color: inherit;">As&nbsp;</p><p style="background-color: inherit;">Select&nbsp;<span style="background-color: inherit; font-family: 宋体;">姓名，工资&nbsp;</span><span style="background-color: inherit; font-family: &#39;Times New Roman&#39;;">from&nbsp;</span><span style="background-color: inherit; font-family: 宋体;">职工&nbsp;</span><span style="background-color: inherit; font-family: &#39;Times New Roman&#39;;">where&nbsp;</span><span style="background-color: inherit; font-family: 宋体;">工资</span><span style="background-color: inherit; font-family: &#39;Times New Roman&#39;;">&gt;1800</span></p><p style="background-color: inherit;">Go</p><p style="background-color: inherit;">3<span style="background-color: inherit; font-family: 宋体;">带有计算字段的视图</span></p><p style="background-color: inherit;">&nbsp;&nbsp;</p><p style="background-color: inherit;">Go&nbsp;</p><p style="background-color: inherit;">2&nbsp;<span style="background-color: inherit; font-family: 宋体;">多表视图</span></p><p style="background-color: inherit;">&nbsp;</p><p style="background-color: inherit;">3&nbsp;<span style="background-color: inherit; font-family: 宋体;">带有聚合函数的视图</span></p><p style="background-color: inherit;">&nbsp;</p><p style="background-color: inherit;">4<span style="background-color: inherit; font-family: 宋体;">更改原表中的字段名称</span></p><p style="background-color: inherit;">create&nbsp;view&nbsp;view1&nbsp;(车名,车的价格)&nbsp;--<span style="background-color: inherit; font-family: 宋体;">将新设置的列名在此设置。</span></p><p style="background-color: inherit;">as</p><p style="background-color: inherit;">select&nbsp;name,price&nbsp;from&nbsp;Car&nbsp;where&nbsp;Name&nbsp;like&#39;%<span style="background-color: inherit; font-family: 宋体;">宝马</span><span style="background-color: inherit; font-family: &#39;Times New Roman&#39;;">%&#39;</span></p><p style="background-color: inherit;">go</p><p style="background-color: inherit;">select&nbsp;*from&nbsp;view1</p><p style="background-color: inherit;">&nbsp;</p><p style="background-color: inherit;">l&nbsp;&nbsp;利用<span style="background-color: inherit; font-family: &#39;Times New Roman&#39;;">sql&nbsp;</span><span style="background-color: inherit; font-family: 宋体;">代码修改视图</span></p><p style="background-color: inherit;">alter&nbsp;view&nbsp;view1&nbsp;(啥车,多钱)&nbsp;--<span style="background-color: inherit; font-family: 宋体;">可以同时更改原有视图中的列名</span></p><p style="background-color: inherit;">as</p><p style="background-color: inherit;">select&nbsp;name,price&nbsp;from&nbsp;Car&nbsp;where&nbsp;Name&nbsp;like&nbsp;&#39;%<span style="background-color: inherit; font-family: 宋体;">奥迪</span><span style="background-color: inherit; font-family: &#39;Times New Roman&#39;;">%&#39;</span></p><p style="background-color: inherit;">go</p><p style="background-color: inherit;">select&nbsp;*from&nbsp;view1</p><p style="background-color: inherit;">l&nbsp;利用<span style="background-color: inherit; font-family: &#39;Times New Roman&#39;;">sql&nbsp;</span><span style="background-color: inherit; font-family: 宋体;">删除&nbsp;视图</span></p><p style="background-color: inherit;">&nbsp;&nbsp;《删除单张视图》&nbsp;<span style="background-color: inherit; font-family: &#39;Times New Roman&#39;;">drop&nbsp;view&nbsp;</span><span style="background-color: inherit; font-family: 宋体;">视图名&nbsp;&nbsp;《删除多张视图》&nbsp;</span><span style="background-color: inherit; font-family: &#39;Times New Roman&#39;;">drop&nbsp;view&nbsp;view1</span><span style="background-color: inherit; font-family: 宋体;">，</span><span style="background-color: inherit; font-family: &#39;Times New Roman&#39;;">view2~~~~</span></p><p style="background-color: inherit;">&nbsp;《带有判断条件删除视图》</p><p style="background-color: inherit;">l&nbsp;视图数据的查询</p><p style="background-color: inherit;">l&nbsp;通过视图添加更新以及删除数据</p><p style="background-color: inherit;">&nbsp;</p><p style="background-color: inherit;">二&nbsp;索引（<span style="background-color: inherit; font-family: &#39;Times New Roman&#39;;">index</span><span style="background-color: inherit; font-family: 宋体;">）</span></p><p style="background-color: inherit;">创建索引：<span style="background-color: inherit; font-family: &#39;Times New Roman&#39;;">create&nbsp;[unique][clustered][nonclustered]&nbsp;index&nbsp;index-name1&nbsp;&nbsp;on&nbsp;[table|view](</span><span style="background-color: inherit; font-family: 宋体;">列名&nbsp;</span><span style="background-color: inherit; font-family: &#39;Times New Roman&#39;;">asc|desc)</span></p><p style="background-color: inherit;">Unique&nbsp;<span style="background-color: inherit; font-family: 宋体;">创建唯一索引，即索引的键值不能重复，在列包含重复值是不能创建唯一索引；</span></p><p style="background-color: inherit;">Clustered&nbsp;<span style="background-color: inherit; font-family: 宋体;">指明创建的索引为簇索引，如果此选项默认，则创建的为非簇索引。</span></p><p style="background-color: inherit;">Nonclustered&nbsp;<span style="background-color: inherit; font-family: 宋体;">指明创建的索引为非簇索引</span></p><p style="background-color: inherit;">例子：&nbsp;<span style="background-color: inherit; font-family: &#39;Times New Roman&#39;;">1</span><span style="background-color: inherit; font-family: 宋体;">创建普通索引</span><span style="background-color: inherit; font-family: &#39;Times New Roman&#39;;">create&nbsp;index&nbsp;idex-scl&nbsp;on&nbsp;</span><span style="background-color: inherit; font-family: 宋体;">仓库备份（面积）</span></p><p style="background-color: inherit;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2<span style="background-color: inherit; font-family: 宋体;">创建多列普通索引&nbsp;</span><span style="background-color: inherit; font-family: &#39;Times New Roman&#39;;">create&nbsp;index&nbsp;idex-sc2&nbsp;on&nbsp;</span><span style="background-color: inherit; font-family: 宋体;">仓库备份（城市，创建时间）</span></p><p style="background-color: inherit;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;<span style="background-color: inherit; font-family: 宋体;">删除索引&nbsp;</span><span style="background-color: inherit; font-family: &#39;Times New Roman&#39;;">drop&nbsp;index&nbsp;</span><span style="background-color: inherit; font-family: 宋体;">表名</span><span style="background-color: inherit; font-family: &#39;Times New Roman&#39;;">.</span><span style="background-color: inherit; font-family: 宋体;">索引名&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background-color: inherit; font-family: &#39;Times New Roman&#39;;">drop&nbsp;index&nbsp;</span><span style="background-color: inherit; font-family: 宋体;">仓库备份</span><span style="background-color: inherit; font-family: &#39;Times New Roman&#39;;">.index1</span></p><p style="background-color: inherit;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</p><p style="background-color: inherit;">&nbsp;</p><p style="background-color: inherit;">三存储过程（<span style="background-color: inherit; font-family: &#39;Times New Roman&#39;;">proc</span><span style="background-color: inherit; font-family: 宋体;">）</span></p><p style="background-color: inherit;">主要内容：</p><p style="background-color: inherit;">l&nbsp;存储过程的分类以及优点</p><p style="background-color: inherit;">&nbsp;&nbsp;&nbsp;定义：为了完成特定功能的<span style="background-color: inherit; font-family: &#39;Times New Roman&#39;;">sql</span><span style="background-color: inherit; font-family: 宋体;">集合，编译后存储在服务器端数据库中，利用存储过程可以加速</span><span style="background-color: inherit; font-family: &#39;Times New Roman&#39;;">sql&nbsp;</span><span style="background-color: inherit; font-family: 宋体;">语句的执行。</span></p><p style="background-color: inherit;">存储过程可以分为两类：系统存储过程和自定义存储过程。</p><p style="background-color: inherit;">系统存储过程：系统存储过程是在<span style="background-color: inherit; font-family: &#39;Times New Roman&#39;;">sql&nbsp;</span><span style="background-color: inherit; font-family: 宋体;">成功安装后存在系统数据库</span><span style="background-color: inherit; font-family: &#39;Times New Roman&#39;;">master&nbsp;</span><span style="background-color: inherit; font-family: 宋体;">中的，这些存储过程是以</span><span style="background-color: inherit; font-family: &#39;Times New Roman&#39;;">sp-&nbsp;</span><span style="background-color: inherit; font-family: 宋体;">为前缀命名的，主要功能是在系统表中获取信息，系统管理员可以通过简单的调用系统存储过程完成复杂的管理工作，调用系统存储过程时在其他非</span><span style="background-color: inherit; font-family: &#39;Times New Roman&#39;;">master</span><span style="background-color: inherit; font-family: 宋体;">数据库中也可以调用</span><span style="background-color: inherit;">&nbsp;</span>。</p><p style="background-color: inherit;">自定义存储过程：有用户自己定义完成特定功能，返回值只能表明返回值执行是否成功而且只能利用&nbsp;&nbsp;想、<span style="background-color: inherit; font-family: &#39;Times New Roman&#39;;">execute&nbsp;</span><span style="background-color: inherit; font-family: 宋体;">完成存储过程。</span></p><p style="background-color: inherit;">优点：&nbsp;<span style="background-color: inherit; font-family: &#39;Times New Roman&#39;;">1&nbsp;</span><span style="background-color: inherit; font-family: 宋体;">提高应用程序的通用性和可移植性</span><span style="background-color: inherit;">&nbsp;</span>2&nbsp;<span style="background-color: inherit; font-family: 宋体;">可以更有效的管理用户操作数据库的权限</span><span style="background-color: inherit; font-family: &#39;Times New Roman&#39;;">3&nbsp;</span><span style="background-color: inherit; font-family: 宋体;">可以提高</span><span style="background-color: inherit; font-family: &#39;Times New Roman&#39;;">sql</span><span style="background-color: inherit; font-family: 宋体;">的速度&nbsp;</span><span style="background-color: inherit; font-family: &#39;Times New Roman&#39;;">4&nbsp;</span><span style="background-color: inherit; font-family: 宋体;">减轻服务器的负担。</span></p><p style="background-color: inherit;">&nbsp;</p><p style="background-color: inherit;">l&nbsp;创建并执行存储过程</p><p style="background-color: inherit;">&nbsp;&nbsp;&nbsp;语法结构：</p><p style="background-color: inherit;">Create&nbsp;procedure&nbsp;&nbsp;<span style="background-color: inherit; font-family: 宋体;">过程名</span></p><p style="background-color: inherit;">@ming&nbsp;<span style="background-color: inherit; font-family: 宋体;">参数类型&nbsp;&nbsp;</span><span style="background-color: inherit; font-family: &#39;Times New Roman&#39;;">output</span></p><p style="background-color: inherit;">~~</p><p style="background-color: inherit;">~~~</p><p style="background-color: inherit;">As</p><p style="background-color: inherit;">Begin&nbsp;&nbsp;&nbsp;&nbsp;<span style="background-color: inherit; font-family: 宋体;">命令块&nbsp;</span><span style="background-color: inherit; font-family: &#39;Times New Roman&#39;;">end</span></p><p style="background-color: inherit;">创建完成后利用<span style="background-color: inherit; font-family: &#39;Times New Roman&#39;;">execute&nbsp;</span><span style="background-color: inherit; font-family: 宋体;">过程名&nbsp;&nbsp;&nbsp;</span><span style="background-color: inherit; font-family: &#39;Times New Roman&#39;;">[</span><span style="background-color: inherit; font-family: 宋体;">参数值</span><span style="background-color: inherit; font-family: &#39;Times New Roman&#39;;">~~][output]</span></p><p style="background-color: inherit;">例子：<span style="background-color: inherit; font-family: &#39;Times New Roman&#39;;">1</span><span style="background-color: inherit; font-family: 宋体;">功能为求</span><span style="background-color: inherit; font-family: &#39;Times New Roman&#39;;">0-5</span><span style="background-color: inherit; font-family: 宋体;">之间的和</span></p><p style="background-color: inherit;">&nbsp;alter&nbsp;proc&nbsp;proc3</p><p style="background-color: inherit;">&nbsp;&nbsp;&nbsp;as</p><p style="background-color: inherit;">&nbsp;declare&nbsp;&nbsp;@sum&nbsp;int,@a&nbsp;int</p><p style="background-color: inherit;">&nbsp;select&nbsp;&nbsp;@a=0,@sum=0</p><p style="background-color: inherit;">&nbsp;&nbsp;&nbsp;while&nbsp;@a&lt;6</p><p style="background-color: inherit;">&nbsp;&nbsp;&nbsp;begin</p><p style="background-color: inherit;">&nbsp;&nbsp;&nbsp;&nbsp;set&nbsp;@sum=@sum+@a</p><p style="background-color: inherit;">&nbsp;&nbsp;&nbsp;set&nbsp;@a=@a+1</p><p style="background-color: inherit;">&nbsp;&nbsp;&nbsp;End</p><p style="background-color: inherit;">print&nbsp;&#39;和是&#39;+cast(@sum&nbsp;as&nbsp;varchar)</p><p style="background-color: inherit;">&nbsp;Go</p><p style="background-color: inherit;">Exectute&nbsp;proc3&nbsp;&nbsp;</p><p style="background-color: inherit;">功能2&nbsp;<span style="background-color: inherit; font-family: 宋体;">判断系统商品库存&nbsp;以及购买者账户金额&nbsp;决定交易是否进行</span></p><p style="background-color: inherit;">create&nbsp;proc&nbsp;shuiguo2</p><p style="background-color: inherit;">@idss&nbsp;varchar(10),</p><p style="background-color: inherit;">@buyer&nbsp;varchar(10),</p><p style="background-color: inherit;">@shuliang&nbsp;int</p><p style="background-color: inherit;">as</p><p style="background-color: inherit;">--<span style="background-color: inherit; font-family: 宋体;">判断库存</span></p><p style="background-color: inherit;">if&nbsp;(select&nbsp;numbers&nbsp;from&nbsp;Fruit&nbsp;where&nbsp;Ids=@idss)&gt;@shuliang</p><p style="background-color: inherit;">begin</p><p style="background-color: inherit;">if(select&nbsp;price&nbsp;from&nbsp;Fruit&nbsp;where&nbsp;Ids=@idss&nbsp;)*@shuliang&gt;(select&nbsp;account&nbsp;from&nbsp;Login&nbsp;where&nbsp;UserName=@buyer&nbsp;)</p><p style="background-color: inherit;">begin</p><p style="background-color: inherit;">--<span style="background-color: inherit; font-family: 宋体;">减库存</span></p><p style="background-color: inherit;">update&nbsp;fruit&nbsp;set&nbsp;numbers=numbers-@shuliang&nbsp;where&nbsp;Ids=@idss</p><p style="background-color: inherit;">--<span style="background-color: inherit; font-family: 宋体;">减余额</span></p><p style="background-color: inherit;">update&nbsp;Login&nbsp;set&nbsp;Account=Account-(select&nbsp;price&nbsp;from&nbsp;Fruit)*@shuliang&nbsp;where&nbsp;UserName=@buyer</p><p style="background-color: inherit;">end</p><p style="background-color: inherit;">else</p><p style="background-color: inherit;">begin</p><p style="background-color: inherit;">print&#39;<span style="background-color: inherit; font-family: 宋体;">余额不足，请充值！</span><span style="background-color: inherit; font-family: &#39;Times New Roman&#39;;">&#39;</span></p><p style="background-color: inherit;">end</p><p style="background-color: inherit;">end</p><p style="background-color: inherit;">else</p><p style="background-color: inherit;">begin</p><p style="background-color: inherit;">print&#39;<span style="background-color: inherit; font-family: 宋体;">抱歉，库存不足！</span><span style="background-color: inherit; font-family: &#39;Times New Roman&#39;;">&#39;</span></p><p style="background-color: inherit;">end</p><p style="background-color: inherit;">go</p><p style="background-color: inherit;">功能3&nbsp;<span style="background-color: inherit; font-family: 宋体;">不带参数的存储过程&nbsp;</span></p><p style="background-color: inherit;">4<span style="background-color: inherit; font-family: 宋体;">带输入参数的存储过程</span></p><p style="background-color: inherit;">5<span style="background-color: inherit; font-family: 宋体;">带有输入参数的数据查询功能的存储过程</span></p><p style="background-color: inherit;">6<span style="background-color: inherit; font-family: 宋体;">带有输入输出参数的存储过程</span></p><p style="background-color: inherit;">7<span style="background-color: inherit; font-family: 宋体;">带有登陆判断功能的存储过程</span></p><p style="background-color: inherit;">8&nbsp;<span style="background-color: inherit; font-family: 宋体;">带有判断条件的插入功能的存储过程（</span><span style="background-color: inherit; font-family: &#39;Times New Roman&#39;;">exists</span><span style="background-color: inherit; font-family: 宋体;">）</span></p><p style="background-color: inherit;">9<span style="background-color: inherit; font-family: 宋体;">带有判断条件的删除功能的存储过程</span></p><p style="background-color: inherit;">10&nbsp;<span style="background-color: inherit; font-family: 宋体;">带有判断条件的更新功能的存储过程</span></p><p style="background-color: inherit;">11<span style="background-color: inherit; font-family: 宋体;">加密存储过程&nbsp;</span></p><p style="background-color: inherit;">Create&nbsp;proc&nbsp;<span style="background-color: inherit; font-family: 宋体;">过程名</span></p><p style="background-color: inherit;">With&nbsp;encryption</p><p style="background-color: inherit;">As&nbsp;&nbsp;<span style="background-color: inherit; font-family: 宋体;">命令块&nbsp;&nbsp;&nbsp;</span><span style="background-color: inherit; font-family: &#39;Times New Roman&#39;;">Go</span></p><p style="background-color: inherit;">★&nbsp;查看存储过程的属性以及功能代码信息</p><p style="background-color: inherit;">execute&nbsp;sp_help&nbsp;proc3&nbsp;--<span style="background-color: inherit; font-family: 宋体;">查询存储过程的属性信息</span></p><p style="background-color: inherit;">execute&nbsp;sp_depends&nbsp;proc1--<span style="background-color: inherit; font-family: 宋体;">查询存储过程所使用的数据对象的信息</span><span style="background-color: inherit; font-family: &#39;Times New Roman&#39;;">,</span><span style="background-color: inherit; font-family: 宋体;">如果没有引用或者加密会提示</span>&nbsp;&nbsp;&nbsp;&nbsp;没有引用<span style="background-color: inherit; font-family: &#39;Times New Roman&#39;;">.</span></p><p style="background-color: inherit;">execute&nbsp;sp_helptext&nbsp;proc3--<span style="background-color: inherit; font-family: 宋体;">查询存储过程的功能代码</span><span style="background-color: inherit; font-family: &#39;Times New Roman&#39;;">,</span><span style="background-color: inherit; font-family: 宋体;">如果加密后不能被查询到</span></p><p style="background-color: inherit;">select&nbsp;name&nbsp;from&nbsp;car&nbsp;where&nbsp;type&nbsp;=&#39;p&#39;--<span style="background-color: inherit; font-family: 宋体;">能共查找本表创建存储过程的名字和时间</span></p><p style="background-color: inherit;">l&nbsp;修改存储过程的功能代码</p><p style="background-color: inherit;">&nbsp;&nbsp;&nbsp;Alter&nbsp;proc&nbsp;<span style="background-color: inherit; font-family: 宋体;">过程名</span></p><p style="background-color: inherit;">@<span style="background-color: inherit; font-family: 宋体;">参数&nbsp;&nbsp;&nbsp;参数类型&nbsp;&nbsp;</span><span style="background-color: inherit; font-family: &#39;Times New Roman&#39;;">~~~~</span></p><p style="background-color: inherit;">As&nbsp;</p><p style="background-color: inherit;">Begin&nbsp;&nbsp;&nbsp;<span style="background-color: inherit; font-family: 宋体;">命令行&nbsp;&nbsp;&nbsp;</span><span style="background-color: inherit; font-family: &#39;Times New Roman&#39;;">end</span></p><p style="background-color: inherit;">l&nbsp;重命名存储过程</p><p style="background-color: inherit;">&nbsp;&nbsp;&nbsp;&nbsp;Execute&nbsp;sp_rename&nbsp;&nbsp;<span style="background-color: inherit; font-family: 宋体;">原名，&nbsp;新名</span></p><p style="background-color: inherit;">l&nbsp;删除存储过程</p><p style="background-color: inherit;">Drop&nbsp;proc&nbsp;<span style="background-color: inherit; font-family: 宋体;">过程名</span><span style="background-color: inherit; font-family: &#39;Times New Roman&#39;;">1</span><span style="background-color: inherit; font-family: 宋体;">，过程名</span><span style="background-color: inherit; font-family: &#39;Times New Roman&#39;;">2~~&nbsp;</span><span style="background-color: inherit; font-family: 宋体;">同时可以删除多个过程</span></p><p style="background-color: inherit;">带有判断条件的删除存储过程（与<span style="background-color: inherit; font-family: &#39;Times New Roman&#39;;">if&nbsp;exists</span><span style="background-color: inherit; font-family: 宋体;">语句结合）</span></p><p style="background-color: inherit;">l&nbsp;存储过程的自动执行和监控&nbsp;&nbsp;</p><p style="background-color: inherit;">l&nbsp;Oracle&nbsp;<span style="background-color: inherit; font-family: 宋体;">和</span><span style="background-color: inherit; font-family: &#39;Times New Roman&#39;;">DB2</span><span style="background-color: inherit; font-family: 宋体;">数据库中存储过程的区别</span></p><p style="background-color: inherit;">&nbsp;</p><p style="background-color: inherit;">四&nbsp;触发器（<span style="background-color: inherit; font-family: &#39;Times New Roman&#39;;">trigger</span><span style="background-color: inherit; font-family: 宋体;">）</span></p><p style="background-color: inherit;">l&nbsp;触发器与存储过程的区别</p><p style="background-color: inherit;">1.<span style="background-color: inherit; font-family: 宋体;">存储过程是独立于表存在的，触发器需要依附某个表的某个操作。</span></p><p style="background-color: inherit;">2.<span style="background-color: inherit; font-family: 宋体;">存储过程需要使用名称去调用才能执行，触发器则在表的操作过程中自动被触发调用。</span></p><p style="background-color: inherit;">l&nbsp;触发器的分类和作用</p><p style="background-color: inherit;">&nbsp;&nbsp;&nbsp;定义<span style="background-color: inherit; font-family: &#39;Times New Roman&#39;;">;&nbsp;</span><span style="background-color: inherit; font-family: 宋体;">触发器是一种特殊类型的存储过程，通过事件的触发来被执行，例如</span><span style="background-color: inherit; font-family: &#39;Times New Roman&#39;;">update&nbsp;delete&nbsp;drop&nbsp;alter&nbsp;drop</span><span style="background-color: inherit; font-family: 宋体;">等。&nbsp;&nbsp;&nbsp;在</span><span style="background-color: inherit; font-family: &#39;Times New Roman&#39;;">sql&nbsp;</span><span style="background-color: inherit; font-family: 宋体;">中有两种方法可以保持数据的完整性和有效性：约束和触发器，约束直接设置在表内只能执行一些比较简单的功能，而触发器可以执行比较复杂的过程。</span></p><p style="background-color: inherit;">作用：&nbsp;<span style="background-color: inherit; font-family: &#39;Times New Roman&#39;;">1&nbsp;</span><span style="background-color: inherit; font-family: 宋体;">可以调用存储过程&nbsp;</span><span style="background-color: inherit; font-family: &#39;Times New Roman&#39;;">2</span><span style="background-color: inherit; font-family: 宋体;">强化数据条件约束&nbsp;</span><span style="background-color: inherit; font-family: &#39;Times New Roman&#39;;">3</span><span style="background-color: inherit; font-family: 宋体;">跟踪数据库内数据的变化并判断数据变化是否符合数据库的要求&nbsp;</span><span style="background-color: inherit; font-family: &#39;Times New Roman&#39;;">4</span><span style="background-color: inherit; font-family: 宋体;">级联和并行运行。</span></p><p style="background-color: inherit;">分类：<span style="background-color: inherit; font-family: &#39;Times New Roman&#39;;">DML&nbsp;</span><span style="background-color: inherit; font-family: 宋体;">触发器&nbsp;&nbsp;</span><span style="background-color: inherit; font-family: &#39;Times New Roman&#39;;">DDL</span><span style="background-color: inherit; font-family: 宋体;">触发器</span></p><p style="background-color: inherit;">&nbsp;&nbsp;DML<span style="background-color: inherit; font-family: 宋体;">触发器：</span><span style="background-color: inherit; font-family: &#39;Times New Roman&#39;;">data&nbsp;manipulation&nbsp;language&nbsp;&nbsp;</span><span style="background-color: inherit; font-family: 宋体;">又可以分为&nbsp;事后触发器（</span><span style="background-color: inherit; font-family: &#39;Times New Roman&#39;;">after</span><span style="background-color: inherit; font-family: 宋体;">触发器）替代触发器&nbsp;（</span><span style="background-color: inherit; font-family: &#39;Times New Roman&#39;;">instead&nbsp;of</span><span style="background-color: inherit; font-family: 宋体;">）&nbsp;</span></p><p style="background-color: inherit;">&nbsp;&nbsp;After&nbsp;<span style="background-color: inherit; font-family: 宋体;">触发器&nbsp;先执行变得增删改操作后在触发触发器&nbsp;。</span></p><p style="background-color: inherit;">&nbsp;Instead&nbsp;of&nbsp;<span style="background-color: inherit; font-family: 宋体;">触发器&nbsp;不执行表的增删改操作，它的这些操作只起到触发触发器的功能。</span></p><p style="background-color: inherit;">DDl&nbsp;<span style="background-color: inherit; font-family: 宋体;">触发器用来执行数据库的管理任务。</span></p><p style="background-color: inherit;">注释：</p><p style="background-color: inherit;">触发器中两个临时表：<span style="background-color: inherit; font-family: &#39;Times New Roman&#39;;">inserted,deleted</span></p><p style="background-color: inherit;">这两个表是临时表，触发器执行完成后，会自动消失，再次触发会再次创建。</p><p style="background-color: inherit;">这两个表的结构与<span style="background-color: inherit; font-family: &#39;Times New Roman&#39;;">on</span><span style="background-color: inherit; font-family: 宋体;">后面的那表的结构是一样的（列名、列数、类型）。而且里面只有一条记录。</span></p><p style="background-color: inherit;">插入操作<span style="background-color: inherit; font-family: &#39;Times New Roman&#39;;">--</span><span style="background-color: inherit; font-family: 宋体;">把新增的数据放到</span><span style="background-color: inherit; font-family: &#39;Times New Roman&#39;;">inserted</span><span style="background-color: inherit; font-family: 宋体;">表中。</span></p><p style="background-color: inherit;">删除操作<span style="background-color: inherit; font-family: &#39;Times New Roman&#39;;">--</span><span style="background-color: inherit; font-family: 宋体;">把删除的数据放到</span><span style="background-color: inherit; font-family: &#39;Times New Roman&#39;;">deleted</span><span style="background-color: inherit; font-family: 宋体;">表中。</span></p><p style="background-color: inherit;">修改操作<span style="background-color: inherit; font-family: &#39;Times New Roman&#39;;">--</span><span style="background-color: inherit; font-family: 宋体;">把旧数据放到</span><span style="background-color: inherit; font-family: &#39;Times New Roman&#39;;">deleted</span><span style="background-color: inherit; font-family: 宋体;">表中，把新数据放到</span><span style="background-color: inherit; font-family: &#39;Times New Roman&#39;;">inserted</span><span style="background-color: inherit; font-family: 宋体;">表中。</span></p><p style="background-color: inherit;">对两个临时表的使用。</p><p style="background-color: inherit;">从两个临时表中把数据取出来放到变量中，以备后面的使用。</p><p style="background-color: inherit;">l&nbsp;创建执行事后触发器</p><p style="background-color: inherit;">After&nbsp;&nbsp;<span style="background-color: inherit; font-family: 宋体;">触发器注意事项：触发器名在同一数据库中是唯一的；可以利用</span><span style="background-color: inherit; font-family: &#39;Times New Roman&#39;;">with&nbsp;encryption&nbsp;</span><span style="background-color: inherit; font-family: 宋体;">对触发器进行加密；&nbsp;&nbsp;只能定义在数据表中不能定义在视图上；</span><span style="background-color: inherit; font-family: &#39;Times New Roman&#39;;">after</span><span style="background-color: inherit; font-family: 宋体;">触发器的动作只能是</span><span style="background-color: inherit; font-family: &#39;Times New Roman&#39;;">update&nbsp;delete&nbsp;insert&nbsp;</span><span style="background-color: inherit; font-family: 宋体;">三种&nbsp;其中的一种或者多种。</span></p><p style="background-color: inherit;">创建语法：</p><p style="background-color: inherit;">&nbsp;&nbsp;&nbsp;Create&nbsp;trigger&nbsp;<span style="background-color: inherit; font-family: 宋体;">触发器名&nbsp;&nbsp;</span><span style="background-color: inherit; font-family: &#39;Times New Roman&#39;;">on&nbsp;&nbsp;</span><span style="background-color: inherit; font-family: 宋体;">表名&nbsp;</span><span style="background-color: inherit; font-family: &#39;Times New Roman&#39;;">for&nbsp;&nbsp;insert[update&nbsp;&nbsp;delete]</span></p><p style="background-color: inherit;">&nbsp;&nbsp;&nbsp;As</p><p style="background-color: inherit;">&nbsp;&nbsp;&nbsp;Begin</p><p style="background-color: inherit;">&nbsp;&nbsp;&nbsp;命令&nbsp;&nbsp;</p><p style="background-color: inherit;">&nbsp;&nbsp;&nbsp;End</p><p style="background-color: inherit;">实例：运行触发器当数据表进行增删改时自动发送邮件</p><p style="background-color: inherit;">Create&nbsp;&nbsp;trigger&nbsp;<span style="background-color: inherit; font-family: 宋体;">触发器名&nbsp;</span><span style="background-color: inherit; font-family: &#39;Times New Roman&#39;;">on</span><span style="background-color: inherit; font-family: 宋体;">表名&nbsp;</span><span style="background-color: inherit; font-family: &#39;Times New Roman&#39;;">for&nbsp;insert[update&nbsp;</span><span style="background-color: inherit; font-family: 宋体;">，</span><span style="background-color: inherit; font-family: &#39;Times New Roman&#39;;">delete]</span></p><p style="background-color: inherit;">As&nbsp;begin&nbsp;</p><p style="background-color: inherit;">Execute&nbsp;xp_sendmail&nbsp;‘邮箱地址’</p><p style="background-color: inherit;">end</p><p style="background-color: inherit;">l&nbsp;创建与执行替代触发器</p><p style="background-color: inherit;">注意点：<span style="background-color: inherit; font-family: &#39;Times New Roman&#39;;">instead&nbsp;of</span><span style="background-color: inherit; font-family: 宋体;">触发器主要作用是使不可修改的视图能够支持修改。当然也可以对表进行操作。</span></p><p style="background-color: inherit;">构建语法：&nbsp;&nbsp;&nbsp;<span style="background-color: inherit; font-family: &#39;Times New Roman&#39;;">Create&nbsp;trigger&nbsp;</span><span style="background-color: inherit; font-family: 宋体;">触发器名&nbsp;</span><span style="background-color: inherit; font-family: &#39;Times New Roman&#39;;">on&nbsp;</span><span style="background-color: inherit; font-family: 宋体;">表名或者视图名&nbsp;</span><span style="background-color: inherit; font-family: &#39;Times New Roman&#39;;">instead&nbsp;of&nbsp;&nbsp;insert[delete&nbsp;update]</span></p><p style="background-color: inherit;">&nbsp;&nbsp;As</p><p style="background-color: inherit;">Begin</p><p style="background-color: inherit;">命令块</p><p style="background-color: inherit;">End</p><p style="background-color: inherit;">Go</p><p style="background-color: inherit;">&nbsp;</p><p style="background-color: inherit;">l&nbsp;查看触发器的属性以及功能代码信息</p><p style="background-color: inherit;">l&nbsp;修改触发器的功能代码</p><p style="background-color: inherit;">l&nbsp;重命名和删除触发器</p><p style="background-color: inherit;">&nbsp;Sp_rename&nbsp;<span style="background-color: inherit; font-family: 宋体;">原名，新名&nbsp;&nbsp;</span><span style="background-color: inherit; font-family: &#39;Times New Roman&#39;;">--</span><span style="background-color: inherit; font-family: 宋体;">重命名触发器</span></p><p style="background-color: inherit;">&nbsp;Drop&nbsp;trigger&nbsp;<span style="background-color: inherit; font-family: 宋体;">触发器名【</span><span style="background-color: inherit; font-family: &#39;Times New Roman&#39;;">123</span><span style="background-color: inherit; font-family: 宋体;">】</span><span style="background-color: inherit; font-family: &#39;Times New Roman&#39;;">--</span><span style="background-color: inherit; font-family: 宋体;">可以同时删除多个触发器</span></p><p style="background-color: inherit;">&nbsp;</p><p style="background-color: inherit;">l&nbsp;禁用和启用触发器</p><p style="background-color: inherit;">Alter&nbsp;table&nbsp;<span style="background-color: inherit; font-family: 宋体;">表名&nbsp;&nbsp;</span><span style="background-color: inherit; font-family: &#39;Times New Roman&#39;;">disable&nbsp;trigger&nbsp;</span><span style="background-color: inherit; font-family: 宋体;">触发器名&nbsp;&nbsp;&nbsp;禁用触发器</span></p><p style="background-color: inherit;">&nbsp;Alter&nbsp;table&nbsp;<span style="background-color: inherit; font-family: 宋体;">表名&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background-color: inherit; font-family: &#39;Times New Roman&#39;;">enable&nbsp;trigger&nbsp;</span><span style="background-color: inherit; font-family: 宋体;">触发器名&nbsp;&nbsp;&nbsp;启用触发器</span></p><p style="background-color: inherit;">Alter&nbsp;table&nbsp;<span style="background-color: inherit; font-family: 宋体;">表名&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background-color: inherit; font-family: &#39;Times New Roman&#39;;">enable&nbsp;trigger&nbsp;</span><span style="background-color: inherit; font-family: 宋体;">触发器名</span><span style="background-color: inherit; font-family: &#39;Times New Roman&#39;;">1</span><span style="background-color: inherit; font-family: 宋体;">，触发器名</span><span style="background-color: inherit; font-family: &#39;Times New Roman&#39;;">2&nbsp;&nbsp;</span><span style="background-color: inherit; font-family: 宋体;">启用多个触发器触发器</span></p><p style="background-color: inherit;">Alter&nbsp;table&nbsp;<span style="background-color: inherit; font-family: 宋体;">表名&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background-color: inherit; font-family: &#39;Times New Roman&#39;;">enable&nbsp;trigger&nbsp;all&nbsp;&nbsp;</span><span style="background-color: inherit; font-family: 宋体;">启用&nbsp;这个表中的所有触发器</span></p><p style="background-color: inherit;">&nbsp;</p><p style="background-color: inherit;">l&nbsp;创建与执行<span style="background-color: inherit; font-family: &#39;Times New Roman&#39;;">ddl&nbsp;</span><span style="background-color: inherit; font-family: 宋体;">触发器</span></p><p style="background-color: inherit;">DDL&nbsp;<span style="background-color: inherit; font-family: 宋体;">触发器一般用于数据库的管理工作，&nbsp;其触发事件为&nbsp;</span><span style="background-color: inherit; font-family: &#39;Times New Roman&#39;;">create&nbsp;alter&nbsp;drop&nbsp;</span><span style="background-color: inherit; font-family: 宋体;">开头的语句</span></p><p style="background-color: inherit;">创建<span style="background-color: inherit; font-family: &#39;Times New Roman&#39;;">DDl&nbsp;</span><span style="background-color: inherit; font-family: 宋体;">触发器语法结构：</span></p><p style="background-color: inherit;">Create&nbsp;trigger&nbsp;<span style="background-color: inherit; font-family: 宋体;">触发器名&nbsp;</span><span style="background-color: inherit; font-family: &#39;Times New Roman&#39;;">on&nbsp;</span><span style="background-color: inherit; font-family: 宋体;">服务器或者是数据库</span></p><p style="background-color: inherit;">For<span style="background-color: inherit; font-family: 宋体;">或者</span><span style="background-color: inherit; font-family: &#39;Times New Roman&#39;;">after&nbsp;create[drop&nbsp;alter&nbsp;]</span></p><p style="background-color: inherit;">As&nbsp;&nbsp;begin</p><p style="background-color: inherit;">命令块&nbsp;&nbsp;&nbsp;</p><p style="background-color: inherit;">End</p><p style="background-color: inherit;">注意点：&nbsp;<span style="background-color: inherit; font-family: &#39;Times New Roman&#39;;">DDl&nbsp;</span><span style="background-color: inherit; font-family: 宋体;">触发器没有替代触发器只有事后触发器，不同是作用于数据库还是服务器</span></p><p style="background-color: inherit;">&nbsp;</p><p style="background-color: inherit;">&nbsp;</p><p style="background-color: inherit;">l&nbsp;修改和删除<span style="background-color: inherit; font-family: &#39;Times New Roman&#39;;">ddl&nbsp;</span><span style="background-color: inherit; font-family: 宋体;">触发器</span></p><p style="background-color: inherit;">l&nbsp;触发器的使用</p><p style="background-color: inherit;">&nbsp;</p><p style="background-color: inherit;">&nbsp;</p><p style="background-color: inherit;">&nbsp;</p><p style="background-color: inherit;">&nbsp;</p><p style="background-color: inherit;">五事务（<span style="background-color: inherit; font-family: &#39;Times New Roman&#39;;">begin&nbsp;trans&nbsp;&nbsp;rollback</span><span style="background-color: inherit; font-family: 宋体;">返回&nbsp;</span><span style="background-color: inherit; font-family: &#39;Times New Roman&#39;;">commit</span><span style="background-color: inherit; font-family: 宋体;">确定）</span></p><p style="background-color: inherit;">&nbsp;</p><p><br/></p>
                        </code>
                        </pre>
                        <div class="bdsharebuttonbox"><a href="#" class="bds_more" data-cmd="more"></a><a href="#" class="bds_qzone" data-cmd="qzone"></a><a href="#" class="bds_tsina" data-cmd="tsina"></a><a href="#" class="bds_tqq" data-cmd="tqq"></a><a href="#" class="bds_renren" data-cmd="renren"></a><a href="#" class="bds_weixin" data-cmd="weixin"></a></div>
                        <!-- UY BEGIN -->
                        <div id="uyan_frame"></div>
                        <script type="text/javascript" src="http://v2.uyan.cc/code/uyan.js?uid=2113268"></script>
                        <!-- UY END -->
                    </div>
                </div>
                <div id="footerInnerSeparator"></div>
            </div>
        </div>
        <div id="footerOuterSeparator"></div>
    </div>
    <br /><br /><br />
    <script src="../../js/jquery-1.9.1.js"></script>
    <script>
        window._bd_share_config = { "common": { "bdSnsKey": {}, "bdText": $("#divMain pre code").text(), "bdMini": "2", "bdPic": "", "bdStyle": "0", "bdSize": "16" }, "share": {}, "image": { "viewList": ["qzone", "tsina", "tqq", "renren", "weixin"], "viewText": "分享到：", "viewSize": "16" }, "selectShare": { "bdContainerClass": null, "bdSelectMiniList": ["qzone", "tsina", "tqq", "renren", "weixin"] } }; with (document) 0[(getElementsByTagName('head')[0] || body).appendChild(createElement('script')).src = 'http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion=' + ~(-new Date() / 36e5)];
    </script>
</body>
</html>